<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Axel Vossen" />

<meta name="date" content="2025-12-08" />

<title>Projet GLM-GAM</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Projet GLM-GAM</h1>
<h4 class="author">Axel Vossen</h4>
<h4 class="date">2025-12-08</h4>



<div id="part-1-glm-analysis" class="section level1">
<h1>Part 1: GLM Analysis</h1>
<div id="data-preparation" class="section level2">
<h2>Data preparation</h2>
</div>
<div id="categorical-variables" class="section level2">
<h2>Categorical variables</h2>
<p>Let’s start with loading the data set containing the insurance
portfolio of motor third party liability (MTPL) policies from a Belgian
insurer. We immediately follow up on our data preparation with
converting categorical variables, wrongly saved as character type in R,
into factors.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;mtpl_be.rda&quot;</span>)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">str</span>(mtpl_be)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    163231 obs. of  18 variables:
##  $ ID      : int  1 2 3 4 5 6 7 8 9 10 ...
##  $ NCLAIMS : int  1 0 0 0 1 0 1 0 0 0 ...
##  $ AMOUNT  : num  1618 0 0 0 156 ...
##  $ AVG     : num  1618 NA NA NA 156 ...
##  $ EXP     : num  1 1 1 1 0.0466 ...
##  $ COVERAGE: chr  &quot;TPL&quot; &quot;PO&quot; &quot;TPL&quot; &quot;TPL&quot; ...
##  $ FUEL    : chr  &quot;gasoline&quot; &quot;gasoline&quot; &quot;diesel&quot; &quot;gasoline&quot; ...
##  $ USE     : chr  &quot;private&quot; &quot;private&quot; &quot;private&quot; &quot;private&quot; ...
##  $ FLEET   : chr  &quot;N&quot; &quot;N&quot; &quot;N&quot; &quot;N&quot; ...
##  $ SEX     : chr  &quot;male&quot; &quot;female&quot; &quot;male&quot; &quot;male&quot; ...
##  $ AGEPH   : int  50 64 60 77 28 26 26 58 59 34 ...
##  $ BM      : int  5 5 0 0 9 11 11 11 0 7 ...
##  $ AGEC    : int  12 3 10 15 7 12 8 14 3 6 ...
##  $ POWER   : int  77 66 70 57 70 70 55 47 98 74 ...
##  $ PC      : int  1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 ...
##  $ TOWN    : chr  &quot;BRUSSEL&quot; &quot;BRUSSEL&quot; &quot;BRUSSEL&quot; &quot;BRUSSEL&quot; ...
##  $ LONG    : num  4.36 4.36 4.36 4.36 4.36 ...
##  $ LAT     : num  50.8 50.8 50.8 50.8 50.8 ...</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>mtpl_be <span class="ot">&lt;-</span> mtpl_be <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">COVERAGE =</span> <span class="fu">as.factor</span>(COVERAGE)) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">FUEL =</span> <span class="fu">as.factor</span>(FUEL)) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">USE =</span> <span class="fu">as.factor</span>(USE)) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">FLEET =</span> <span class="fu">as.factor</span>(FLEET)) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">SEX =</span> <span class="fu">as.factor</span>(SEX))</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="fu">str</span>(mtpl_be)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    163231 obs. of  18 variables:
##  $ ID      : int  1 2 3 4 5 6 7 8 9 10 ...
##  $ NCLAIMS : int  1 0 0 0 1 0 1 0 0 0 ...
##  $ AMOUNT  : num  1618 0 0 0 156 ...
##  $ AVG     : num  1618 NA NA NA 156 ...
##  $ EXP     : num  1 1 1 1 0.0466 ...
##  $ COVERAGE: Factor w/ 3 levels &quot;FO&quot;,&quot;PO&quot;,&quot;TPL&quot;: 3 2 3 3 3 3 1 3 1 2 ...
##  $ FUEL    : Factor w/ 2 levels &quot;diesel&quot;,&quot;gasoline&quot;: 2 2 1 2 2 2 2 2 2 2 ...
##  $ USE     : Factor w/ 2 levels &quot;private&quot;,&quot;work&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ FLEET   : Factor w/ 2 levels &quot;N&quot;,&quot;Y&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ SEX     : Factor w/ 2 levels &quot;female&quot;,&quot;male&quot;: 2 1 2 2 1 2 2 1 2 2 ...
##  $ AGEPH   : int  50 64 60 77 28 26 26 58 59 34 ...
##  $ BM      : int  5 5 0 0 9 11 11 11 0 7 ...
##  $ AGEC    : int  12 3 10 15 7 12 8 14 3 6 ...
##  $ POWER   : int  77 66 70 57 70 70 55 47 98 74 ...
##  $ PC      : int  1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 ...
##  $ TOWN    : chr  &quot;BRUSSEL&quot; &quot;BRUSSEL&quot; &quot;BRUSSEL&quot; &quot;BRUSSEL&quot; ...
##  $ LONG    : num  4.36 4.36 4.36 4.36 4.36 ...
##  $ LAT     : num  50.8 50.8 50.8 50.8 50.8 ...</code></pre>
<p>Now that we have proper factors for our categorical variables, we
will assess whether the reference level, is the most appropriate one.
Let’s recall that the reference level is usually fixed as the first term
when treating such data set, while we aim to fix the reference level to
the factor with the most occurrence. To help us, we use the
<strong>fct_count</strong> function from package <em>forecats</em> to
evaluate the number of rows for each level of the factor variables. To
fasten our computation, we have decided to use right after the function
<strong>fct_infreq</strong> from the <em>forecats</em> package as well,
which will directly reassign the reference level to the most frequent
factor.</p>
<div id="coverage" class="section level3">
<h3>Coverage</h3>
<p>In this variable, we deal with the type of coverage provided by the
insurance policy: only third-party liability (TPL), partial omnium (PO)
and full omnium (FO). Note that Partial omnium is equal to <em>TPL</em>
+ limited material damage, while full omnium corresponds to <em>TPL</em>
+ comprehensive material damage.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">levels</span>(mtpl_be<span class="sc">$</span>COVERAGE)</span></code></pre></div>
<pre><code>## [1] &quot;FO&quot;  &quot;PO&quot;  &quot;TPL&quot;</code></pre>
<p>We observe that the reference level is initially set to <em>FO</em>,
being the first factor of the Coverage variable. But with the output
from <em>fct_count</em>, we understand that <em>TPL</em> is actually the
reference level with the most observations.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>mtpl_be<span class="sc">$</span>COVERAGE <span class="sc">%&gt;%</span> <span class="fu">fct_count</span>(<span class="at">sort=</span><span class="cn">TRUE</span>,<span class="at">prop =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## # A tibble: 3 × 3
##   f         n     p
##   &lt;fct&gt; &lt;int&gt; &lt;dbl&gt;
## 1 TPL   95136 0.583
## 2 PO    45988 0.282
## 3 FO    22107 0.135</code></pre>
<p>Therefore, we use the function <em>fct_infreq</em> to relevel
properly with respect to the highest observed factor. Another
alternative would be to use the function <strong>relevel</strong>.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>mtpl_be<span class="sc">$</span>COVERAGE <span class="ot">=</span> mtpl_be<span class="sc">$</span>COVERAGE <span class="sc">%&gt;%</span> <span class="fu">fct_infreq</span>() </span></code></pre></div>
</div>
<div id="fuel" class="section level3">
<h3>Fuel</h3>
<p>Regarding the type of fuel of the vehicles, <em>diesel</em> appears
to be the reference level.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="fu">levels</span>(mtpl_be<span class="sc">$</span>FUEL)</span></code></pre></div>
<pre><code>## [1] &quot;diesel&quot;   &quot;gasoline&quot;</code></pre>
<p>But from the following output <em>gasoline</em> is the most common of
the two.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>mtpl_be<span class="sc">$</span>FUEL <span class="sc">%&gt;%</span> <span class="fu">fct_count</span>(<span class="at">sort=</span><span class="cn">TRUE</span>,<span class="at">prop =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## # A tibble: 2 × 3
##   f             n     p
##   &lt;fct&gt;     &lt;int&gt; &lt;dbl&gt;
## 1 gasoline 112833 0.691
## 2 diesel    50398 0.309</code></pre>
<p>We thus define the reference level as <em>gasoline</em> for the type
of fuel used.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>mtpl_be<span class="sc">$</span>Fuel <span class="ot">=</span> mtpl_be<span class="sc">$</span>FUEL <span class="sc">%&gt;%</span> <span class="fu">fct_infreq</span>()</span></code></pre></div>
</div>
<div id="use" class="section level3">
<h3>Use</h3>
<p>Let’s now tackle the type of use of the vehicle between
<em>private</em> and <em>work</em>. The reference level is
<em>private</em>.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="fu">levels</span>(mtpl_be<span class="sc">$</span>USE)</span></code></pre></div>
<pre><code>## [1] &quot;private&quot; &quot;work&quot;</code></pre>
<p>Meanwhile, it appears that the reference level is rightly chosen as
the <em>private</em> use is the most common with approximately 95.17%
occurrence.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>mtpl_be<span class="sc">$</span>USE <span class="sc">%&gt;%</span> <span class="fu">fct_count</span>(<span class="at">sort=</span><span class="cn">TRUE</span>,<span class="at">prop =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## # A tibble: 2 × 3
##   f            n      p
##   &lt;fct&gt;    &lt;int&gt;  &lt;dbl&gt;
## 1 private 155352 0.952 
## 2 work      7879 0.0483</code></pre>
</div>
<div id="fleet" class="section level3">
<h3>Fleet</h3>
<p>We will now deal with this categorical variable designating if the
the vehicle is part of a fleet. The reference level is defined as
<em>N</em> standing for No.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="fu">levels</span>(mtpl_be<span class="sc">$</span>FLEET)</span></code></pre></div>
<pre><code>## [1] &quot;N&quot; &quot;Y&quot;</code></pre>
<p>Again, we don’t need to further process the data as most vehicles are
not part of a fleet.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a>mtpl_be<span class="sc">$</span>FLEET <span class="sc">%&gt;%</span> <span class="fu">fct_count</span>(<span class="at">sort=</span><span class="cn">TRUE</span>,<span class="at">prop =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## # A tibble: 2 × 3
##   f          n      p
##   &lt;fct&gt;  &lt;int&gt;  &lt;dbl&gt;
## 1 N     158060 0.968 
## 2 Y       5171 0.0317</code></pre>
</div>
<div id="sex" class="section level3">
<h3>Sex</h3>
<p>The final categorical variable we will deal with is the gender of the
policyholder between <em>male</em> and <em>female</em>, with the latter
defined as the reference level.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="fu">levels</span>(mtpl_be<span class="sc">$</span>SEX)</span></code></pre></div>
<pre><code>## [1] &quot;female&quot; &quot;male&quot;</code></pre>
<p>With respect to the output from the <em>fct_count</em> function, the
male gender is the most represented in the data set.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a>mtpl_be<span class="sc">$</span>SEX <span class="sc">%&gt;%</span> <span class="fu">fct_count</span>(<span class="at">sort=</span><span class="cn">TRUE</span>,<span class="at">prop =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## # A tibble: 2 × 3
##   f           n     p
##   &lt;fct&gt;   &lt;int&gt; &lt;dbl&gt;
## 1 male   120056 0.735
## 2 female  43175 0.265</code></pre>
<p>Which we thus reassign with the <em>fct_infreq</em> function.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a>mtpl_be<span class="sc">$</span>SEX <span class="ot">=</span> mtpl_be<span class="sc">$</span>SEX <span class="sc">%&gt;%</span> <span class="fu">fct_infreq</span>()</span></code></pre></div>
</div>
</div>
<div id="continuous-variables" class="section level2">
<h2>Continuous variables</h2>
<p>Moreover, for the sake of simplifying our analysis, we process the
following continuous variables: <em>ageph</em>, <em>agec</em>,
<em>power</em> and <em>bm</em>. To this end, the idea is to bin
continuous variables. To do so, I will first rely on the
<em>discretize</em> function from package <strong>recipe</strong>. I
will iterativelly try different cuts value, until it shows warning
stating that the binning function refuses to discretize due to lack of
enough distinct values without producing degenerate bins. Then we apply
the <em>mutate</em> and <em>cut</em> functions on the continuous
variable to classify them in factor-type categories.</p>
<div id="ageph" class="section level3">
<h3>Ageph</h3>
<p>First, we deal with the age of the policyholders in years, from 18 to
95 years old.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a><span class="fu">min</span>(mtpl_be<span class="sc">$</span>AGEPH);<span class="fu">max</span>(mtpl_be<span class="sc">$</span>AGEPH)</span></code></pre></div>
<pre><code>## [1] 18</code></pre>
<pre><code>## [1] 95</code></pre>
<p>We thus apply the <em>discretize</em> function and find an
appropriate cuts amount of 6.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a><span class="fu">hist</span>(mtpl_be<span class="sc">$</span>AGEPH, <span class="at">main =</span> <span class="st">&quot;Histogram of the age of policyholders&quot;</span>, <span class="at">xlab=</span> <span class="st">&quot;policyholder&#39;s age&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="100%" /></p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a>mtpl_be<span class="sc">$</span>AGEPH <span class="sc">%&gt;%</span> <span class="fu">discretize</span>(mtpl_be<span class="sc">$</span>AGEPH, <span class="at">cuts=</span><span class="dv">5</span>)</span></code></pre></div>
<pre><code>## Bins: 163232 (includes missing category)
## Breaks: -Inf, 33, 41, 50, 61, Inf</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a>mtpl_be<span class="sc">$</span>AGEPH <span class="sc">%&gt;%</span> <span class="fu">discretize</span>(mtpl_be<span class="sc">$</span>AGEPH, <span class="at">cuts=</span><span class="dv">6</span>)</span></code></pre></div>
<pre><code>## Bins: 163232 (includes missing category)</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a>mtpl_be<span class="sc">$</span>AGEPH <span class="sc">%&gt;%</span> <span class="fu">discretize</span>(mtpl_be<span class="sc">$</span>AGEPH, <span class="at">cuts=</span><span class="dv">7</span>)</span></code></pre></div>
<pre><code>## Too few unique data points. No binning was used.</code></pre>
<p>We thus obtain the following age</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" tabindex="-1"></a>mtpl_be <span class="ot">&lt;-</span> mtpl_be <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">AGEPH_fac =</span> <span class="fu">cut</span>(AGEPH , <span class="at">breaks=</span><span class="dv">6</span> ))</span>
<span id="cb38-2"><a href="#cb38-2" tabindex="-1"></a><span class="fu">levels</span>(mtpl_be<span class="sc">$</span>AGEPH_fac)</span></code></pre></div>
<pre><code>## [1] &quot;(17.9,30.8]&quot; &quot;(30.8,43.7]&quot; &quot;(43.7,56.5]&quot; &quot;(56.5,69.3]&quot; &quot;(69.3,82.2]&quot;
## [6] &quot;(82.2,95.1]&quot;</code></pre>
<p>The final step is to assign the proper reference level, as we did
with categorical values. We identify the bin of ages (30.8,43.7] as
being the most observed (30.24%), which is then set with the
<em>fct_infreq</em> function.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" tabindex="-1"></a>mtpl_be<span class="sc">$</span>AGEPH_fac <span class="sc">%&gt;%</span> <span class="fu">fct_count</span>(<span class="at">sort=</span><span class="cn">TRUE</span>,<span class="at">prop =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 3
##   f               n       p
##   &lt;fct&gt;       &lt;int&gt;   &lt;dbl&gt;
## 1 (30.8,43.7] 49357 0.302  
## 2 (43.7,56.5] 44812 0.275  
## 3 (56.5,69.3] 30498 0.187  
## 4 (17.9,30.8] 24295 0.149  
## 5 (69.3,82.2] 13363 0.0819 
## 6 (82.2,95.1]   906 0.00555</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" tabindex="-1"></a>mtpl_be<span class="sc">$</span>AGEPH_fac <span class="ot">=</span> mtpl_be<span class="sc">$</span>AGEPH_fac <span class="sc">%&gt;%</span> <span class="fu">fct_infreq</span>()</span></code></pre></div>
</div>
<div id="agec" class="section level3">
<h3>Agec</h3>
<p>Secondly, we deal with the age of the vehicles in years, between 0
and 48 years old.</p>
<pre><code>## [1] 0</code></pre>
<pre><code>## [1] 48</code></pre>
<p>We thus apply the <em>discretize</em> function and find an
appropriate cuts amount of 3.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" tabindex="-1"></a><span class="fu">hist</span>(mtpl_be<span class="sc">$</span>AGEC, <span class="at">main=</span><span class="st">&quot;Histogram of car age&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;Car age&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="100%" /></p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" tabindex="-1"></a>mtpl_be<span class="sc">$</span>AGEC <span class="sc">%&gt;%</span> <span class="fu">discretize</span>(mtpl_be<span class="sc">$</span>AGEC, <span class="at">cuts=</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## Bins: 163232 (includes missing category)
## Breaks: -Inf, 7, Inf</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" tabindex="-1"></a>mtpl_be<span class="sc">$</span>AGEC <span class="sc">%&gt;%</span> <span class="fu">discretize</span>(mtpl_be<span class="sc">$</span>AGEC, <span class="at">cuts=</span><span class="dv">3</span>)</span></code></pre></div>
<pre><code>## Bins: 163232 (includes missing category)
## Breaks: -Inf, 5, 9, Inf</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" tabindex="-1"></a>mtpl_be<span class="sc">$</span>AGEC <span class="sc">%&gt;%</span> <span class="fu">discretize</span>(mtpl_be<span class="sc">$</span>AGEC, <span class="at">cuts=</span><span class="dv">4</span>)</span></code></pre></div>
<pre><code>## Too few unique data points. No binning was used.</code></pre>
<p>We thus obtain the following age bins for the vehicles.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" tabindex="-1"></a>mtpl_be <span class="ot">&lt;-</span> mtpl_be <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">AGEC_fac =</span> <span class="fu">cut</span>(AGEC , <span class="at">breaks=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.5</span>,<span class="dv">5</span>,<span class="dv">9</span>,<span class="fu">max</span>(mtpl_be<span class="sc">$</span>AGEC))))</span>
<span id="cb52-2"><a href="#cb52-2" tabindex="-1"></a><span class="fu">levels</span>(mtpl_be<span class="sc">$</span>AGEC_fac)</span></code></pre></div>
<pre><code>## [1] &quot;(-0.5,5]&quot; &quot;(5,9]&quot;    &quot;(9,48]&quot;</code></pre>
<p>The reference level remains unchanged as vehicles between 0 and 5
years old represent 36.27% of all vehicles registered.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" tabindex="-1"></a>mtpl_be<span class="sc">$</span>AGEC_fac <span class="sc">%&gt;%</span> <span class="fu">fct_count</span>(<span class="at">sort=</span><span class="cn">TRUE</span>,<span class="at">prop =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## # A tibble: 3 × 3
##   f            n     p
##   &lt;fct&gt;    &lt;int&gt; &lt;dbl&gt;
## 1 (-0.5,5] 59205 0.363
## 2 (5,9]    55419 0.340
## 3 (9,48]   48607 0.298</code></pre>
</div>
<div id="power" class="section level3">
<h3>Power</h3>
<p>Let’s investigate the horsepower of vehicles in kilowatt in a range
of 10 to 243. Naturally, the more horsepower a vehicle has, the more
kilowatts it represents</p>
<pre><code>## [1] 10</code></pre>
<pre><code>## [1] 243</code></pre>
<p>We find the optimal amount of cuts being equal to 5.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" tabindex="-1"></a><span class="fu">hist</span>(mtpl_be<span class="sc">$</span>POWER, <span class="at">main =</span> <span class="st">&quot;Horsepower of vehicles&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;kilowatt&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="100%" /></p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" tabindex="-1"></a>mtpl_be<span class="sc">$</span>POWER <span class="sc">%&gt;%</span> <span class="fu">discretize</span>(mtpl_be<span class="sc">$</span>POWER, <span class="at">cuts=</span><span class="dv">3</span>)</span></code></pre></div>
<pre><code>## Bins: 163232 (includes missing category)
## Breaks: -Inf, 44, 60, Inf</code></pre>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" tabindex="-1"></a>mtpl_be<span class="sc">$</span>POWER <span class="sc">%&gt;%</span> <span class="fu">discretize</span>(mtpl_be<span class="sc">$</span>POWER, <span class="at">cuts=</span><span class="dv">4</span>)</span></code></pre></div>
<pre><code>## Bins: 163232 (includes missing category)
## Breaks: -Inf, 43, 53, 66, Inf</code></pre>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" tabindex="-1"></a>mtpl_be<span class="sc">$</span>POWER <span class="sc">%&gt;%</span> <span class="fu">discretize</span>(mtpl_be<span class="sc">$</span>POWER, <span class="at">cuts=</span><span class="dv">5</span>)</span></code></pre></div>
<pre><code>## Bins: 163232 (includes missing category)
## Breaks: -Inf, 40, 48, 55, 66, Inf</code></pre>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" tabindex="-1"></a>mtpl_be<span class="sc">$</span>POWER <span class="sc">%&gt;%</span> <span class="fu">discretize</span>(mtpl_be<span class="sc">$</span>POWER, <span class="at">cuts=</span><span class="dv">6</span>)</span></code></pre></div>
<pre><code>## Bins: 163232 (includes missing category)</code></pre>
<p>These are the different factor ranges.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" tabindex="-1"></a>mtpl_be <span class="ot">&lt;-</span> mtpl_be <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">POWER_fac =</span> <span class="fu">cut</span>(POWER , <span class="at">breaks=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.5</span>, <span class="dv">40</span>, <span class="dv">48</span>, <span class="dv">55</span>, <span class="dv">66</span>, <span class="fu">max</span>(mtpl_be<span class="sc">$</span>POWER))))</span>
<span id="cb67-2"><a href="#cb67-2" tabindex="-1"></a><span class="fu">levels</span>(mtpl_be<span class="sc">$</span>POWER_fac)</span></code></pre></div>
<pre><code>## [1] &quot;(-0.5,40]&quot; &quot;(40,48]&quot;   &quot;(48,55]&quot;   &quot;(55,66]&quot;   &quot;(66,243]&quot;</code></pre>
<p>The reference level remains unchanged as the highest percentage of
observed horsepower is in the range 0 to 40.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" tabindex="-1"></a>mtpl_be<span class="sc">$</span>POWER_fac <span class="sc">%&gt;%</span> <span class="fu">fct_count</span>(<span class="at">sort=</span><span class="cn">TRUE</span>,<span class="at">prop =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## # A tibble: 5 × 3
##   f             n     p
##   &lt;fct&gt;     &lt;int&gt; &lt;dbl&gt;
## 1 (-0.5,40] 37271 0.228
## 2 (48,55]   35584 0.218
## 3 (66,243]  31741 0.194
## 4 (40,48]   29488 0.181
## 5 (55,66]   29147 0.179</code></pre>
</div>
<div id="bm" class="section level3">
<h3>Bm</h3>
<p>The final variable we will be processing is the one relative to the
level in the former compulsory Belgian bonus-malus scale. It goes from
level 0 to 22, where the higher level indicates the worse claim
history.</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" tabindex="-1"></a><span class="fu">hist</span>(mtpl_be<span class="sc">$</span>BM, <span class="at">main =</span> <span class="st">&quot;Level in the BM scale&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;level&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="100%" /></p>
<p>Since the discretize function does not provide any suggestion of
bins, we made assumptions based on the histogram, and chose the
following four categories</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" tabindex="-1"></a>mtpl_be <span class="ot">&lt;-</span> mtpl_be <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">BM_fac =</span> <span class="fu">cut</span>(BM, <span class="at">breaks=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.5</span>,<span class="dv">0</span>, <span class="dv">5</span>,<span class="dv">11</span>, <span class="fu">max</span>(mtpl_be<span class="sc">$</span>BM))))</span>
<span id="cb72-2"><a href="#cb72-2" tabindex="-1"></a><span class="fu">levels</span>(mtpl_be<span class="sc">$</span>BM_fac)</span></code></pre></div>
<pre><code>## [1] &quot;(-0.5,0]&quot; &quot;(0,5]&quot;    &quot;(5,11]&quot;   &quot;(11,22]&quot;</code></pre>
<p>Although the first factor only accounts for level 0, it is clearly
the most observed value and deserved to be on its own. To support my
assumption, we see that it may remain as the reference level since it
gathers approximately 37.77% of the policyholders.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" tabindex="-1"></a>mtpl_be<span class="sc">$</span>BM_fac <span class="sc">%&gt;%</span> <span class="fu">fct_count</span>(<span class="at">sort=</span><span class="cn">TRUE</span>,<span class="at">prop =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## # A tibble: 4 × 3
##   f            n      p
##   &lt;fct&gt;    &lt;int&gt;  &lt;dbl&gt;
## 1 (-0.5,0] 61650 0.378 
## 2 (0,5]    60742 0.372 
## 3 (5,11]   36247 0.222 
## 4 (11,22]   4592 0.0281</code></pre>
</div>
</div>
<div id="exploratory-data-analysis" class="section level2">
<h2>Exploratory data analysis</h2>
<p>We completed the first key part of working with data which is data
processing. In this section, we will represent in a more visual way the
different values we are dealing with to further fit our GLM. Indeed, in
this section, we will investigate how each information from
policyholders have an influence on the claim frequency.</p>
<div id="coverage-1" class="section level3">
<h3>Coverage</h3>
<p>Let’s first start with information regarding coverage. We observe
that <em>TPL</em> tend to cause the highest claim frequency with 14.6%
while <em>Partial omnium (PO)</em> scores lowest with 12.78%. In
between, we find the <em>Full omnium (FO)</em> category with 13.54%. We
thus conclude that in general, based on our data set, <em>TPL</em>
coverage tend to have 2.18% and 1.06% more claims than <em>PO</em> and
<em>FO</em> repsectively.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" tabindex="-1"></a><span class="co"># Summarise coverage</span></span>
<span id="cb76-2"><a href="#cb76-2" tabindex="-1"></a>cov_summary <span class="ot">&lt;-</span> mtpl_be <span class="sc">%&gt;%</span></span>
<span id="cb76-3"><a href="#cb76-3" tabindex="-1"></a>  <span class="fu">group_by</span>(COVERAGE) <span class="sc">%&gt;%</span></span>
<span id="cb76-4"><a href="#cb76-4" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb76-5"><a href="#cb76-5" tabindex="-1"></a>    <span class="at">totalExposure =</span> <span class="fu">sum</span>(EXP),</span>
<span id="cb76-6"><a href="#cb76-6" tabindex="-1"></a>    <span class="at">Number.Claims =</span> <span class="fu">sum</span>(NCLAIMS),</span>
<span id="cb76-7"><a href="#cb76-7" tabindex="-1"></a>    <span class="at">Obs.Claim.Freq =</span> <span class="fu">sum</span>(NCLAIMS) <span class="sc">/</span> <span class="fu">sum</span>(EXP),</span>
<span id="cb76-8"><a href="#cb76-8" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">&quot;drop&quot;</span></span>
<span id="cb76-9"><a href="#cb76-9" tabindex="-1"></a>  )</span>
<span id="cb76-10"><a href="#cb76-10" tabindex="-1"></a></span>
<span id="cb76-11"><a href="#cb76-11" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb76-12"><a href="#cb76-12" tabindex="-1"></a>  cov_summary,</span>
<span id="cb76-13"><a href="#cb76-13" tabindex="-1"></a>  <span class="fu">aes</span>(</span>
<span id="cb76-14"><a href="#cb76-14" tabindex="-1"></a>    <span class="at">x =</span> COVERAGE, <span class="at">y =</span> Obs.Claim.Freq,</span>
<span id="cb76-15"><a href="#cb76-15" tabindex="-1"></a>    <span class="at">fill =</span> COVERAGE,</span>
<span id="cb76-16"><a href="#cb76-16" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">percent</span>(Obs.Claim.Freq, <span class="at">accuracy=</span><span class="fl">0.01</span>)</span>
<span id="cb76-17"><a href="#cb76-17" tabindex="-1"></a>  )</span>
<span id="cb76-18"><a href="#cb76-18" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb76-19"><a href="#cb76-19" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>) <span class="sc">+</span></span>
<span id="cb76-20"><a href="#cb76-20" tabindex="-1"></a>  <span class="fu">geom_label</span>() <span class="sc">+</span></span>
<span id="cb76-21"><a href="#cb76-21" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb76-22"><a href="#cb76-22" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">name =</span> <span class="st">&quot;Coverage type&quot;</span> ) <span class="sc">+</span></span>
<span id="cb76-23"><a href="#cb76-23" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Dark2&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="100%" /></p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">&quot;Observed claim Frequency&quot;</span>, <span class="at">labels =</span> <span class="fu">label_percent</span>())</span></code></pre></div>
<pre><code>## &lt;ScaleContinuousPosition&gt;
##  Range:  
##  Limits:    0 --    1</code></pre>
</div>
<div id="fuel-1" class="section level3">
<h3>Fuel</h3>
<p>Here we observe that Fuel represents an important factor in claim
frequency with <em>diesel</em> scoring more than 2.5% more than
<em>gasoline</em></p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" tabindex="-1"></a>gas_summary <span class="ot">&lt;-</span> mtpl_be <span class="sc">%&gt;%</span></span>
<span id="cb79-2"><a href="#cb79-2" tabindex="-1"></a>  <span class="fu">group_by</span>(FUEL) <span class="sc">%&gt;%</span></span>
<span id="cb79-3"><a href="#cb79-3" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb79-4"><a href="#cb79-4" tabindex="-1"></a>    <span class="at">totalExposure =</span> <span class="fu">sum</span>(EXP),</span>
<span id="cb79-5"><a href="#cb79-5" tabindex="-1"></a>    <span class="at">Number.Observations =</span> <span class="fu">length</span>(EXP),</span>
<span id="cb79-6"><a href="#cb79-6" tabindex="-1"></a>    <span class="at">Number.Claims =</span> <span class="fu">sum</span>(NCLAIMS),</span>
<span id="cb79-7"><a href="#cb79-7" tabindex="-1"></a>    <span class="at">Obs.Claim.Freq =</span> <span class="fu">sum</span>(NCLAIMS) <span class="sc">/</span> <span class="fu">sum</span>(EXP)</span>
<span id="cb79-8"><a href="#cb79-8" tabindex="-1"></a>  )</span>
<span id="cb79-9"><a href="#cb79-9" tabindex="-1"></a></span>
<span id="cb79-10"><a href="#cb79-10" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb79-11"><a href="#cb79-11" tabindex="-1"></a>  gas_summary,</span>
<span id="cb79-12"><a href="#cb79-12" tabindex="-1"></a>  <span class="fu">aes</span>(</span>
<span id="cb79-13"><a href="#cb79-13" tabindex="-1"></a>    <span class="at">x =</span> FUEL, <span class="at">y =</span> Obs.Claim.Freq,</span>
<span id="cb79-14"><a href="#cb79-14" tabindex="-1"></a>    <span class="at">fill =</span> FUEL,</span>
<span id="cb79-15"><a href="#cb79-15" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">percent</span>(Obs.Claim.Freq, <span class="at">accuracy=</span><span class="fl">0.01</span>)</span>
<span id="cb79-16"><a href="#cb79-16" tabindex="-1"></a>  )</span>
<span id="cb79-17"><a href="#cb79-17" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb79-18"><a href="#cb79-18" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>) <span class="sc">+</span></span>
<span id="cb79-19"><a href="#cb79-19" tabindex="-1"></a>  <span class="fu">geom_label</span>() <span class="sc">+</span></span>
<span id="cb79-20"><a href="#cb79-20" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb79-21"><a href="#cb79-21" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">name =</span> <span class="st">&quot;Fuel&quot;</span>) <span class="sc">+</span></span>
<span id="cb79-22"><a href="#cb79-22" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">&quot;Observed claim Frequency&quot;</span>, <span class="at">labels =</span> <span class="fu">label_percent</span>())</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="100%" /></p>
</div>
<div id="sex-1" class="section level3">
<h3>Sex</h3>
<p>In this case we observe the difference in claims frequency between
men and women. Based on the observed data in our data set, women tend to
cause more claims than man with an increase of 1.23%.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" tabindex="-1"></a>sex_summary <span class="ot">&lt;-</span> mtpl_be <span class="sc">%&gt;%</span></span>
<span id="cb80-2"><a href="#cb80-2" tabindex="-1"></a>  <span class="fu">group_by</span>(SEX) <span class="sc">%&gt;%</span></span>
<span id="cb80-3"><a href="#cb80-3" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb80-4"><a href="#cb80-4" tabindex="-1"></a>    <span class="at">totalExposure =</span> <span class="fu">sum</span>(EXP),</span>
<span id="cb80-5"><a href="#cb80-5" tabindex="-1"></a>    <span class="at">Number.Observations =</span> <span class="fu">length</span>(EXP),</span>
<span id="cb80-6"><a href="#cb80-6" tabindex="-1"></a>    <span class="at">Number.Claims =</span> <span class="fu">sum</span>(NCLAIMS),</span>
<span id="cb80-7"><a href="#cb80-7" tabindex="-1"></a>    <span class="at">Obs.Claim.Freq =</span> <span class="fu">sum</span>(NCLAIMS) <span class="sc">/</span> <span class="fu">sum</span>(EXP)</span>
<span id="cb80-8"><a href="#cb80-8" tabindex="-1"></a>  )</span>
<span id="cb80-9"><a href="#cb80-9" tabindex="-1"></a></span>
<span id="cb80-10"><a href="#cb80-10" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb80-11"><a href="#cb80-11" tabindex="-1"></a>  sex_summary,</span>
<span id="cb80-12"><a href="#cb80-12" tabindex="-1"></a>  <span class="fu">aes</span>(</span>
<span id="cb80-13"><a href="#cb80-13" tabindex="-1"></a>    <span class="at">x =</span> SEX, <span class="at">y =</span> Obs.Claim.Freq,</span>
<span id="cb80-14"><a href="#cb80-14" tabindex="-1"></a>    <span class="at">fill =</span> SEX,</span>
<span id="cb80-15"><a href="#cb80-15" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">percent</span>(Obs.Claim.Freq, <span class="at">accuracy=</span><span class="fl">0.01</span>)</span>
<span id="cb80-16"><a href="#cb80-16" tabindex="-1"></a>  )</span>
<span id="cb80-17"><a href="#cb80-17" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb80-18"><a href="#cb80-18" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>) <span class="sc">+</span></span>
<span id="cb80-19"><a href="#cb80-19" tabindex="-1"></a>  <span class="fu">geom_label</span>() <span class="sc">+</span></span>
<span id="cb80-20"><a href="#cb80-20" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb80-21"><a href="#cb80-21" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">name =</span> <span class="st">&quot;Gender&quot;</span>) <span class="sc">+</span></span>
<span id="cb80-22"><a href="#cb80-22" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">&quot;Observed claim Frequency&quot;</span>, <span class="at">labels =</span> <span class="fu">label_percent</span>())<span class="sc">+</span></span>
<span id="cb80-23"><a href="#cb80-23" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette=</span><span class="st">&quot;Dark2&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="100%" /></p>
</div>
<div id="use-1" class="section level3">
<h3>Use</h3>
<p>When investigating the use of the car, we observe only a slight
difference in frequency, which gives us the insight that this
information is not the most important one when modelling claim
frequencies.</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" tabindex="-1"></a>use_summary <span class="ot">&lt;-</span> mtpl_be <span class="sc">%&gt;%</span></span>
<span id="cb81-2"><a href="#cb81-2" tabindex="-1"></a>  <span class="fu">group_by</span>(USE) <span class="sc">%&gt;%</span></span>
<span id="cb81-3"><a href="#cb81-3" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb81-4"><a href="#cb81-4" tabindex="-1"></a>    <span class="at">totalExposure =</span> <span class="fu">sum</span>(EXP),</span>
<span id="cb81-5"><a href="#cb81-5" tabindex="-1"></a>    <span class="at">Number.Observations =</span> <span class="fu">length</span>(EXP),</span>
<span id="cb81-6"><a href="#cb81-6" tabindex="-1"></a>    <span class="at">Number.Claims =</span> <span class="fu">sum</span>(NCLAIMS),</span>
<span id="cb81-7"><a href="#cb81-7" tabindex="-1"></a>    <span class="at">Obs.Claim.Freq =</span> <span class="fu">sum</span>(NCLAIMS) <span class="sc">/</span> <span class="fu">sum</span>(EXP)</span>
<span id="cb81-8"><a href="#cb81-8" tabindex="-1"></a>  )</span>
<span id="cb81-9"><a href="#cb81-9" tabindex="-1"></a></span>
<span id="cb81-10"><a href="#cb81-10" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb81-11"><a href="#cb81-11" tabindex="-1"></a>  use_summary,</span>
<span id="cb81-12"><a href="#cb81-12" tabindex="-1"></a>  <span class="fu">aes</span>(</span>
<span id="cb81-13"><a href="#cb81-13" tabindex="-1"></a>    <span class="at">x =</span> USE, <span class="at">y =</span> Obs.Claim.Freq,</span>
<span id="cb81-14"><a href="#cb81-14" tabindex="-1"></a>    <span class="at">fill =</span> USE,</span>
<span id="cb81-15"><a href="#cb81-15" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">percent</span>(Obs.Claim.Freq, <span class="at">accuracy=</span><span class="fl">0.01</span>)</span>
<span id="cb81-16"><a href="#cb81-16" tabindex="-1"></a>  )</span>
<span id="cb81-17"><a href="#cb81-17" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb81-18"><a href="#cb81-18" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>) <span class="sc">+</span></span>
<span id="cb81-19"><a href="#cb81-19" tabindex="-1"></a>  <span class="fu">geom_label</span>() <span class="sc">+</span></span>
<span id="cb81-20"><a href="#cb81-20" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb81-21"><a href="#cb81-21" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">name =</span> <span class="st">&quot;Use&quot;</span>) <span class="sc">+</span></span>
<span id="cb81-22"><a href="#cb81-22" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">&quot;Observed claim Frequency&quot;</span>, <span class="at">labels =</span> <span class="fu">label_percent</span>())<span class="sc">+</span></span>
<span id="cb81-23"><a href="#cb81-23" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">wes_palette</span>(<span class="at">name=</span><span class="st">&quot;GrandBudapest1&quot;</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="100%" /></p>
</div>
<div id="fleet-1" class="section level3">
<h3>Fleet</h3>
<p>On the other hand, not being part of a fleet tends to cause almost 3%
more claims than being in one.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" tabindex="-1"></a>fleet_summary <span class="ot">&lt;-</span> mtpl_be <span class="sc">%&gt;%</span></span>
<span id="cb82-2"><a href="#cb82-2" tabindex="-1"></a>  <span class="fu">group_by</span>(FLEET) <span class="sc">%&gt;%</span></span>
<span id="cb82-3"><a href="#cb82-3" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb82-4"><a href="#cb82-4" tabindex="-1"></a>    <span class="at">totalExposure =</span> <span class="fu">sum</span>(EXP),</span>
<span id="cb82-5"><a href="#cb82-5" tabindex="-1"></a>    <span class="at">Number.Observations =</span> <span class="fu">length</span>(EXP),</span>
<span id="cb82-6"><a href="#cb82-6" tabindex="-1"></a>    <span class="at">Number.Claims =</span> <span class="fu">sum</span>(NCLAIMS),</span>
<span id="cb82-7"><a href="#cb82-7" tabindex="-1"></a>    <span class="at">Obs.Claim.Freq =</span> <span class="fu">sum</span>(NCLAIMS) <span class="sc">/</span> <span class="fu">sum</span>(EXP)</span>
<span id="cb82-8"><a href="#cb82-8" tabindex="-1"></a>  )</span>
<span id="cb82-9"><a href="#cb82-9" tabindex="-1"></a></span>
<span id="cb82-10"><a href="#cb82-10" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb82-11"><a href="#cb82-11" tabindex="-1"></a>  fleet_summary,</span>
<span id="cb82-12"><a href="#cb82-12" tabindex="-1"></a>  <span class="fu">aes</span>(</span>
<span id="cb82-13"><a href="#cb82-13" tabindex="-1"></a>    <span class="at">x =</span> FLEET, <span class="at">y =</span> Obs.Claim.Freq,</span>
<span id="cb82-14"><a href="#cb82-14" tabindex="-1"></a>    <span class="at">fill =</span>FLEET,</span>
<span id="cb82-15"><a href="#cb82-15" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">percent</span>(Obs.Claim.Freq, <span class="at">accuracy=</span><span class="fl">0.01</span>)</span>
<span id="cb82-16"><a href="#cb82-16" tabindex="-1"></a>  )</span>
<span id="cb82-17"><a href="#cb82-17" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb82-18"><a href="#cb82-18" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>) <span class="sc">+</span></span>
<span id="cb82-19"><a href="#cb82-19" tabindex="-1"></a>  <span class="fu">geom_label</span>() <span class="sc">+</span></span>
<span id="cb82-20"><a href="#cb82-20" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb82-21"><a href="#cb82-21" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">name =</span> <span class="st">&quot;Fleet&quot;</span>) <span class="sc">+</span></span>
<span id="cb82-22"><a href="#cb82-22" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">&quot;Observed claim Frequency&quot;</span>, <span class="at">labels =</span> <span class="fu">label_percent</span>())<span class="sc">+</span></span>
<span id="cb82-23"><a href="#cb82-23" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">wes_palette</span>(<span class="at">name=</span><span class="st">&quot;Chevalier1&quot;</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="100%" /></p>
</div>
<div id="ageph-1" class="section level3">
<h3>ageph</h3>
<p>We know from a fact that the age of the policyholder is an important
information regarding claim frequency. This argument is supported with
the following graph showing young drivers between 18 and 31 having much
higher frequency than any other subgroups, peaking at 21.36%. We then
observe claim frequency decreasing with age until observing an upward
trend for elderlies above 82. This trend is actually quite
representative of what might be observed in other data sets and research
studies.</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" tabindex="-1"></a>ageph_summary <span class="ot">&lt;-</span> mtpl_be <span class="sc">%&gt;%</span></span>
<span id="cb83-2"><a href="#cb83-2" tabindex="-1"></a>  <span class="fu">group_by</span>(AGEPH_fac) <span class="sc">%&gt;%</span></span>
<span id="cb83-3"><a href="#cb83-3" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb83-4"><a href="#cb83-4" tabindex="-1"></a>    <span class="at">totalExposure =</span> <span class="fu">sum</span>(EXP),</span>
<span id="cb83-5"><a href="#cb83-5" tabindex="-1"></a>    <span class="at">Number.Observations =</span> <span class="fu">length</span>(EXP),</span>
<span id="cb83-6"><a href="#cb83-6" tabindex="-1"></a>    <span class="at">Number.Claims =</span> <span class="fu">sum</span>(NCLAIMS),</span>
<span id="cb83-7"><a href="#cb83-7" tabindex="-1"></a>    <span class="at">Obs.Claim.Freq =</span> <span class="fu">sum</span>(NCLAIMS) <span class="sc">/</span> <span class="fu">sum</span>(EXP)</span>
<span id="cb83-8"><a href="#cb83-8" tabindex="-1"></a>  )</span>
<span id="cb83-9"><a href="#cb83-9" tabindex="-1"></a></span>
<span id="cb83-10"><a href="#cb83-10" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb83-11"><a href="#cb83-11" tabindex="-1"></a>  ageph_summary,</span>
<span id="cb83-12"><a href="#cb83-12" tabindex="-1"></a>  <span class="fu">aes</span>(</span>
<span id="cb83-13"><a href="#cb83-13" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">reorder</span>(AGEPH_fac,<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">6</span>), <span class="at">decreasing=</span><span class="cn">FALSE</span>), <span class="at">y =</span> Obs.Claim.Freq,</span>
<span id="cb83-14"><a href="#cb83-14" tabindex="-1"></a>    <span class="at">fill =</span>AGEPH_fac,</span>
<span id="cb83-15"><a href="#cb83-15" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">percent</span>(Obs.Claim.Freq, <span class="at">accuracy=</span><span class="fl">0.01</span>)</span>
<span id="cb83-16"><a href="#cb83-16" tabindex="-1"></a>  )</span>
<span id="cb83-17"><a href="#cb83-17" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb83-18"><a href="#cb83-18" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>) <span class="sc">+</span></span>
<span id="cb83-19"><a href="#cb83-19" tabindex="-1"></a>  <span class="fu">geom_label</span>() <span class="sc">+</span></span>
<span id="cb83-20"><a href="#cb83-20" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb83-21"><a href="#cb83-21" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">name =</span> <span class="st">&quot;Policyholder&#39;s age&quot;</span>) <span class="sc">+</span></span>
<span id="cb83-22"><a href="#cb83-22" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">&quot;Observed claim Frequency&quot;</span>, <span class="at">labels =</span> <span class="fu">label_percent</span>())<span class="sc">+</span></span>
<span id="cb83-23"><a href="#cb83-23" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;BrBG&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="100%" /></p>
</div>
<div id="age-c" class="section level3">
<h3>Age C</h3>
<p>We tend to see a slight increase of the number of claims when the car
gets older. Indeed, the interval (9,48] scores 1% more than cars between
0 and 5 years old and 0.5% for cars aged between 6 and 9.</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" tabindex="-1"></a>agec_summary <span class="ot">&lt;-</span> mtpl_be <span class="sc">%&gt;%</span></span>
<span id="cb84-2"><a href="#cb84-2" tabindex="-1"></a>  <span class="fu">group_by</span>(AGEC_fac) <span class="sc">%&gt;%</span></span>
<span id="cb84-3"><a href="#cb84-3" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb84-4"><a href="#cb84-4" tabindex="-1"></a>    <span class="at">totalExposure =</span> <span class="fu">sum</span>(EXP),</span>
<span id="cb84-5"><a href="#cb84-5" tabindex="-1"></a>    <span class="at">Number.Observations =</span> <span class="fu">length</span>(EXP),</span>
<span id="cb84-6"><a href="#cb84-6" tabindex="-1"></a>    <span class="at">Number.Claims =</span> <span class="fu">sum</span>(NCLAIMS),</span>
<span id="cb84-7"><a href="#cb84-7" tabindex="-1"></a>    <span class="at">Obs.Claim.Freq =</span> <span class="fu">sum</span>(NCLAIMS) <span class="sc">/</span> <span class="fu">sum</span>(EXP)</span>
<span id="cb84-8"><a href="#cb84-8" tabindex="-1"></a>  )</span>
<span id="cb84-9"><a href="#cb84-9" tabindex="-1"></a></span>
<span id="cb84-10"><a href="#cb84-10" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb84-11"><a href="#cb84-11" tabindex="-1"></a>  agec_summary,</span>
<span id="cb84-12"><a href="#cb84-12" tabindex="-1"></a>  <span class="fu">aes</span>(</span>
<span id="cb84-13"><a href="#cb84-13" tabindex="-1"></a>    <span class="at">x =</span> AGEC_fac, <span class="at">y =</span> Obs.Claim.Freq,</span>
<span id="cb84-14"><a href="#cb84-14" tabindex="-1"></a>    <span class="at">fill =</span>AGEC_fac,</span>
<span id="cb84-15"><a href="#cb84-15" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">percent</span>(Obs.Claim.Freq, <span class="at">accuracy=</span><span class="fl">0.01</span>)</span>
<span id="cb84-16"><a href="#cb84-16" tabindex="-1"></a>  )</span>
<span id="cb84-17"><a href="#cb84-17" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb84-18"><a href="#cb84-18" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>) <span class="sc">+</span></span>
<span id="cb84-19"><a href="#cb84-19" tabindex="-1"></a>  <span class="fu">geom_label</span>() <span class="sc">+</span></span>
<span id="cb84-20"><a href="#cb84-20" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb84-21"><a href="#cb84-21" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">name =</span> <span class="st">&quot;Car age&quot;</span>) <span class="sc">+</span></span>
<span id="cb84-22"><a href="#cb84-22" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">&quot;Observed claim Frequency&quot;</span>, <span class="at">labels =</span> <span class="fu">label_percent</span>())<span class="sc">+</span></span>
<span id="cb84-23"><a href="#cb84-23" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;PuOr&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="100%" /></p>
</div>
<div id="power-1" class="section level3">
<h3>Power</h3>
<p>Although we might expect the power of the vehicle to have a huge
impact on the number of claims, we observe slight differences between
categories. But lowest power in kilowatts still has the lowest frequency
while the highest category rises by apporximately 1.6% from the
reference level.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" tabindex="-1"></a>pow_summary <span class="ot">&lt;-</span> mtpl_be <span class="sc">%&gt;%</span></span>
<span id="cb85-2"><a href="#cb85-2" tabindex="-1"></a>  <span class="fu">group_by</span>(POWER_fac) <span class="sc">%&gt;%</span></span>
<span id="cb85-3"><a href="#cb85-3" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb85-4"><a href="#cb85-4" tabindex="-1"></a>    <span class="at">totalExposure =</span> <span class="fu">sum</span>(EXP),</span>
<span id="cb85-5"><a href="#cb85-5" tabindex="-1"></a>    <span class="at">Number.Observations =</span> <span class="fu">length</span>(EXP),</span>
<span id="cb85-6"><a href="#cb85-6" tabindex="-1"></a>    <span class="at">Number.Claims =</span> <span class="fu">sum</span>(NCLAIMS),</span>
<span id="cb85-7"><a href="#cb85-7" tabindex="-1"></a>    <span class="at">Obs.Claim.Freq =</span> <span class="fu">sum</span>(NCLAIMS) <span class="sc">/</span> <span class="fu">sum</span>(EXP)</span>
<span id="cb85-8"><a href="#cb85-8" tabindex="-1"></a>  )</span>
<span id="cb85-9"><a href="#cb85-9" tabindex="-1"></a></span>
<span id="cb85-10"><a href="#cb85-10" tabindex="-1"></a></span>
<span id="cb85-11"><a href="#cb85-11" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb85-12"><a href="#cb85-12" tabindex="-1"></a>  pow_summary,</span>
<span id="cb85-13"><a href="#cb85-13" tabindex="-1"></a>  <span class="fu">aes</span>(</span>
<span id="cb85-14"><a href="#cb85-14" tabindex="-1"></a>    <span class="at">x =</span> POWER_fac, <span class="at">y =</span> Obs.Claim.Freq,</span>
<span id="cb85-15"><a href="#cb85-15" tabindex="-1"></a>    <span class="at">fill =</span>POWER_fac,</span>
<span id="cb85-16"><a href="#cb85-16" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">percent</span>(Obs.Claim.Freq, <span class="at">accuracy=</span><span class="fl">0.01</span>)</span>
<span id="cb85-17"><a href="#cb85-17" tabindex="-1"></a>  )</span>
<span id="cb85-18"><a href="#cb85-18" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb85-19"><a href="#cb85-19" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>) <span class="sc">+</span></span>
<span id="cb85-20"><a href="#cb85-20" tabindex="-1"></a>  <span class="fu">geom_label</span>() <span class="sc">+</span></span>
<span id="cb85-21"><a href="#cb85-21" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb85-22"><a href="#cb85-22" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">name =</span> <span class="st">&quot;Power in kw&quot;</span>) <span class="sc">+</span></span>
<span id="cb85-23"><a href="#cb85-23" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">&quot;Observed claim Frequency&quot;</span>, <span class="at">labels =</span> <span class="fu">label_percent</span>())<span class="sc">+</span></span>
<span id="cb85-24"><a href="#cb85-24" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;PRGn&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="100%" /></p>
<p>Although the plot above shows that the frequency of claims is higher
for high power, for the sake of visualization only, we have subdivided
the categories even more to better show the linear relationship with
power. We won’t use this classification since the extreme categories are
too small sampled compared to others which might bias our statistical
analysis. Therefore, we will stick with our former intervals regarding
POWER for later use.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" tabindex="-1"></a>mtpl_be2 <span class="ot">&lt;-</span> mtpl_be <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">POWER_fac =</span> <span class="fu">cut</span>(POWER , <span class="at">breaks=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.5</span>, <span class="dv">20</span>, <span class="dv">60</span>, <span class="dv">70</span>, <span class="dv">110</span>, <span class="fu">max</span>(mtpl_be<span class="sc">$</span>POWER))))</span>
<span id="cb86-2"><a href="#cb86-2" tabindex="-1"></a>mtpl_be2<span class="sc">$</span>POWER_fac <span class="sc">%&gt;%</span> <span class="fu">fct_count</span>(<span class="at">sort=</span><span class="cn">TRUE</span>,<span class="at">prop =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## # A tibble: 5 × 3
##   f              n       p
##   &lt;fct&gt;      &lt;int&gt;   &lt;dbl&gt;
## 1 (20,60]   110122 0.675  
## 2 (60,70]    26596 0.163  
## 3 (70,110]   24679 0.151  
## 4 (110,243]   1637 0.0100 
## 5 (-0.5,20]    197 0.00121</code></pre>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" tabindex="-1"></a>pow_summary2 <span class="ot">&lt;-</span> mtpl_be2 <span class="sc">%&gt;%</span></span>
<span id="cb88-2"><a href="#cb88-2" tabindex="-1"></a>  <span class="fu">group_by</span>(POWER_fac) <span class="sc">%&gt;%</span></span>
<span id="cb88-3"><a href="#cb88-3" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb88-4"><a href="#cb88-4" tabindex="-1"></a>    <span class="at">totalExposure =</span> <span class="fu">sum</span>(EXP),</span>
<span id="cb88-5"><a href="#cb88-5" tabindex="-1"></a>    <span class="at">Number.Observations =</span> <span class="fu">length</span>(EXP),</span>
<span id="cb88-6"><a href="#cb88-6" tabindex="-1"></a>    <span class="at">Number.Claims =</span> <span class="fu">sum</span>(NCLAIMS),</span>
<span id="cb88-7"><a href="#cb88-7" tabindex="-1"></a>    <span class="at">Obs.Claim.Freq =</span> <span class="fu">sum</span>(NCLAIMS) <span class="sc">/</span> <span class="fu">sum</span>(EXP)</span>
<span id="cb88-8"><a href="#cb88-8" tabindex="-1"></a>  )</span>
<span id="cb88-9"><a href="#cb88-9" tabindex="-1"></a></span>
<span id="cb88-10"><a href="#cb88-10" tabindex="-1"></a></span>
<span id="cb88-11"><a href="#cb88-11" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb88-12"><a href="#cb88-12" tabindex="-1"></a>  pow_summary2,</span>
<span id="cb88-13"><a href="#cb88-13" tabindex="-1"></a>  <span class="fu">aes</span>(</span>
<span id="cb88-14"><a href="#cb88-14" tabindex="-1"></a>    <span class="at">x =</span> POWER_fac, <span class="at">y =</span> Obs.Claim.Freq,</span>
<span id="cb88-15"><a href="#cb88-15" tabindex="-1"></a>    <span class="at">fill =</span>POWER_fac,</span>
<span id="cb88-16"><a href="#cb88-16" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">percent</span>(Obs.Claim.Freq, <span class="at">accuracy=</span><span class="fl">0.01</span>)</span>
<span id="cb88-17"><a href="#cb88-17" tabindex="-1"></a>  )</span>
<span id="cb88-18"><a href="#cb88-18" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb88-19"><a href="#cb88-19" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>) <span class="sc">+</span></span>
<span id="cb88-20"><a href="#cb88-20" tabindex="-1"></a>  <span class="fu">geom_label</span>() <span class="sc">+</span></span>
<span id="cb88-21"><a href="#cb88-21" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb88-22"><a href="#cb88-22" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">name =</span> <span class="st">&quot;Power in kw&quot;</span>) <span class="sc">+</span></span>
<span id="cb88-23"><a href="#cb88-23" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">&quot;Observed claim Frequency&quot;</span>, <span class="at">labels =</span> <span class="fu">label_percent</span>())<span class="sc">+</span></span>
<span id="cb88-24"><a href="#cb88-24" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;PRGn&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="100%" /></p>
<p>Here we thus observe clearly that claims are more frequent as the
car’s horsepower increases.</p>
</div>
<div id="bm-1" class="section level3">
<h3>BM</h3>
<p>Lastly, when investigating the relation between the Bonus-malus scale
and the frequency of claims, we observe a clear increase when going up
the ladder. The results can be intuitively assumed since a policyholder
will go up the ladder when he or she reports a claim where he or she is
at fault. Naturally, the more the persons reports claims, the more that
person will be up on the ladder and higher claim frequency might be
observed in higher intervals. Although the reference level is level 0,
the claim frequency more than doubles compared to levels between 12 and
22. One might think that these observations are biased since the
category 12 to 22 gathers half the levels in the BM scale, but it
actually accounts for 2.81% of the policyholders. The results are then
really self-explanatory.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" tabindex="-1"></a>bm_summary <span class="ot">&lt;-</span> mtpl_be <span class="sc">%&gt;%</span></span>
<span id="cb89-2"><a href="#cb89-2" tabindex="-1"></a>  <span class="fu">group_by</span>(BM_fac) <span class="sc">%&gt;%</span></span>
<span id="cb89-3"><a href="#cb89-3" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb89-4"><a href="#cb89-4" tabindex="-1"></a>    <span class="at">totalExposure =</span> <span class="fu">sum</span>(EXP),</span>
<span id="cb89-5"><a href="#cb89-5" tabindex="-1"></a>    <span class="at">Number.Observations =</span> <span class="fu">length</span>(EXP),</span>
<span id="cb89-6"><a href="#cb89-6" tabindex="-1"></a>    <span class="at">Number.Claims =</span> <span class="fu">sum</span>(NCLAIMS),</span>
<span id="cb89-7"><a href="#cb89-7" tabindex="-1"></a>    <span class="at">Obs.Claim.Freq =</span> <span class="fu">sum</span>(NCLAIMS) <span class="sc">/</span> <span class="fu">sum</span>(EXP)</span>
<span id="cb89-8"><a href="#cb89-8" tabindex="-1"></a>  )</span>
<span id="cb89-9"><a href="#cb89-9" tabindex="-1"></a></span>
<span id="cb89-10"><a href="#cb89-10" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb89-11"><a href="#cb89-11" tabindex="-1"></a>  bm_summary,</span>
<span id="cb89-12"><a href="#cb89-12" tabindex="-1"></a>  <span class="fu">aes</span>(</span>
<span id="cb89-13"><a href="#cb89-13" tabindex="-1"></a>    <span class="at">x =</span> BM_fac, <span class="at">y =</span> Obs.Claim.Freq,</span>
<span id="cb89-14"><a href="#cb89-14" tabindex="-1"></a>    <span class="at">fill =</span>BM_fac,</span>
<span id="cb89-15"><a href="#cb89-15" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">percent</span>(Obs.Claim.Freq, <span class="at">accuracy=</span><span class="fl">0.01</span>)</span>
<span id="cb89-16"><a href="#cb89-16" tabindex="-1"></a>  )</span>
<span id="cb89-17"><a href="#cb89-17" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb89-18"><a href="#cb89-18" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>) <span class="sc">+</span></span>
<span id="cb89-19"><a href="#cb89-19" tabindex="-1"></a>  <span class="fu">geom_label</span>() <span class="sc">+</span></span>
<span id="cb89-20"><a href="#cb89-20" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb89-21"><a href="#cb89-21" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">name =</span> <span class="st">&quot;Bonus-Malus level&quot;</span>) <span class="sc">+</span></span>
<span id="cb89-22"><a href="#cb89-22" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">&quot;Observed claim Frequency&quot;</span>, <span class="at">labels =</span> <span class="fu">label_percent</span>())<span class="sc">+</span></span>
<span id="cb89-23"><a href="#cb89-23" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;PuOr&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="100%" /></p>
</div>
</div>
<div id="frequency-model-poisson" class="section level2">
<h2>Frequency Model (Poisson)</h2>
<p>After getting more insights on the arguments relative to our
insurance portfolio, we will start to fit GLM’s models and see which one
is the most optimal, based on the variables explored before. Here we
investigate models based on the frequency, defined by the argument
<em>NCLAIMS</em> in our data set. We will start our development with the
hypothesis that the frequency follows a Poisson distribution, the same
way as it is usually assumed.</p>
<p>To help us determine which model is the most optimal, we separate the
data set into a training and a test set with the help of the function
<em>createDataPartition</em> from the <strong>caret</strong> package.
The p argument defines the percentage of data in the training set. The
idea will be to fit the model based on the values of the training set
and compare the fitted, as well as the predicted values with respect to
the test set to evaluate if models capture appropriately the underlying
features of the variables.</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">21</span>)  <span class="co"># For reproducibility</span></span>
<span id="cb90-2"><a href="#cb90-2" tabindex="-1"></a>in_training <span class="ot">=</span> <span class="fu">createDataPartition</span>(mtpl_be<span class="sc">$</span>NCLAIMS, <span class="at">times =</span> <span class="dv">1</span>, <span class="at">p =</span> <span class="fl">0.8</span>, <span class="at">list =</span> <span class="cn">FALSE</span>)</span>
<span id="cb90-3"><a href="#cb90-3" tabindex="-1"></a>training_set <span class="ot">=</span> mtpl_be[in_training, ]</span>
<span id="cb90-4"><a href="#cb90-4" tabindex="-1"></a>testing_set <span class="ot">=</span> mtpl_be[<span class="sc">-</span>in_training, ]</span></code></pre></div>
<p>Now, we run the <em>glm</em> function on our training set with
respect to the number of claims (<em>NCLAIMS</em>). As offset, we use
the log_link function of the exposure. Our initial model <em>m0</em>
includes only the intercept, knowingly the log(exposure).</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" tabindex="-1"></a>m0 <span class="ot">&lt;-</span> <span class="fu">glm</span>(NCLAIMS <span class="sc">~</span> <span class="fu">offset</span>(<span class="fu">log</span>(EXP)), <span class="at">data =</span> training_set, <span class="at">family =</span> <span class="fu">poisson</span>())</span>
<span id="cb91-2"><a href="#cb91-2" tabindex="-1"></a><span class="fu">summary</span>(m0)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = NCLAIMS ~ offset(log(EXP)), family = poisson(), 
##     data = training_set)
## 
## Coefficients:
##              Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) -1.967969   0.007851  -250.7   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for poisson family taken to be 1)
## 
##     Null deviance: 71970  on 130584  degrees of freedom
## Residual deviance: 71970  on 130584  degrees of freedom
## AIC: 102284
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<p>We can understand a glm model with only the exponential of the
intercept <span class="math inline">\(\exp\beta_0\)</span> as the
average claim frequency such that: <span class="math inline">\(\exp\beta_0\)</span> = <span class="math inline">\(\displaystyle\frac{\sum_i NCLAIMS_i}{\sum_i
Exposure_i}\)</span>. This may be verified with the following
computation:</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">exp</span>(m0<span class="sc">$</span>coef[<span class="dv">1</span>]), <span class="co"># m0$coef[1] is the Intercept</span></span>
<span id="cb93-2"><a href="#cb93-2" tabindex="-1"></a>     <span class="fu">with</span>(training_set, <span class="fu">sum</span>(NCLAIMS) <span class="sc">/</span> <span class="fu">sum</span>(EXP)))</span>
<span id="cb93-3"><a href="#cb93-3" tabindex="-1"></a><span class="fu">log</span>(a[[<span class="dv">1</span>]])</span></code></pre></div>
<pre><code>## (Intercept) 
##   -1.967969</code></pre>
<p>To enhance our initial model, we will consider the additional
discrete variables and binned continuous variables we explored in the
previous sections, but we include the variables without interaction.
Since GLMs are not well equipped to manage continuous random variables,
we will exclude from the model the longitude and latitude spatial
variables. But we will still consider the other discretized continuous
variables. We thus define the full model in <em>m1</em>.</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">glm</span>(NCLAIMS <span class="sc">~</span> <span class="fu">offset</span>(<span class="fu">log</span>(EXP))<span class="sc">+</span> COVERAGE <span class="sc">+</span> FUEL <span class="sc">+</span> SEX <span class="sc">+</span> USE <span class="sc">+</span> FLEET<span class="sc">+</span></span>
<span id="cb95-2"><a href="#cb95-2" tabindex="-1"></a>            AGEPH_fac <span class="sc">+</span> AGEC_fac <span class="sc">+</span> POWER_fac <span class="sc">+</span> BM_fac, <span class="at">data =</span></span>
<span id="cb95-3"><a href="#cb95-3" tabindex="-1"></a>            training_set, <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link=</span>log))</span>
<span id="cb95-4"><a href="#cb95-4" tabindex="-1"></a><span class="fu">summary</span>(m1)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = NCLAIMS ~ offset(log(EXP)) + COVERAGE + FUEL + 
##     SEX + USE + FLEET + AGEPH_fac + AGEC_fac + POWER_fac + BM_fac, 
##     family = poisson(link = log), data = training_set)
## 
## Coefficients:
##                      Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)          -2.20325    0.03371 -65.349  &lt; 2e-16 ***
## COVERAGEPO           -0.06361    0.01927  -3.300 0.000966 ***
## COVERAGEFO           -0.02544    0.02694  -0.944 0.345029    
## FUELgasoline         -0.17556    0.01754 -10.012  &lt; 2e-16 ***
## SEXfemale             0.04212    0.01818   2.317 0.020502 *  
## USEwork              -0.06347    0.03748  -1.693 0.090407 .  
## FLEETY               -0.14939    0.04890  -3.055 0.002250 ** 
## AGEPH_fac(43.7,56.5] -0.02040    0.02100  -0.972 0.331276    
## AGEPH_fac(56.5,69.3] -0.22213    0.02570  -8.643  &lt; 2e-16 ***
## AGEPH_fac(17.9,30.8]  0.17495    0.02318   7.548 4.42e-14 ***
## AGEPH_fac(69.3,82.2] -0.24507    0.03614  -6.782 1.19e-11 ***
## AGEPH_fac(82.2,95.1]  0.08944    0.11179   0.800 0.423705    
## AGEC_fac(5,9]         0.04075    0.02029   2.008 0.044645 *  
## AGEC_fac(9,48]        0.05897    0.02256   2.613 0.008969 ** 
## POWER_fac(40,48]      0.09337    0.02557   3.652 0.000260 ***
## POWER_fac(48,55]      0.09556    0.02459   3.886 0.000102 ***
## POWER_fac(55,66]      0.10515    0.02645   3.976 7.01e-05 ***
## POWER_fac(66,243]     0.20880    0.02588   8.068 7.16e-16 ***
## BM_fac(0,5]           0.22062    0.02021  10.918  &lt; 2e-16 ***
## BM_fac(5,11]          0.59287    0.02294  25.841  &lt; 2e-16 ***
## BM_fac(11,22]         0.82210    0.03941  20.861  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for poisson family taken to be 1)
## 
##     Null deviance: 71970  on 130584  degrees of freedom
## Residual deviance: 69938  on 130564  degrees of freedom
## AIC: 100292
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<p>By having a glance at the output from our full model, we observe how
important it was to rightfully set the appropriate reference level in
the data processing section. Indeed, we see that there is no coefficient
relative to each of the reference level, since they are accounted for in
the intercept.</p>
<p>We now compare our full model (<em>m1</em>) with our initial model
(<em>m0</em>) with respect to a likelihood ratio test with the
<em>anova</em> function. Additionally, we will rely on the AIC and BIC
scores to assess if a model is best or not by trying to minimize those
values.</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" tabindex="-1"></a><span class="fu">anova</span>(m0 , m1 , <span class="at">test=</span><span class="st">&quot;Chisq&quot;</span>)</span></code></pre></div>
<pre><code>## Analysis of Deviance Table
## 
## Model 1: NCLAIMS ~ offset(log(EXP))
## Model 2: NCLAIMS ~ offset(log(EXP)) + COVERAGE + FUEL + SEX + USE + FLEET + 
##     AGEPH_fac + AGEC_fac + POWER_fac + BM_fac
##   Resid. Df Resid. Dev Df Deviance  Pr(&gt;Chi)    
## 1    130584      71970                          
## 2    130564      69938 20   2032.3 &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" tabindex="-1"></a><span class="fu">AIC</span>(m1); <span class="fu">BIC</span>(m1)</span></code></pre></div>
<pre><code>## [1] 100291.9</code></pre>
<pre><code>## [1] 100497.3</code></pre>
<p>The anova test returns a p-value lower than the commonly used 5%
threshold, meaning that we reject the simplified model (here
<em>m0</em>), since we lose to much explicability by doing so. For
future use and understanding, note that important metrics are the Null
and Residual deviance: <span class="math inline">\(Null Deviance =
2(LL(Saturated Model) - LL(Null Model)) with df = df_Sat -
df_Null\)</span> and, <span class="math inline">\(Residual Deviance =
2(LL(Saturated Model) - LL(Proposed Model)) with df = df_Sat -
df_Proposed\)</span>, where LL stands for log-likelihood and df for
degree of freedom.</p>
<div id="prediction-of-claim-frequencies" class="section level3">
<h3>Prediction of claim frequencies</h3>
<p>We may even go one step further, if we wish to predict future claim
frequencies, we use the <em>predict</em> function with “response” type.
For example, we have computed the first 4 lines of the test set.</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" tabindex="-1"></a><span class="fu">predict</span>(m1, <span class="fu">head</span>(testing_set, <span class="dv">4</span>), <span class="at">type=</span><span class="st">&quot;response&quot;</span>)</span></code></pre></div>
<pre><code>##          8          9         14         15 
## 0.06567246 0.08913719 0.20880445 0.05531568</code></pre>
<p>Now we have designed a new model <em>m2</em>, sometimes called a
“Poisson rate model”, where we basically divide the amount of claims
predicted by the exposure, which gives the claim frequency and if
summed, the average claim frequency.</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" tabindex="-1"></a>m2 <span class="ot">=</span> <span class="fu">suppressWarnings</span>(<span class="fu">glm</span>(NCLAIMS<span class="sc">/</span>EXP <span class="sc">~</span> COVERAGE <span class="sc">+</span> FUEL <span class="sc">+</span> SEX <span class="sc">+</span> USE<span class="sc">+</span></span>
<span id="cb104-2"><a href="#cb104-2" tabindex="-1"></a>                            FLEET<span class="sc">+</span> AGEPH_fac <span class="sc">+</span> AGEC_fac <span class="sc">+</span> POWER_fac <span class="sc">+</span></span>
<span id="cb104-3"><a href="#cb104-3" tabindex="-1"></a>                            BM_fac,</span>
<span id="cb104-4"><a href="#cb104-4" tabindex="-1"></a>         <span class="at">data =</span> training_set,</span>
<span id="cb104-5"><a href="#cb104-5" tabindex="-1"></a>         <span class="at">weight =</span> training_set<span class="sc">$</span>EXP,</span>
<span id="cb104-6"><a href="#cb104-6" tabindex="-1"></a>         <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> log)))</span>
<span id="cb104-7"><a href="#cb104-7" tabindex="-1"></a><span class="fu">summary</span>(m2)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = NCLAIMS/EXP ~ COVERAGE + FUEL + SEX + USE + FLEET + 
##     AGEPH_fac + AGEC_fac + POWER_fac + BM_fac, family = poisson(link = log), 
##     data = training_set, weights = training_set$EXP)
## 
## Coefficients:
##                      Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)          -2.20325    0.03371 -65.349  &lt; 2e-16 ***
## COVERAGEPO           -0.06361    0.01927  -3.300 0.000966 ***
## COVERAGEFO           -0.02544    0.02694  -0.944 0.345029    
## FUELgasoline         -0.17556    0.01754 -10.012  &lt; 2e-16 ***
## SEXfemale             0.04212    0.01818   2.317 0.020502 *  
## USEwork              -0.06347    0.03748  -1.693 0.090407 .  
## FLEETY               -0.14939    0.04890  -3.055 0.002250 ** 
## AGEPH_fac(43.7,56.5] -0.02040    0.02100  -0.972 0.331276    
## AGEPH_fac(56.5,69.3] -0.22213    0.02570  -8.643  &lt; 2e-16 ***
## AGEPH_fac(17.9,30.8]  0.17495    0.02318   7.548 4.42e-14 ***
## AGEPH_fac(69.3,82.2] -0.24507    0.03614  -6.782 1.19e-11 ***
## AGEPH_fac(82.2,95.1]  0.08944    0.11179   0.800 0.423705    
## AGEC_fac(5,9]         0.04075    0.02029   2.008 0.044645 *  
## AGEC_fac(9,48]        0.05897    0.02256   2.613 0.008969 ** 
## POWER_fac(40,48]      0.09337    0.02557   3.652 0.000260 ***
## POWER_fac(48,55]      0.09556    0.02459   3.886 0.000102 ***
## POWER_fac(55,66]      0.10515    0.02645   3.976 7.01e-05 ***
## POWER_fac(66,243]     0.20880    0.02588   8.068 7.16e-16 ***
## BM_fac(0,5]           0.22062    0.02021  10.918  &lt; 2e-16 ***
## BM_fac(5,11]          0.59287    0.02294  25.841  &lt; 2e-16 ***
## BM_fac(11,22]         0.82210    0.03941  20.861  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for poisson family taken to be 1)
## 
##     Null deviance: 71970  on 130584  degrees of freedom
## Residual deviance: 69938  on 130564  degrees of freedom
## AIC: Inf
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<p>We compare the coefficients from <em>m1</em> and <em>m2</em> and they
are the same. But the difference relies in the different loss functions
and how we will treat the y values. It is fair to say that in
<em>m1</em> Y follows a Poisson distribution but it is not if we state
that Y divided by the offset also follow a Poisson distribution. By
adjusting the m2 model by adding some weights relative to the
exposition, we obtain equivalent coefficients.</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" tabindex="-1"></a><span class="fu">cbind</span>(m1<span class="sc">$</span>coefficients,m2<span class="sc">$</span>coefficients)</span></code></pre></div>
<pre><code>##                             [,1]        [,2]
## (Intercept)          -2.20325141 -2.20325141
## COVERAGEPO           -0.06360610 -0.06360610
## COVERAGEFO           -0.02544064 -0.02544064
## FUELgasoline         -0.17556409 -0.17556409
## SEXfemale             0.04212042  0.04212042
## USEwork              -0.06346986 -0.06346986
## FLEETY               -0.14939434 -0.14939434
## AGEPH_fac(43.7,56.5] -0.02040118 -0.02040118
## AGEPH_fac(56.5,69.3] -0.22212514 -0.22212514
## AGEPH_fac(17.9,30.8]  0.17494813  0.17494813
## AGEPH_fac(69.3,82.2] -0.24506852 -0.24506852
## AGEPH_fac(82.2,95.1]  0.08943582  0.08943582
## AGEC_fac(5,9]         0.04075015  0.04075015
## AGEC_fac(9,48]        0.05896709  0.05896709
## POWER_fac(40,48]      0.09337285  0.09337285
## POWER_fac(48,55]      0.09555731  0.09555731
## POWER_fac(55,66]      0.10514614  0.10514614
## POWER_fac(66,243]     0.20880268  0.20880268
## BM_fac(0,5]           0.22061964  0.22061964
## BM_fac(5,11]          0.59286937  0.59286937
## BM_fac(11,22]         0.82209797  0.82209797</code></pre>
<p>Unfortunately, the basic glm implementation is consistent, but there
might be some issue since we prepare the data before splitting in a
training and testing set. Therefore, when we split, we might have shared
information from the training set into the test set before applying the
model. This introduces our next section regarding <em>recipe</em>
function for glm definition and data processing, which we will use for a
more reliable development.</p>
</div>
<div id="recipe" class="section level3">
<h3>Recipe</h3>
<p>Instead of using the <em>glm</em> function directly, we can use the
<em>recipe</em> function instead which aims to make the use of glm
simpler, without having to compute the data processing ahead. It also
helps to preprocess the data before training our model. We first
partition our data into a training and testing set.</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">21</span>)</span>
<span id="cb108-2"><a href="#cb108-2" tabindex="-1"></a>in_training <span class="ot">=</span> <span class="fu">createDataPartition</span>(mtpl_be<span class="sc">$</span>NCLAIMS, <span class="at">times =</span> <span class="dv">1</span>, <span class="at">p =</span> <span class="fl">0.8</span>, <span class="at">list =</span> <span class="cn">FALSE</span>)</span>
<span id="cb108-3"><a href="#cb108-3" tabindex="-1"></a>training_set <span class="ot">=</span> mtpl_be[in_training, ]</span>
<span id="cb108-4"><a href="#cb108-4" tabindex="-1"></a>testing_set <span class="ot">=</span> mtpl_be[<span class="sc">-</span>in_training, ]</span></code></pre></div>
<p>The recipe function will itself be included in a <em>workflow</em>
function, which basically defines how the recipe must be handled,
alongside with a definition of the model. In the end we fit our workflow
with the training set. The first iteration we will make is the standard
model with all the variables as argument. We normally do not need to
preprocess the data beforehand since it can be done directly within the
<em>recipe</em> function. But here, we want to test our hypothesis
regarding the bins of the continuous variable so we will just do the
bins using <em>step_discretize</em> function. Unfortunately, we cannot
decide where to make the breaks so we will just specify the same amount
of breaks we used ourselves. If data were not preprocessed, we would
have had to relevel the discrete variables as well, but here we do
not.</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" tabindex="-1"></a>rec_0 <span class="ot">&lt;-</span> <span class="fu">recipe</span>(NCLAIMS <span class="sc">~</span> EXP <span class="sc">+</span> COVERAGE <span class="sc">+</span> FUEL <span class="sc">+</span> SEX <span class="sc">+</span> USE<span class="sc">+</span></span>
<span id="cb109-2"><a href="#cb109-2" tabindex="-1"></a>                            FLEET<span class="sc">+</span> AGEPH <span class="sc">+</span> AGEC <span class="sc">+</span> POWER <span class="sc">+</span></span>
<span id="cb109-3"><a href="#cb109-3" tabindex="-1"></a>                            BM, <span class="at">data =</span> training_set) <span class="sc">%&gt;%</span></span>
<span id="cb109-4"><a href="#cb109-4" tabindex="-1"></a>    <span class="fu">step_discretize</span>(AGEPH, <span class="at">num_breaks =</span> <span class="dv">6</span>, <span class="at">min_unique =</span> <span class="dv">2</span> ) <span class="sc">%&gt;%</span></span>
<span id="cb109-5"><a href="#cb109-5" tabindex="-1"></a>    <span class="fu">step_discretize</span>(AGEC, <span class="at">num_breaks =</span> <span class="dv">3</span>, <span class="at">min_unique =</span> <span class="dv">2</span> ) <span class="sc">%&gt;%</span></span>
<span id="cb109-6"><a href="#cb109-6" tabindex="-1"></a>    <span class="fu">step_discretize</span>(POWER, <span class="at">num_breaks =</span> <span class="dv">5</span>, <span class="at">min_unique =</span> <span class="dv">2</span> ) <span class="sc">%&gt;%</span></span>
<span id="cb109-7"><a href="#cb109-7" tabindex="-1"></a>    <span class="fu">step_discretize</span>(BM, <span class="at">num_breaks =</span> <span class="dv">4</span>, <span class="at">min_unique =</span> <span class="dv">2</span> ) </span>
<span id="cb109-8"><a href="#cb109-8" tabindex="-1"></a>    </span>
<span id="cb109-9"><a href="#cb109-9" tabindex="-1"></a><span class="co"># Modèle Poisson pour fréquence</span></span>
<span id="cb109-10"><a href="#cb109-10" tabindex="-1"></a>m0_mod <span class="ot">&lt;-</span> <span class="fu">poisson_reg</span>() <span class="sc">%&gt;%</span></span>
<span id="cb109-11"><a href="#cb109-11" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">&quot;glm&quot;</span>)</span>
<span id="cb109-12"><a href="#cb109-12" tabindex="-1"></a></span>
<span id="cb109-13"><a href="#cb109-13" tabindex="-1"></a><span class="co"># Workflow avec offset dans la formule</span></span>
<span id="cb109-14"><a href="#cb109-14" tabindex="-1"></a>m0_wflow <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">%&gt;%</span></span>
<span id="cb109-15"><a href="#cb109-15" tabindex="-1"></a>  <span class="fu">add_model</span>(m0_mod, <span class="at">formula =</span> NCLAIMS <span class="sc">~</span> <span class="fu">offset</span>(<span class="fu">log</span>(EXP)) <span class="sc">+</span> . <span class="sc">-</span> EXP) <span class="sc">%&gt;%</span> </span>
<span id="cb109-16"><a href="#cb109-16" tabindex="-1"></a>  <span class="fu">add_recipe</span>(rec_0)</span>
<span id="cb109-17"><a href="#cb109-17" tabindex="-1"></a></span>
<span id="cb109-18"><a href="#cb109-18" tabindex="-1"></a><span class="co"># Fit</span></span>
<span id="cb109-19"><a href="#cb109-19" tabindex="-1"></a>freq_fit <span class="ot">&lt;-</span> <span class="fu">fit</span>(m0_wflow, <span class="at">data =</span> training_set)</span>
<span id="cb109-20"><a href="#cb109-20" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">extract_fit_engine</span>(freq_fit))</span></code></pre></div>
<pre><code>## 
## Call:
## stats::glm(formula = NCLAIMS ~ offset(log(EXP)) + . - EXP, family = stats::poisson, 
##     data = data)
## 
## Coefficients:
##              Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)  -2.01710    0.03521 -57.290  &lt; 2e-16 ***
## COVERAGEPO   -0.06178    0.01928  -3.205 0.001350 ** 
## COVERAGEFO   -0.02546    0.02695  -0.945 0.344730    
## FUELgasoline -0.17737    0.01753 -10.116  &lt; 2e-16 ***
## SEXfemale     0.03719    0.01818   2.046 0.040799 *  
## USEwork      -0.05242    0.03732  -1.405 0.160159    
## FLEETY       -0.14370    0.04889  -2.939 0.003288 ** 
## AGEPHbin2    -0.14816    0.02503  -5.919 3.23e-09 ***
## AGEPHbin3    -0.11146    0.02659  -4.192 2.77e-05 ***
## AGEPHbin4    -0.19677    0.02780  -7.078 1.46e-12 ***
## AGEPHbin5    -0.29810    0.02875 -10.368  &lt; 2e-16 ***
## AGEPHbin6    -0.37009    0.03114 -11.885  &lt; 2e-16 ***
## AGECbin2      0.03990    0.02029   1.967 0.049232 *  
## AGECbin3      0.05643    0.02257   2.501 0.012388 *  
## POWERbin2     0.09579    0.02557   3.747 0.000179 ***
## POWERbin3     0.09633    0.02459   3.917 8.95e-05 ***
## POWERbin4     0.10487    0.02644   3.965 7.32e-05 ***
## POWERbin5     0.20993    0.02588   8.113 4.93e-16 ***
## BMbin2        0.25665    0.02040  12.581  &lt; 2e-16 ***
## BMbin3        0.62158    0.02112  29.430  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for poisson family taken to be 1)
## 
##     Null deviance: 71970  on 130584  degrees of freedom
## Residual deviance: 69947  on 130565  degrees of freedom
## AIC: 100299
## 
## Number of Fisher Scoring iterations: 6</code></pre>
</div>
<div id="cross-validation" class="section level3">
<h3>Cross validation</h3>
<p>Now we are looking of different factors of cross-validation by aiming
for the smallest mean value and naturally, the lowest standard
deviation. It helps us find what are the features to keep and how to bin
variables. Moreover, we retrieve the BIC value, as it it one of the most
important indicator for feature selection since it penalizes model with
respect to the amount of variables.</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" tabindex="-1"></a>folds <span class="ot">=</span> training_set <span class="sc">%&gt;%</span> <span class="fu">vfold_cv</span>(<span class="at">strata =</span> NCLAIMS, <span class="at">v =</span> <span class="dv">5</span>)</span>
<span id="cb111-2"><a href="#cb111-2" tabindex="-1"></a>res <span class="ot">=</span> <span class="fu">fit_resamples</span>(m0_wflow,</span>
<span id="cb111-3"><a href="#cb111-3" tabindex="-1"></a>                    <span class="at">resamples =</span> folds,</span>
<span id="cb111-4"><a href="#cb111-4" tabindex="-1"></a>                    <span class="at">metrics =</span> <span class="fu">metric_set</span>(poisson_log_loss))</span>
<span id="cb111-5"><a href="#cb111-5" tabindex="-1"></a><span class="fu">collect_metrics</span>(res) <span class="sc">%&gt;%</span></span>
<span id="cb111-6"><a href="#cb111-6" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb111-7"><a href="#cb111-7" tabindex="-1"></a>    <span class="at">mean =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%.6f&quot;</span>, mean),</span>
<span id="cb111-8"><a href="#cb111-8" tabindex="-1"></a>    <span class="at">std_err =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%.6f&quot;</span>, std_err)</span>
<span id="cb111-9"><a href="#cb111-9" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## # A tibble: 1 × 6
##   .metric          .estimator mean         n std_err  .config        
##   &lt;chr&gt;            &lt;chr&gt;      &lt;chr&gt;    &lt;int&gt; &lt;chr&gt;    &lt;chr&gt;          
## 1 poisson_log_loss standard   0.384063     5 0.002560 pre0_mod0_post0</code></pre>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" tabindex="-1"></a><span class="fu">BIC</span>(<span class="fu">extract_fit_engine</span>(freq_fit))</span></code></pre></div>
<pre><code>## [1] 100495</code></pre>
<p>Let’s recall that regarding this project, we will use <em>BIC</em>
and <em>AIC</em> to assess the in-sample quality of our model. Besides,
we will run a <em>cross validation</em> test to assess the out-of-sample
performance. Note that for these tests, we always try to minimize their
value in the aim of the most optimal model. Finally, the <em>anova</em>
test helps us decide if a simplified model is preferable over a more
complex one as well. The <em>rec0</em> model will thus serve as
reference model, mainly for the anova test.</p>
<p>We wanted to further test our model to see the efficiency and
usefulness of the continuous variable in the model by computing a recipe
with only the categorical variables. The results from our comparison
test will be summarized in a data frame at the end of this section, but
we can already observe that this simplified model is not optimal, mainly
due to the score of the anova test (&lt;0.05). Thus we will stick with
model <em>rec0</em></p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" tabindex="-1"></a>m1_mod <span class="ot">=</span> <span class="fu">poisson_reg</span>() <span class="sc">%&gt;%</span></span>
<span id="cb115-2"><a href="#cb115-2" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">&quot;glm&quot;</span>)</span>
<span id="cb115-3"><a href="#cb115-3" tabindex="-1"></a></span>
<span id="cb115-4"><a href="#cb115-4" tabindex="-1"></a>rec_1 <span class="ot">&lt;-</span> <span class="fu">recipe</span>(NCLAIMS <span class="sc">~</span> EXP <span class="sc">+</span> COVERAGE <span class="sc">+</span> FUEL <span class="sc">+</span> SEX <span class="sc">+</span> USE<span class="sc">+</span></span>
<span id="cb115-5"><a href="#cb115-5" tabindex="-1"></a>                            FLEET, <span class="at">data =</span> training_set) </span>
<span id="cb115-6"><a href="#cb115-6" tabindex="-1"></a>    </span>
<span id="cb115-7"><a href="#cb115-7" tabindex="-1"></a>   </span>
<span id="cb115-8"><a href="#cb115-8" tabindex="-1"></a>m1_wflow <span class="ot">&lt;-</span> </span>
<span id="cb115-9"><a href="#cb115-9" tabindex="-1"></a>  <span class="fu">workflow</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb115-10"><a href="#cb115-10" tabindex="-1"></a>  <span class="fu">add_recipe</span>(rec_1) <span class="sc">%&gt;%</span></span>
<span id="cb115-11"><a href="#cb115-11" tabindex="-1"></a>  <span class="fu">add_model</span>(m1_mod, <span class="at">formula =</span> NCLAIMS <span class="sc">~</span> <span class="fu">offset</span>(<span class="fu">log</span>(EXP))<span class="sc">+</span> . <span class="sc">-</span> EXP) <span class="co"># Formula of the model</span></span>
<span id="cb115-12"><a href="#cb115-12" tabindex="-1"></a>  </span>
<span id="cb115-13"><a href="#cb115-13" tabindex="-1"></a>m1_wflow</span></code></pre></div>
<pre><code>## ══ Workflow ════════════════════════════════════════════════════════════════════
## Preprocessor: Recipe
## Model: poisson_reg()
## 
## ── Preprocessor ────────────────────────────────────────────────────────────────
## 0 Recipe Steps
## 
## ── Model ───────────────────────────────────────────────────────────────────────
## Poisson Regression Model Specification (regression)
## 
## Computational engine: glm</code></pre>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" tabindex="-1"></a>m1_fit <span class="ot">&lt;-</span> <span class="fu">fit</span>(m1_wflow, <span class="at">data =</span> training_set)</span>
<span id="cb117-2"><a href="#cb117-2" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">extract_fit_engine</span>(m1_fit))</span></code></pre></div>
<pre><code>## 
## Call:
## stats::glm(formula = NCLAIMS ~ offset(log(EXP)) + . - EXP, family = stats::poisson, 
##     data = data)
## 
## Coefficients:
##               Estimate Std. Error  z value Pr(&gt;|z|)    
## (Intercept)  -1.804631   0.015701 -114.940  &lt; 2e-16 ***
## COVERAGEPO   -0.130175   0.018374   -7.085 1.39e-12 ***
## COVERAGEFO   -0.078542   0.023985   -3.275  0.00106 ** 
## FUELgasoline -0.214653   0.016656  -12.888  &lt; 2e-16 ***
## SEXfemale     0.127637   0.017557    7.270 3.59e-13 ***
## USEwork      -0.006596   0.036979   -0.178  0.85842    
## FLEETY       -0.231136   0.048774   -4.739 2.15e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for poisson family taken to be 1)
## 
##     Null deviance: 71970  on 130584  degrees of freedom
## Residual deviance: 71695  on 130578  degrees of freedom
## AIC: 102021
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" tabindex="-1"></a><span class="fu">BIC</span>(<span class="fu">extract_fit_engine</span>(m1_fit))</span></code></pre></div>
<pre><code>## [1] 102089</code></pre>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" tabindex="-1"></a><span class="fu">anova</span>(<span class="fu">extract_fit_engine</span>(freq_fit), <span class="fu">extract_fit_engine</span>(m1_fit), <span class="at">test=</span><span class="st">&quot;Chisq&quot;</span>)</span></code></pre></div>
<pre><code>## Analysis of Deviance Table
## 
## Model 1: NCLAIMS ~ offset(log(EXP)) + (EXP + COVERAGE + FUEL + SEX + USE + 
##     FLEET + AGEPH + AGEC + POWER + BM) - EXP
## Model 2: NCLAIMS ~ offset(log(EXP)) + (EXP + COVERAGE + FUEL + SEX + USE + 
##     FLEET) - EXP
##   Resid. Df Resid. Dev  Df Deviance  Pr(&gt;Chi)    
## 1    130565      69947                           
## 2    130578      71695 -13  -1747.1 &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" tabindex="-1"></a><span class="co">#max(abs(predict(m1_fit, testing_set) - predict(m1_bis, testing_set, type=&quot;response&quot;)))</span></span>
<span id="cb123-2"><a href="#cb123-2" tabindex="-1"></a></span>
<span id="cb123-3"><a href="#cb123-3" tabindex="-1"></a>res <span class="ot">=</span> <span class="fu">fit_resamples</span>(m1_wflow,</span>
<span id="cb123-4"><a href="#cb123-4" tabindex="-1"></a>                    <span class="at">resamples =</span> folds,</span>
<span id="cb123-5"><a href="#cb123-5" tabindex="-1"></a>                    <span class="at">metrics =</span> <span class="fu">metric_set</span>(poisson_log_loss))</span>
<span id="cb123-6"><a href="#cb123-6" tabindex="-1"></a><span class="fu">collect_metrics</span>(res) <span class="sc">%&gt;%</span></span>
<span id="cb123-7"><a href="#cb123-7" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb123-8"><a href="#cb123-8" tabindex="-1"></a>    <span class="at">mean =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%.6f&quot;</span>, mean),</span>
<span id="cb123-9"><a href="#cb123-9" tabindex="-1"></a>    <span class="at">std_err =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%.6f&quot;</span>, std_err)</span>
<span id="cb123-10"><a href="#cb123-10" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## # A tibble: 1 × 6
##   .metric          .estimator mean         n std_err  .config        
##   &lt;chr&gt;            &lt;chr&gt;      &lt;chr&gt;    &lt;int&gt; &lt;chr&gt;    &lt;chr&gt;          
## 1 poisson_log_loss standard   0.390628     5 0.002648 pre0_mod0_post0</code></pre>
<p>Now we do the same by including our continuous variables that we
pre-processed ourselves in the previous section, which gives us the
following output. Here we test whether the discretization method
included in recipe to bin continuous variable is more or less effective
than the manual bins we have computed. An anova test is not relevant
since we have the same amount of variables, but we clearly observe that
our binning techniques provides better scores in terms of AIC,
Cross-validation and lowest residual deviance. As of now, we will used
the <em>rec_2</em> model as reference for comparison.</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" tabindex="-1"></a>m2_mod <span class="ot">=</span> <span class="fu">poisson_reg</span>() <span class="sc">%&gt;%</span></span>
<span id="cb125-2"><a href="#cb125-2" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">&quot;glm&quot;</span>)</span>
<span id="cb125-3"><a href="#cb125-3" tabindex="-1"></a></span>
<span id="cb125-4"><a href="#cb125-4" tabindex="-1"></a>rec_2 <span class="ot">&lt;-</span> <span class="fu">recipe</span>(NCLAIMS <span class="sc">~</span> EXP <span class="sc">+</span> COVERAGE <span class="sc">+</span> FUEL <span class="sc">+</span> SEX <span class="sc">+</span> USE<span class="sc">+</span></span>
<span id="cb125-5"><a href="#cb125-5" tabindex="-1"></a>                            FLEET<span class="sc">+</span> AGEPH_fac <span class="sc">+</span> AGEC_fac <span class="sc">+</span> POWER_fac <span class="sc">+</span></span>
<span id="cb125-6"><a href="#cb125-6" tabindex="-1"></a>                            BM_fac , <span class="at">data =</span> training_set)</span>
<span id="cb125-7"><a href="#cb125-7" tabindex="-1"></a>    </span>
<span id="cb125-8"><a href="#cb125-8" tabindex="-1"></a>m2_wflow <span class="ot">&lt;-</span> </span>
<span id="cb125-9"><a href="#cb125-9" tabindex="-1"></a>  <span class="fu">workflow</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb125-10"><a href="#cb125-10" tabindex="-1"></a>  <span class="fu">add_recipe</span>(rec_2) <span class="sc">%&gt;%</span></span>
<span id="cb125-11"><a href="#cb125-11" tabindex="-1"></a>  <span class="fu">add_model</span>(m2_mod, <span class="at">formula =</span> NCLAIMS <span class="sc">~</span> <span class="fu">offset</span>(<span class="fu">log</span>(EXP))<span class="sc">+</span>. <span class="sc">-</span> EXP ) <span class="co"># Formula of the model</span></span>
<span id="cb125-12"><a href="#cb125-12" tabindex="-1"></a>  </span>
<span id="cb125-13"><a href="#cb125-13" tabindex="-1"></a>m2_wflow</span></code></pre></div>
<pre><code>## ══ Workflow ════════════════════════════════════════════════════════════════════
## Preprocessor: Recipe
## Model: poisson_reg()
## 
## ── Preprocessor ────────────────────────────────────────────────────────────────
## 0 Recipe Steps
## 
## ── Model ───────────────────────────────────────────────────────────────────────
## Poisson Regression Model Specification (regression)
## 
## Computational engine: glm</code></pre>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" tabindex="-1"></a>m2_fit <span class="ot">&lt;-</span> <span class="fu">fit</span>(m2_wflow, <span class="at">data =</span> training_set)</span>
<span id="cb127-2"><a href="#cb127-2" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">extract_fit_engine</span>(m2_fit))</span></code></pre></div>
<pre><code>## 
## Call:
## stats::glm(formula = NCLAIMS ~ offset(log(EXP)) + . - EXP, family = stats::poisson, 
##     data = data)
## 
## Coefficients:
##                      Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)          -2.20325    0.03371 -65.349  &lt; 2e-16 ***
## COVERAGEPO           -0.06361    0.01927  -3.300 0.000966 ***
## COVERAGEFO           -0.02544    0.02694  -0.944 0.345029    
## FUELgasoline         -0.17556    0.01754 -10.012  &lt; 2e-16 ***
## SEXfemale             0.04212    0.01818   2.317 0.020502 *  
## USEwork              -0.06347    0.03748  -1.693 0.090407 .  
## FLEETY               -0.14939    0.04890  -3.055 0.002250 ** 
## AGEPH_fac(43.7,56.5] -0.02040    0.02100  -0.972 0.331276    
## AGEPH_fac(56.5,69.3] -0.22213    0.02570  -8.643  &lt; 2e-16 ***
## AGEPH_fac(17.9,30.8]  0.17495    0.02318   7.548 4.42e-14 ***
## AGEPH_fac(69.3,82.2] -0.24507    0.03614  -6.782 1.19e-11 ***
## AGEPH_fac(82.2,95.1]  0.08944    0.11179   0.800 0.423705    
## AGEC_fac(5,9]         0.04075    0.02029   2.008 0.044645 *  
## AGEC_fac(9,48]        0.05897    0.02256   2.613 0.008969 ** 
## POWER_fac(40,48]      0.09337    0.02557   3.652 0.000260 ***
## POWER_fac(48,55]      0.09556    0.02459   3.886 0.000102 ***
## POWER_fac(55,66]      0.10515    0.02645   3.976 7.01e-05 ***
## POWER_fac(66,243]     0.20880    0.02588   8.068 7.16e-16 ***
## BM_fac(0,5]           0.22062    0.02021  10.918  &lt; 2e-16 ***
## BM_fac(5,11]          0.59287    0.02294  25.841  &lt; 2e-16 ***
## BM_fac(11,22]         0.82210    0.03941  20.861  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for poisson family taken to be 1)
## 
##     Null deviance: 71970  on 130584  degrees of freedom
## Residual deviance: 69938  on 130564  degrees of freedom
## AIC: 100292
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" tabindex="-1"></a><span class="fu">BIC</span>(<span class="fu">extract_fit_engine</span>(m2_fit))</span></code></pre></div>
<pre><code>## [1] 100497.3</code></pre>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" tabindex="-1"></a>res <span class="ot">=</span> <span class="fu">fit_resamples</span>(m2_wflow,</span>
<span id="cb131-2"><a href="#cb131-2" tabindex="-1"></a>                    <span class="at">resamples =</span> folds,</span>
<span id="cb131-3"><a href="#cb131-3" tabindex="-1"></a>                    <span class="at">metrics =</span> <span class="fu">metric_set</span>(poisson_log_loss))</span>
<span id="cb131-4"><a href="#cb131-4" tabindex="-1"></a><span class="fu">collect_metrics</span>(res) <span class="sc">%&gt;%</span></span>
<span id="cb131-5"><a href="#cb131-5" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb131-6"><a href="#cb131-6" tabindex="-1"></a>    <span class="at">mean =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%.6f&quot;</span>, mean),</span>
<span id="cb131-7"><a href="#cb131-7" tabindex="-1"></a>    <span class="at">std_err =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%.6f&quot;</span>, std_err)</span>
<span id="cb131-8"><a href="#cb131-8" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## # A tibble: 1 × 6
##   .metric          .estimator mean         n std_err  .config        
##   &lt;chr&gt;            &lt;chr&gt;      &lt;chr&gt;    &lt;int&gt; &lt;chr&gt;    &lt;chr&gt;          
## 1 poisson_log_loss standard   0.384030     5 0.002502 pre0_mod0_post0</code></pre>
<p>What we can observe from the comparison between <em>rec_0</em> and
<em>rec_2</em> is that the AIC, residual deviance and out-of-sample
performance are better for our binning technique. On the other hand, the
BIC is lower but only by 2 units. Therefore, we decide to go with our
binned variables from the first part of this project and use it as base
model.</p>
</div>
<div id="interaction" class="section level3">
<h3>Interaction</h3>
<p>We may as well include some interaction between the explicative
variables by adding them in the workflow directly. Here we have found
various interaction from which we wanted to investigate the impact on
the model. These interactions are between Fuel and the Power of
vehicles, the age of policyholder’s compare to their bonus-malus level
and finally the interaction between the coverage and the bonus-malus
level.</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" tabindex="-1"></a>rec_3 <span class="ot">&lt;-</span> <span class="fu">recipe</span>(NCLAIMS <span class="sc">~</span> EXP <span class="sc">+</span> COVERAGE <span class="sc">+</span> FUEL <span class="sc">+</span> SEX <span class="sc">+</span> USE<span class="sc">+</span></span>
<span id="cb133-2"><a href="#cb133-2" tabindex="-1"></a>                            FLEET<span class="sc">+</span> AGEPH_fac <span class="sc">+</span> AGEC_fac <span class="sc">+</span> POWER_fac <span class="sc">+</span></span>
<span id="cb133-3"><a href="#cb133-3" tabindex="-1"></a>                            BM_fac , <span class="at">data =</span> training_set)</span>
<span id="cb133-4"><a href="#cb133-4" tabindex="-1"></a>    </span>
<span id="cb133-5"><a href="#cb133-5" tabindex="-1"></a>m3_wflow <span class="ot">&lt;-</span> </span>
<span id="cb133-6"><a href="#cb133-6" tabindex="-1"></a>  <span class="fu">workflow</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb133-7"><a href="#cb133-7" tabindex="-1"></a>  <span class="fu">add_recipe</span>(rec_3) <span class="sc">%&gt;%</span></span>
<span id="cb133-8"><a href="#cb133-8" tabindex="-1"></a>  <span class="fu">add_model</span>(m2_mod, <span class="at">formula =</span> NCLAIMS <span class="sc">~</span> <span class="fu">offset</span>(<span class="fu">log</span>(EXP))</span>
<span id="cb133-9"><a href="#cb133-9" tabindex="-1"></a>              <span class="sc">+</span> FUEL<span class="sc">*</span>POWER_fac <span class="sc">+</span> AGEPH_fac<span class="sc">*</span>BM_fac <span class="sc">+</span> COVERAGE<span class="sc">*</span>BM_fac<span class="sc">+</span> . <span class="sc">-</span> EXP ) <span class="co"># Formula of the model</span></span>
<span id="cb133-10"><a href="#cb133-10" tabindex="-1"></a>  </span>
<span id="cb133-11"><a href="#cb133-11" tabindex="-1"></a>m3_wflow</span></code></pre></div>
<pre><code>## ══ Workflow ════════════════════════════════════════════════════════════════════
## Preprocessor: Recipe
## Model: poisson_reg()
## 
## ── Preprocessor ────────────────────────────────────────────────────────────────
## 0 Recipe Steps
## 
## ── Model ───────────────────────────────────────────────────────────────────────
## Poisson Regression Model Specification (regression)
## 
## Computational engine: glm</code></pre>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" tabindex="-1"></a>m3_fit <span class="ot">&lt;-</span> <span class="fu">fit</span>(m3_wflow, <span class="at">data =</span> training_set)</span>
<span id="cb135-2"><a href="#cb135-2" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">extract_fit_engine</span>(m3_fit))</span></code></pre></div>
<pre><code>## 
## Call:
## stats::glm(formula = NCLAIMS ~ offset(log(EXP)) + FUEL * POWER_fac + 
##     AGEPH_fac * BM_fac + COVERAGE * BM_fac + . - EXP, family = stats::poisson, 
##     data = data)
## 
## Coefficients:
##                                     Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)                        -2.117058   0.049370 -42.881  &lt; 2e-16 ***
## FUELgasoline                       -0.253570   0.039580  -6.406 1.49e-10 ***
## POWER_fac(40,48]                    0.072575   0.043029   1.687 0.091672 .  
## POWER_fac(48,55]                    0.045455   0.042983   1.058 0.290276    
## POWER_fac(55,66]                   -0.040969   0.049527  -0.827 0.408119    
## POWER_fac(66,243]                   0.038968   0.054509   0.715 0.474677    
## AGEPH_fac(43.7,56.5]               -0.108194   0.037366  -2.896 0.003785 ** 
## AGEPH_fac(56.5,69.3]               -0.302131   0.042188  -7.162 7.98e-13 ***
## AGEPH_fac(17.9,30.8]                0.187310   0.096373   1.944 0.051944 .  
## AGEPH_fac(69.3,82.2]               -0.243689   0.053969  -4.515 6.32e-06 ***
## AGEPH_fac(82.2,95.1]               -0.074442   0.179215  -0.415 0.677866    
## BM_fac(0,5]                         0.206353   0.039681   5.200 1.99e-07 ***
## BM_fac(5,11]                        0.539178   0.042015  12.833  &lt; 2e-16 ***
## BM_fac(11,22]                       0.852066   0.075160  11.337  &lt; 2e-16 ***
## COVERAGEPO                          0.007356   0.033993   0.216 0.828668    
## COVERAGEFO                          0.048782   0.044817   1.088 0.276392    
## SEXfemale                           0.043939   0.018200   2.414 0.015768 *  
## USEwork                            -0.048526   0.037573  -1.291 0.196531    
## FLEETY                             -0.151026   0.048923  -3.087 0.002022 ** 
## AGEC_fac(5,9]                       0.028153   0.020391   1.381 0.167386    
## AGEC_fac(9,48]                      0.043933   0.022893   1.919 0.054978 .  
## FUELgasoline:POWER_fac(40,48]      -0.004279   0.053884  -0.079 0.936705    
## FUELgasoline:POWER_fac(48,55]       0.056722   0.052187   1.087 0.277088    
## FUELgasoline:POWER_fac(55,66]       0.200615   0.057008   3.519 0.000433 ***
## FUELgasoline:POWER_fac(66,243]      0.209711   0.060070   3.491 0.000481 ***
## AGEPH_fac(43.7,56.5]:BM_fac(0,5]    0.097156   0.049741   1.953 0.050791 .  
## AGEPH_fac(56.5,69.3]:BM_fac(0,5]    0.046983   0.058430   0.804 0.421343    
## AGEPH_fac(17.9,30.8]:BM_fac(0,5]   -0.041240   0.105206  -0.392 0.695063    
## AGEPH_fac(69.3,82.2]:BM_fac(0,5]   -0.033006   0.078215  -0.422 0.673032    
## AGEPH_fac(82.2,95.1]:BM_fac(0,5]    0.400179   0.238576   1.677 0.093471 .  
## AGEPH_fac(43.7,56.5]:BM_fac(5,11]   0.177296   0.056724   3.126 0.001774 ** 
## AGEPH_fac(56.5,69.3]:BM_fac(5,11]   0.273655   0.071288   3.839 0.000124 ***
## AGEPH_fac(17.9,30.8]:BM_fac(5,11]   0.049400   0.102146   0.484 0.628650    
## AGEPH_fac(69.3,82.2]:BM_fac(5,11]  -0.045701   0.117056  -0.390 0.696225    
## AGEPH_fac(82.2,95.1]:BM_fac(5,11]  -0.009063   0.379300  -0.024 0.980937    
## AGEPH_fac(43.7,56.5]:BM_fac(11,22]  0.134545   0.115200   1.168 0.242835    
## AGEPH_fac(56.5,69.3]:BM_fac(11,22]  0.241731   0.149348   1.619 0.105539    
## AGEPH_fac(17.9,30.8]:BM_fac(11,22] -0.046231   0.126625  -0.365 0.715038    
## AGEPH_fac(69.3,82.2]:BM_fac(11,22]  0.188785   0.238940   0.790 0.429472    
## AGEPH_fac(82.2,95.1]:BM_fac(11,22] -9.422644  57.060209  -0.165 0.868838    
## BM_fac(0,5]:COVERAGEPO             -0.066416   0.045270  -1.467 0.142347    
## BM_fac(5,11]:COVERAGEPO            -0.143092   0.048909  -2.926 0.003437 ** 
## BM_fac(11,22]:COVERAGEPO           -0.162891   0.090658  -1.797 0.072374 .  
## BM_fac(0,5]:COVERAGEFO             -0.052575   0.057985  -0.907 0.364566    
## BM_fac(5,11]:COVERAGEFO            -0.116646   0.062844  -1.856 0.063436 .  
## BM_fac(11,22]:COVERAGEFO           -0.389194   0.130533  -2.982 0.002868 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for poisson family taken to be 1)
## 
##     Null deviance: 71970  on 130584  degrees of freedom
## Residual deviance: 69860  on 130539  degrees of freedom
## AIC: 100264
## 
## Number of Fisher Scoring iterations: 9</code></pre>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" tabindex="-1"></a><span class="fu">BIC</span>(<span class="fu">extract_fit_engine</span>(m3_fit))</span></code></pre></div>
<pre><code>## [1] 100714.1</code></pre>
<p>First, let’s remark that most coefficients that were significative
prior to this new model, are not anymore. Additionnally, the BIC went up
drastically compared to the one from our original model. Let’s perform
the cross validation test to see if there is a significant difference
with our original model, with a better out-of-sample performance.</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" tabindex="-1"></a>folds <span class="ot">=</span> training_set <span class="sc">%&gt;%</span> <span class="fu">vfold_cv</span>(<span class="at">strata =</span> NCLAIMS, <span class="at">v =</span> <span class="dv">5</span>)</span>
<span id="cb139-2"><a href="#cb139-2" tabindex="-1"></a>res <span class="ot">=</span> <span class="fu">fit_resamples</span>(m3_wflow,</span>
<span id="cb139-3"><a href="#cb139-3" tabindex="-1"></a>                    <span class="at">resamples =</span> folds,</span>
<span id="cb139-4"><a href="#cb139-4" tabindex="-1"></a>                    <span class="at">metrics =</span> <span class="fu">metric_set</span>(poisson_log_loss))</span>
<span id="cb139-5"><a href="#cb139-5" tabindex="-1"></a><span class="fu">collect_metrics</span>(res) <span class="sc">%&gt;%</span></span>
<span id="cb139-6"><a href="#cb139-6" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb139-7"><a href="#cb139-7" tabindex="-1"></a>    <span class="at">mean =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%.6f&quot;</span>, mean),</span>
<span id="cb139-8"><a href="#cb139-8" tabindex="-1"></a>    <span class="at">std_err =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%.6f&quot;</span>, std_err)</span>
<span id="cb139-9"><a href="#cb139-9" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## # A tibble: 1 × 6
##   .metric          .estimator mean         n std_err  .config        
##   &lt;chr&gt;            &lt;chr&gt;      &lt;chr&gt;    &lt;int&gt; &lt;chr&gt;    &lt;chr&gt;          
## 1 poisson_log_loss standard   0.383962     5 0.002057 pre0_mod0_post0</code></pre>
<p>The cross validation test also shows poorer results, which is not
really to be taken into account since the standard error is large enough
to largely include the cross validation result from <em>rec_2</em> in a
95% confidence interval. But we cannot define the extended model as
better, especially with the conclusions based on the summary.</p>
<p>To achieve our objective properly by assessing every possible model,
we test another model but where we only keep one interaction, namely
FUEL*POWER.</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" tabindex="-1"></a>rec_4 <span class="ot">&lt;-</span> <span class="fu">recipe</span>(NCLAIMS <span class="sc">~</span> EXP <span class="sc">+</span> COVERAGE <span class="sc">+</span> FUEL <span class="sc">+</span> SEX <span class="sc">+</span> USE<span class="sc">+</span></span>
<span id="cb141-2"><a href="#cb141-2" tabindex="-1"></a>                            FLEET<span class="sc">+</span> AGEPH_fac <span class="sc">+</span> AGEC_fac <span class="sc">+</span> POWER_fac <span class="sc">+</span></span>
<span id="cb141-3"><a href="#cb141-3" tabindex="-1"></a>                            BM_fac , <span class="at">data =</span> training_set) </span>
<span id="cb141-4"><a href="#cb141-4" tabindex="-1"></a>    </span>
<span id="cb141-5"><a href="#cb141-5" tabindex="-1"></a>   </span>
<span id="cb141-6"><a href="#cb141-6" tabindex="-1"></a>m4_wflow <span class="ot">&lt;-</span> </span>
<span id="cb141-7"><a href="#cb141-7" tabindex="-1"></a>  <span class="fu">workflow</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb141-8"><a href="#cb141-8" tabindex="-1"></a>  <span class="fu">add_recipe</span>(rec_4) <span class="sc">%&gt;%</span></span>
<span id="cb141-9"><a href="#cb141-9" tabindex="-1"></a>  <span class="fu">add_model</span>(m2_mod, <span class="at">formula =</span> NCLAIMS <span class="sc">~</span> <span class="fu">offset</span>(<span class="fu">log</span>(EXP)) </span>
<span id="cb141-10"><a href="#cb141-10" tabindex="-1"></a>              <span class="sc">+</span> FUEL<span class="sc">*</span>POWER_fac <span class="sc">+</span> . <span class="sc">-</span> EXP) <span class="co"># Formula of the model</span></span>
<span id="cb141-11"><a href="#cb141-11" tabindex="-1"></a>  </span>
<span id="cb141-12"><a href="#cb141-12" tabindex="-1"></a>m4_wflow</span></code></pre></div>
<pre><code>## ══ Workflow ════════════════════════════════════════════════════════════════════
## Preprocessor: Recipe
## Model: poisson_reg()
## 
## ── Preprocessor ────────────────────────────────────────────────────────────────
## 0 Recipe Steps
## 
## ── Model ───────────────────────────────────────────────────────────────────────
## Poisson Regression Model Specification (regression)
## 
## Computational engine: glm</code></pre>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" tabindex="-1"></a>m4_fit <span class="ot">&lt;-</span> <span class="fu">fit</span>(m4_wflow, <span class="at">data =</span> training_set)</span>
<span id="cb143-2"><a href="#cb143-2" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">extract_fit_engine</span>(m4_fit))</span></code></pre></div>
<pre><code>## 
## Call:
## stats::glm(formula = NCLAIMS ~ offset(log(EXP)) + FUEL * POWER_fac + 
##     . - EXP, family = stats::poisson, data = data)
## 
## Coefficients:
##                                 Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)                    -2.135317   0.044126 -48.392  &lt; 2e-16 ***
## FUELgasoline                   -0.257538   0.039572  -6.508 7.61e-11 ***
## POWER_fac(40,48]                0.071217   0.043018   1.656 0.097820 .  
## POWER_fac(48,55]                0.044563   0.042971   1.037 0.299709    
## POWER_fac(55,66]               -0.041403   0.049509  -0.836 0.403006    
## POWER_fac(66,243]               0.037868   0.054497   0.695 0.487138    
## COVERAGEPO                     -0.065348   0.019276  -3.390 0.000699 ***
## COVERAGEFO                     -0.018557   0.026962  -0.688 0.491273    
## SEXfemale                       0.046164   0.018192   2.538 0.011163 *  
## USEwork                        -0.054638   0.037515  -1.456 0.145273    
## FLEETY                         -0.150844   0.048908  -3.084 0.002041 ** 
## AGEPH_fac(43.7,56.5]           -0.018837   0.021002  -0.897 0.369755    
## AGEPH_fac(56.5,69.3]           -0.219433   0.025717  -8.533  &lt; 2e-16 ***
## AGEPH_fac(17.9,30.8]            0.172861   0.023183   7.456 8.90e-14 ***
## AGEPH_fac(69.3,82.2]           -0.238803   0.036157  -6.605 3.99e-11 ***
## AGEPH_fac(82.2,95.1]            0.100898   0.111813   0.902 0.366855    
## AGEC_fac(5,9]                   0.030688   0.020380   1.506 0.132121    
## AGEC_fac(9,48]                  0.049291   0.022836   2.159 0.030888 *  
## BM_fac(0,5]                     0.220437   0.020208  10.909  &lt; 2e-16 ***
## BM_fac(5,11]                    0.592877   0.022944  25.840  &lt; 2e-16 ***
## BM_fac(11,22]                   0.821319   0.039409  20.841  &lt; 2e-16 ***
## FUELgasoline:POWER_fac(40,48]  -0.004891   0.053874  -0.091 0.927663    
## FUELgasoline:POWER_fac(48,55]   0.057467   0.052176   1.101 0.270713    
## FUELgasoline:POWER_fac(55,66]   0.202203   0.056997   3.548 0.000389 ***
## FUELgasoline:POWER_fac(66,243]  0.213673   0.060061   3.558 0.000374 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for poisson family taken to be 1)
## 
##     Null deviance: 71970  on 130584  degrees of freedom
## Residual deviance: 69910  on 130560  degrees of freedom
## AIC: 100272
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" tabindex="-1"></a><span class="fu">BIC</span>(<span class="fu">extract_fit_engine</span>(m4_fit))</span></code></pre></div>
<pre><code>## [1] 100516.7</code></pre>
<p>Here again, we observe a higher AIC and BIC value, as well as a many
coefficients becoming non significative with the introduction of the
interaction. Moreover, the cross validation results do not show an
outstanding difference. Therefore, we will stick with the initial model
without any interactions.</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" tabindex="-1"></a>folds <span class="ot">=</span> training_set <span class="sc">%&gt;%</span> <span class="fu">vfold_cv</span>(<span class="at">strata =</span> NCLAIMS, <span class="at">v =</span> <span class="dv">5</span>)</span>
<span id="cb147-2"><a href="#cb147-2" tabindex="-1"></a>res <span class="ot">=</span> <span class="fu">fit_resamples</span>(m4_wflow,</span>
<span id="cb147-3"><a href="#cb147-3" tabindex="-1"></a>                    <span class="at">resamples =</span> folds,</span>
<span id="cb147-4"><a href="#cb147-4" tabindex="-1"></a>                    <span class="at">metrics =</span> <span class="fu">metric_set</span>(poisson_log_loss))</span>
<span id="cb147-5"><a href="#cb147-5" tabindex="-1"></a><span class="fu">collect_metrics</span>(res) <span class="sc">%&gt;%</span></span>
<span id="cb147-6"><a href="#cb147-6" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb147-7"><a href="#cb147-7" tabindex="-1"></a>    <span class="at">mean =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%.6f&quot;</span>, mean),</span>
<span id="cb147-8"><a href="#cb147-8" tabindex="-1"></a>    <span class="at">std_err =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%.6f&quot;</span>, std_err)</span>
<span id="cb147-9"><a href="#cb147-9" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## # A tibble: 1 × 6
##   .metric          .estimator mean         n std_err  .config        
##   &lt;chr&gt;            &lt;chr&gt;      &lt;chr&gt;    &lt;int&gt; &lt;chr&gt;    &lt;chr&gt;          
## 1 poisson_log_loss standard   0.383988     5 0.002144 pre0_mod0_post0</code></pre>
</div>
<div id="model-without-interaction" class="section level3">
<h3>Model without interaction</h3>
<p>Let’s remember the model we chose based on our previous
computations:</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">extract_fit_engine</span>(m2_fit))</span></code></pre></div>
<pre><code>## 
## Call:
## stats::glm(formula = NCLAIMS ~ offset(log(EXP)) + . - EXP, family = stats::poisson, 
##     data = data)
## 
## Coefficients:
##                      Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)          -2.20325    0.03371 -65.349  &lt; 2e-16 ***
## COVERAGEPO           -0.06361    0.01927  -3.300 0.000966 ***
## COVERAGEFO           -0.02544    0.02694  -0.944 0.345029    
## FUELgasoline         -0.17556    0.01754 -10.012  &lt; 2e-16 ***
## SEXfemale             0.04212    0.01818   2.317 0.020502 *  
## USEwork              -0.06347    0.03748  -1.693 0.090407 .  
## FLEETY               -0.14939    0.04890  -3.055 0.002250 ** 
## AGEPH_fac(43.7,56.5] -0.02040    0.02100  -0.972 0.331276    
## AGEPH_fac(56.5,69.3] -0.22213    0.02570  -8.643  &lt; 2e-16 ***
## AGEPH_fac(17.9,30.8]  0.17495    0.02318   7.548 4.42e-14 ***
## AGEPH_fac(69.3,82.2] -0.24507    0.03614  -6.782 1.19e-11 ***
## AGEPH_fac(82.2,95.1]  0.08944    0.11179   0.800 0.423705    
## AGEC_fac(5,9]         0.04075    0.02029   2.008 0.044645 *  
## AGEC_fac(9,48]        0.05897    0.02256   2.613 0.008969 ** 
## POWER_fac(40,48]      0.09337    0.02557   3.652 0.000260 ***
## POWER_fac(48,55]      0.09556    0.02459   3.886 0.000102 ***
## POWER_fac(55,66]      0.10515    0.02645   3.976 7.01e-05 ***
## POWER_fac(66,243]     0.20880    0.02588   8.068 7.16e-16 ***
## BM_fac(0,5]           0.22062    0.02021  10.918  &lt; 2e-16 ***
## BM_fac(5,11]          0.59287    0.02294  25.841  &lt; 2e-16 ***
## BM_fac(11,22]         0.82210    0.03941  20.861  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for poisson family taken to be 1)
## 
##     Null deviance: 71970  on 130584  degrees of freedom
## Residual deviance: 69938  on 130564  degrees of freedom
## AIC: 100292
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" tabindex="-1"></a><span class="fu">BIC</span>(<span class="fu">extract_fit_engine</span>(m2_fit))</span></code></pre></div>
<pre><code>## [1] 100497.3</code></pre>
<p>Interactions are one thing, but it is equally important to get rid of
useless variables with no explanatory use. We thus rely on function
<em>step_mutate</em> to merge two intervals appearing to have the same
behavior and remove non-significant variables. Let’s start by merging
together the two factors from COVERAGE since FO is not significant and
that the estimate is close to <em>PO</em>.</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" tabindex="-1"></a>rec_5 <span class="ot">&lt;-</span> <span class="fu">recipe</span>(NCLAIMS <span class="sc">~</span> EXP <span class="sc">+</span> COVERAGE <span class="sc">+</span> FUEL <span class="sc">+</span> SEX <span class="sc">+</span> USE<span class="sc">+</span></span>
<span id="cb153-2"><a href="#cb153-2" tabindex="-1"></a>                            FLEET<span class="sc">+</span> AGEPH_fac <span class="sc">+</span> AGEC_fac <span class="sc">+</span> POWER_fac <span class="sc">+</span></span>
<span id="cb153-3"><a href="#cb153-3" tabindex="-1"></a>                            BM_fac , <span class="at">data =</span> training_set) <span class="sc">%&gt;%</span></span>
<span id="cb153-4"><a href="#cb153-4" tabindex="-1"></a>    <span class="fu">step_mutate</span>(<span class="at">COVERAGE =</span> forcats<span class="sc">::</span><span class="fu">fct_collapse</span>(COVERAGE, <span class="st">&quot;All&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;PO&quot;</span>,<span class="st">&quot;FO&quot;</span>)))</span>
<span id="cb153-5"><a href="#cb153-5" tabindex="-1"></a>   </span>
<span id="cb153-6"><a href="#cb153-6" tabindex="-1"></a></span>
<span id="cb153-7"><a href="#cb153-7" tabindex="-1"></a>m5_wflow <span class="ot">&lt;-</span> </span>
<span id="cb153-8"><a href="#cb153-8" tabindex="-1"></a>  <span class="fu">workflow</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb153-9"><a href="#cb153-9" tabindex="-1"></a>  <span class="fu">add_recipe</span>(rec_5) <span class="sc">%&gt;%</span></span>
<span id="cb153-10"><a href="#cb153-10" tabindex="-1"></a>  <span class="fu">add_model</span>(m2_mod, <span class="at">formula =</span> NCLAIMS <span class="sc">~</span> <span class="fu">offset</span>(<span class="fu">log</span>(EXP)) <span class="sc">+</span> . <span class="sc">-</span> EXP) <span class="co"># Formula of the model</span></span>
<span id="cb153-11"><a href="#cb153-11" tabindex="-1"></a>  </span>
<span id="cb153-12"><a href="#cb153-12" tabindex="-1"></a>m5_wflow</span></code></pre></div>
<pre><code>## ══ Workflow ════════════════════════════════════════════════════════════════════
## Preprocessor: Recipe
## Model: poisson_reg()
## 
## ── Preprocessor ────────────────────────────────────────────────────────────────
## 1 Recipe Step
## 
## • step_mutate()
## 
## ── Model ───────────────────────────────────────────────────────────────────────
## Poisson Regression Model Specification (regression)
## 
## Computational engine: glm</code></pre>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" tabindex="-1"></a>m5_fit <span class="ot">&lt;-</span> <span class="fu">fit</span>(m5_wflow, <span class="at">data =</span> training_set)</span>
<span id="cb155-2"><a href="#cb155-2" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">extract_fit_engine</span>(m5_fit))</span></code></pre></div>
<pre><code>## 
## Call:
## stats::glm(formula = NCLAIMS ~ offset(log(EXP)) + . - EXP, family = stats::poisson, 
##     data = data)
## 
## Coefficients:
##                      Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)          -2.19792    0.03347 -65.661  &lt; 2e-16 ***
## COVERAGEAll          -0.05350    0.01777  -3.010 0.002609 ** 
## FUELgasoline         -0.17663    0.01752 -10.082  &lt; 2e-16 ***
## SEXfemale             0.04263    0.01817   2.345 0.019003 *  
## USEwork              -0.06017    0.03740  -1.609 0.107703    
## FLEETY               -0.14713    0.04887  -3.011 0.002608 ** 
## AGEPH_fac(43.7,56.5] -0.02054    0.02100  -0.978 0.327994    
## AGEPH_fac(56.5,69.3] -0.22275    0.02570  -8.669  &lt; 2e-16 ***
## AGEPH_fac(17.9,30.8]  0.17461    0.02318   7.534 4.93e-14 ***
## AGEPH_fac(69.3,82.2] -0.24619    0.03613  -6.815 9.45e-12 ***
## AGEPH_fac(82.2,95.1]  0.08852    0.11179   0.792 0.428464    
## AGEC_fac(5,9]         0.03360    0.01959   1.715 0.086437 .  
## AGEC_fac(9,48]        0.05308    0.02213   2.399 0.016445 *  
## POWER_fac(40,48]      0.09310    0.02557   3.641 0.000271 ***
## POWER_fac(48,55]      0.09542    0.02459   3.880 0.000104 ***
## POWER_fac(55,66]      0.10603    0.02643   4.011 6.04e-05 ***
## POWER_fac(66,243]     0.21080    0.02584   8.159 3.37e-16 ***
## BM_fac(0,5]           0.22067    0.02021  10.921  &lt; 2e-16 ***
## BM_fac(5,11]          0.59307    0.02294  25.850  &lt; 2e-16 ***
## BM_fac(11,22]         0.82169    0.03941  20.851  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for poisson family taken to be 1)
## 
##     Null deviance: 71970  on 130584  degrees of freedom
## Residual deviance: 69940  on 130565  degrees of freedom
## AIC: 100292
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" tabindex="-1"></a><span class="fu">BIC</span>(<span class="fu">extract_fit_engine</span>(m5_fit))</span></code></pre></div>
<pre><code>## [1] 100487.4</code></pre>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" tabindex="-1"></a><span class="fu">anova</span>(<span class="fu">extract_fit_engine</span>(m2_fit), <span class="fu">extract_fit_engine</span>(m5_fit), <span class="at">test =</span><span class="st">&quot;Chisq&quot;</span>)</span></code></pre></div>
<pre><code>## Analysis of Deviance Table
## 
## Model 1: NCLAIMS ~ offset(log(EXP)) + (EXP + COVERAGE + FUEL + SEX + USE + 
##     FLEET + AGEPH_fac + AGEC_fac + POWER_fac + BM_fac) - EXP
## Model 2: NCLAIMS ~ offset(log(EXP)) + (EXP + COVERAGE + FUEL + SEX + USE + 
##     FLEET + AGEPH_fac + AGEC_fac + POWER_fac + BM_fac) - EXP
##   Resid. Df Resid. Dev Df Deviance Pr(&gt;Chi)
## 1    130564      69938                     
## 2    130565      69940 -1  -1.9013   0.1679</code></pre>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" tabindex="-1"></a>folds <span class="ot">=</span> training_set <span class="sc">%&gt;%</span> <span class="fu">vfold_cv</span>(<span class="at">strata =</span> NCLAIMS, <span class="at">v =</span> <span class="dv">5</span>)</span>
<span id="cb161-2"><a href="#cb161-2" tabindex="-1"></a>res <span class="ot">=</span> <span class="fu">fit_resamples</span>(m5_wflow,</span>
<span id="cb161-3"><a href="#cb161-3" tabindex="-1"></a>                    <span class="at">resamples =</span> folds,</span>
<span id="cb161-4"><a href="#cb161-4" tabindex="-1"></a>                    <span class="at">metrics =</span> <span class="fu">metric_set</span>(poisson_log_loss))</span>
<span id="cb161-5"><a href="#cb161-5" tabindex="-1"></a><span class="fu">collect_metrics</span>(res) <span class="sc">%&gt;%</span></span>
<span id="cb161-6"><a href="#cb161-6" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb161-7"><a href="#cb161-7" tabindex="-1"></a>    <span class="at">mean =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%.6f&quot;</span>, mean),</span>
<span id="cb161-8"><a href="#cb161-8" tabindex="-1"></a>    <span class="at">std_err =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%.6f&quot;</span>, std_err)</span>
<span id="cb161-9"><a href="#cb161-9" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## # A tibble: 1 × 6
##   .metric          .estimator mean         n std_err  .config        
##   &lt;chr&gt;            &lt;chr&gt;      &lt;chr&gt;    &lt;int&gt; &lt;chr&gt;    &lt;chr&gt;          
## 1 poisson_log_loss standard   0.384031     5 0.002781 pre0_mod0_post0</code></pre>
<p>We obtain satisfactory results as the AIC remains the same but BIC is
reduced by 10. Furthermore, the anova test cannot enable us to reject
the hypothesis that additional coefficients cannot be 0. Unfortunately,
the cross validation results perform worse than the basic model, but we
will rely on the improvements in the other elements.</p>
<p>Now, we also merge together the different car’s ages intervals since
they appear not being significant in our previously simplified
model.</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" tabindex="-1"></a>rec_6 <span class="ot">&lt;-</span> <span class="fu">recipe</span>(NCLAIMS <span class="sc">~</span> EXP <span class="sc">+</span> COVERAGE <span class="sc">+</span> FUEL <span class="sc">+</span> SEX <span class="sc">+</span> USE<span class="sc">+</span></span>
<span id="cb163-2"><a href="#cb163-2" tabindex="-1"></a>                            FLEET<span class="sc">+</span> AGEPH_fac <span class="sc">+</span> AGEC_fac <span class="sc">+</span> POWER_fac <span class="sc">+</span></span>
<span id="cb163-3"><a href="#cb163-3" tabindex="-1"></a>                            BM_fac , <span class="at">data =</span> training_set) <span class="sc">%&gt;%</span></span>
<span id="cb163-4"><a href="#cb163-4" tabindex="-1"></a>  <span class="fu">step_mutate</span>(<span class="at">COVERAGE =</span> forcats<span class="sc">::</span><span class="fu">fct_collapse</span>(COVERAGE, <span class="st">&quot;All&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;PO&quot;</span>,<span class="st">&quot;FO&quot;</span>)))<span class="sc">%&gt;%</span></span>
<span id="cb163-5"><a href="#cb163-5" tabindex="-1"></a>  <span class="fu">step_mutate</span>(<span class="at">AGEC_fac =</span> forcats<span class="sc">::</span><span class="fu">fct_collapse</span>(AGEC_fac, <span class="st">&quot;All&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;(5,9]&quot;</span>,<span class="st">&quot;(9,48]&quot;</span>)))</span>
<span id="cb163-6"><a href="#cb163-6" tabindex="-1"></a></span>
<span id="cb163-7"><a href="#cb163-7" tabindex="-1"></a>m6_wflow <span class="ot">&lt;-</span> </span>
<span id="cb163-8"><a href="#cb163-8" tabindex="-1"></a>  <span class="fu">workflow</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb163-9"><a href="#cb163-9" tabindex="-1"></a>  <span class="fu">add_recipe</span>(rec_6) <span class="sc">%&gt;%</span></span>
<span id="cb163-10"><a href="#cb163-10" tabindex="-1"></a>  <span class="fu">add_model</span>(m2_mod, <span class="at">formula =</span> NCLAIMS <span class="sc">~</span> <span class="fu">offset</span>(<span class="fu">log</span>(EXP)) <span class="sc">+</span> . <span class="sc">-</span> EXP) <span class="co"># Formula of the model</span></span>
<span id="cb163-11"><a href="#cb163-11" tabindex="-1"></a>  </span>
<span id="cb163-12"><a href="#cb163-12" tabindex="-1"></a>m6_wflow</span></code></pre></div>
<pre><code>## ══ Workflow ════════════════════════════════════════════════════════════════════
## Preprocessor: Recipe
## Model: poisson_reg()
## 
## ── Preprocessor ────────────────────────────────────────────────────────────────
## 2 Recipe Steps
## 
## • step_mutate()
## • step_mutate()
## 
## ── Model ───────────────────────────────────────────────────────────────────────
## Poisson Regression Model Specification (regression)
## 
## Computational engine: glm</code></pre>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" tabindex="-1"></a>m6_fit <span class="ot">&lt;-</span> <span class="fu">fit</span>(m6_wflow, <span class="at">data =</span> training_set)</span>
<span id="cb165-2"><a href="#cb165-2" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">extract_fit_engine</span>(m6_fit))</span></code></pre></div>
<pre><code>## 
## Call:
## stats::glm(formula = NCLAIMS ~ offset(log(EXP)) + . - EXP, family = stats::poisson, 
##     data = data)
## 
## Coefficients:
##                      Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)          -2.19401    0.03323 -66.035  &lt; 2e-16 ***
## COVERAGEAll          -0.05653    0.01748  -3.234 0.001220 ** 
## FUELgasoline         -0.17600    0.01751 -10.052  &lt; 2e-16 ***
## SEXfemale             0.04247    0.01818   2.337 0.019457 *  
## USEwork              -0.06038    0.03740  -1.614 0.106487    
## FLEETY               -0.14753    0.04887  -3.019 0.002537 ** 
## AGEPH_fac(43.7,56.5] -0.02042    0.02100  -0.973 0.330704    
## AGEPH_fac(56.5,69.3] -0.22252    0.02570  -8.660  &lt; 2e-16 ***
## AGEPH_fac(17.9,30.8]  0.17383    0.02316   7.505 6.17e-14 ***
## AGEPH_fac(69.3,82.2] -0.24525    0.03611  -6.791 1.11e-11 ***
## AGEPH_fac(82.2,95.1]  0.09060    0.11177   0.811 0.417603    
## AGEC_facAll           0.04080    0.01807   2.257 0.023986 *  
## POWER_fac(40,48]      0.09076    0.02545   3.566 0.000363 ***
## POWER_fac(48,55]      0.09308    0.02447   3.803 0.000143 ***
## POWER_fac(55,66]      0.10299    0.02624   3.925 8.68e-05 ***
## POWER_fac(66,243]     0.20738    0.02559   8.105 5.26e-16 ***
## BM_fac(0,5]           0.22071    0.02021  10.922  &lt; 2e-16 ***
## BM_fac(5,11]          0.59405    0.02292  25.920  &lt; 2e-16 ***
## BM_fac(11,22]         0.82285    0.03939  20.890  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for poisson family taken to be 1)
## 
##     Null deviance: 71970  on 130584  degrees of freedom
## Residual deviance: 69941  on 130566  degrees of freedom
## AIC: 100291
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" tabindex="-1"></a><span class="fu">BIC</span>(<span class="fu">extract_fit_engine</span>(m6_fit))</span></code></pre></div>
<pre><code>## [1] 100476.5</code></pre>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" tabindex="-1"></a><span class="fu">anova</span>(<span class="fu">extract_fit_engine</span>(m2_fit), <span class="fu">extract_fit_engine</span>(m6_fit), <span class="at">test =</span><span class="st">&quot;Chisq&quot;</span>)</span></code></pre></div>
<pre><code>## Analysis of Deviance Table
## 
## Model 1: NCLAIMS ~ offset(log(EXP)) + (EXP + COVERAGE + FUEL + SEX + USE + 
##     FLEET + AGEPH_fac + AGEC_fac + POWER_fac + BM_fac) - EXP
## Model 2: NCLAIMS ~ offset(log(EXP)) + (EXP + COVERAGE + FUEL + SEX + USE + 
##     FLEET + AGEPH_fac + AGEC_fac + POWER_fac + BM_fac) - EXP
##   Resid. Df Resid. Dev Df Deviance Pr(&gt;Chi)
## 1    130564      69938                     
## 2    130566      69941 -2  -2.8231   0.2438</code></pre>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" tabindex="-1"></a>folds <span class="ot">=</span> training_set <span class="sc">%&gt;%</span> <span class="fu">vfold_cv</span>(<span class="at">strata =</span> NCLAIMS, <span class="at">v =</span> <span class="dv">5</span>)</span>
<span id="cb171-2"><a href="#cb171-2" tabindex="-1"></a>res <span class="ot">=</span> <span class="fu">fit_resamples</span>(m5_wflow,</span>
<span id="cb171-3"><a href="#cb171-3" tabindex="-1"></a>                    <span class="at">resamples =</span> folds,</span>
<span id="cb171-4"><a href="#cb171-4" tabindex="-1"></a>                    <span class="at">metrics =</span> <span class="fu">metric_set</span>(poisson_log_loss))</span>
<span id="cb171-5"><a href="#cb171-5" tabindex="-1"></a><span class="fu">collect_metrics</span>(res) <span class="sc">%&gt;%</span></span>
<span id="cb171-6"><a href="#cb171-6" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb171-7"><a href="#cb171-7" tabindex="-1"></a>    <span class="at">mean =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%.6f&quot;</span>, mean),</span>
<span id="cb171-8"><a href="#cb171-8" tabindex="-1"></a>    <span class="at">std_err =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%.6f&quot;</span>, std_err)</span>
<span id="cb171-9"><a href="#cb171-9" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## # A tibble: 1 × 6
##   .metric          .estimator mean         n std_err  .config        
##   &lt;chr&gt;            &lt;chr&gt;      &lt;chr&gt;    &lt;int&gt; &lt;chr&gt;    &lt;chr&gt;          
## 1 poisson_log_loss standard   0.384063     5 0.002580 pre0_mod0_post0</code></pre>
<p>Here again, our model performs even better in terms of AIC, BIC and
the anova test also supports the simplest model while making the
coefficient significant.</p>
<p>Hereafter, we want to remove the coefficient relative to <em>USE</em>
as it is not significant and does not appear to add any value to the
model. Note that it is an hypothesis already supported in our data
exploration section, resulting in a lower BIC and anova test supporting
this simplified model as well, without the USE variable.</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" tabindex="-1"></a>rec_7 <span class="ot">&lt;-</span> <span class="fu">recipe</span>(NCLAIMS <span class="sc">~</span> EXP <span class="sc">+</span> COVERAGE <span class="sc">+</span> FUEL <span class="sc">+</span> SEX <span class="sc">+</span></span>
<span id="cb173-2"><a href="#cb173-2" tabindex="-1"></a>                            FLEET<span class="sc">+</span> AGEPH_fac <span class="sc">+</span> AGEC_fac <span class="sc">+</span> POWER_fac <span class="sc">+</span></span>
<span id="cb173-3"><a href="#cb173-3" tabindex="-1"></a>                            BM_fac , <span class="at">data =</span> training_set) <span class="sc">%&gt;%</span></span>
<span id="cb173-4"><a href="#cb173-4" tabindex="-1"></a>  <span class="fu">step_mutate</span>(<span class="at">COVERAGE =</span> forcats<span class="sc">::</span><span class="fu">fct_collapse</span>(COVERAGE, <span class="st">&quot;All&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;PO&quot;</span>,<span class="st">&quot;FO&quot;</span>)))<span class="sc">%&gt;%</span></span>
<span id="cb173-5"><a href="#cb173-5" tabindex="-1"></a>  <span class="fu">step_mutate</span>(<span class="at">AGEC_fac =</span> forcats<span class="sc">::</span><span class="fu">fct_collapse</span>(AGEC_fac, <span class="st">&quot;All&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;(5,9]&quot;</span>,<span class="st">&quot;(9,48]&quot;</span>)))</span>
<span id="cb173-6"><a href="#cb173-6" tabindex="-1"></a> </span>
<span id="cb173-7"><a href="#cb173-7" tabindex="-1"></a></span>
<span id="cb173-8"><a href="#cb173-8" tabindex="-1"></a>m7_wflow <span class="ot">&lt;-</span> </span>
<span id="cb173-9"><a href="#cb173-9" tabindex="-1"></a>  <span class="fu">workflow</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb173-10"><a href="#cb173-10" tabindex="-1"></a>  <span class="fu">add_recipe</span>(rec_7) <span class="sc">%&gt;%</span></span>
<span id="cb173-11"><a href="#cb173-11" tabindex="-1"></a>  <span class="fu">add_model</span>(m2_mod, <span class="at">formula =</span> NCLAIMS <span class="sc">~</span> <span class="fu">offset</span>(<span class="fu">log</span>(EXP)) <span class="sc">+</span> . <span class="sc">-</span> EXP) <span class="co"># Formula of the model</span></span>
<span id="cb173-12"><a href="#cb173-12" tabindex="-1"></a>  </span>
<span id="cb173-13"><a href="#cb173-13" tabindex="-1"></a>m7_wflow</span></code></pre></div>
<pre><code>## ══ Workflow ════════════════════════════════════════════════════════════════════
## Preprocessor: Recipe
## Model: poisson_reg()
## 
## ── Preprocessor ────────────────────────────────────────────────────────────────
## 2 Recipe Steps
## 
## • step_mutate()
## • step_mutate()
## 
## ── Model ───────────────────────────────────────────────────────────────────────
## Poisson Regression Model Specification (regression)
## 
## Computational engine: glm</code></pre>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" tabindex="-1"></a>m7_fit <span class="ot">&lt;-</span> <span class="fu">fit</span>(m7_wflow, <span class="at">data =</span> training_set)</span>
<span id="cb175-2"><a href="#cb175-2" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">extract_fit_engine</span>(m7_fit))</span></code></pre></div>
<pre><code>## 
## Call:
## stats::glm(formula = NCLAIMS ~ offset(log(EXP)) + . - EXP, family = stats::poisson, 
##     data = data)
## 
## Coefficients:
##                      Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)          -2.19662    0.03319 -66.181  &lt; 2e-16 ***
## COVERAGEAll          -0.05763    0.01747  -3.299 0.000969 ***
## FUELgasoline         -0.17389    0.01746  -9.958  &lt; 2e-16 ***
## SEXfemale             0.04253    0.01818   2.340 0.019280 *  
## FLEETY               -0.15381    0.04872  -3.157 0.001595 ** 
## AGEPH_fac(43.7,56.5] -0.02105    0.02099  -1.003 0.315937    
## AGEPH_fac(56.5,69.3] -0.22298    0.02569  -8.678  &lt; 2e-16 ***
## AGEPH_fac(17.9,30.8]  0.17573    0.02313   7.596 3.05e-14 ***
## AGEPH_fac(69.3,82.2] -0.24540    0.03611  -6.795 1.08e-11 ***
## AGEPH_fac(82.2,95.1]  0.08918    0.11177   0.798 0.424903    
## AGEC_facAll           0.04171    0.01807   2.309 0.020961 *  
## POWER_fac(40,48]      0.09099    0.02545   3.575 0.000351 ***
## POWER_fac(48,55]      0.09267    0.02447   3.786 0.000153 ***
## POWER_fac(55,66]      0.10189    0.02623   3.884 0.000103 ***
## POWER_fac(66,243]     0.20364    0.02549   7.989 1.36e-15 ***
## BM_fac(0,5]           0.22011    0.02020  10.894  &lt; 2e-16 ***
## BM_fac(5,11]          0.59287    0.02291  25.883  &lt; 2e-16 ***
## BM_fac(11,22]         0.81571    0.03915  20.837  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for poisson family taken to be 1)
## 
##     Null deviance: 71970  on 130584  degrees of freedom
## Residual deviance: 69943  on 130567  degrees of freedom
## AIC: 100291
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" tabindex="-1"></a><span class="fu">BIC</span>(<span class="fu">extract_fit_engine</span>(m7_fit))</span></code></pre></div>
<pre><code>## [1] 100467.4</code></pre>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" tabindex="-1"></a><span class="fu">anova</span>(<span class="fu">extract_fit_engine</span>(m2_fit), <span class="fu">extract_fit_engine</span>(m7_fit), <span class="at">test =</span><span class="st">&quot;Chisq&quot;</span>)</span></code></pre></div>
<pre><code>## Analysis of Deviance Table
## 
## Model 1: NCLAIMS ~ offset(log(EXP)) + (EXP + COVERAGE + FUEL + SEX + USE + 
##     FLEET + AGEPH_fac + AGEC_fac + POWER_fac + BM_fac) - EXP
## Model 2: NCLAIMS ~ offset(log(EXP)) + (EXP + COVERAGE + FUEL + SEX + FLEET + 
##     AGEPH_fac + AGEC_fac + POWER_fac + BM_fac) - EXP
##   Resid. Df Resid. Dev Df Deviance Pr(&gt;Chi)
## 1    130564      69938                     
## 2    130567      69943 -3  -5.4726   0.1403</code></pre>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" tabindex="-1"></a>folds <span class="ot">=</span> training_set <span class="sc">%&gt;%</span> <span class="fu">vfold_cv</span>(<span class="at">strata =</span> NCLAIMS, <span class="at">v =</span> <span class="dv">5</span>)</span>
<span id="cb181-2"><a href="#cb181-2" tabindex="-1"></a>res <span class="ot">=</span> <span class="fu">fit_resamples</span>(m7_wflow,</span>
<span id="cb181-3"><a href="#cb181-3" tabindex="-1"></a>                    <span class="at">resamples =</span> folds,</span>
<span id="cb181-4"><a href="#cb181-4" tabindex="-1"></a>                    <span class="at">metrics =</span> <span class="fu">metric_set</span>(poisson_log_loss))</span>
<span id="cb181-5"><a href="#cb181-5" tabindex="-1"></a><span class="fu">collect_metrics</span>(res) <span class="sc">%&gt;%</span></span>
<span id="cb181-6"><a href="#cb181-6" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb181-7"><a href="#cb181-7" tabindex="-1"></a>    <span class="at">mean =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%.6f&quot;</span>, mean),</span>
<span id="cb181-8"><a href="#cb181-8" tabindex="-1"></a>    <span class="at">std_err =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%.6f&quot;</span>, std_err)</span>
<span id="cb181-9"><a href="#cb181-9" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## # A tibble: 1 × 6
##   .metric          .estimator mean         n std_err  .config        
##   &lt;chr&gt;            &lt;chr&gt;      &lt;chr&gt;    &lt;int&gt; &lt;chr&gt;    &lt;chr&gt;          
## 1 poisson_log_loss standard   0.383995     5 0.001125 pre0_mod0_post0</code></pre>
<p>Finally, to have only but significant coefficients, we need to deal
with the non-significant ones from policyholders’ age categories
(AGEPH). Since the interval (43.7,56.5] and (82.2,95.1] do not have a
behavior close to one another, we will simply try to include the
categories into the reference level. Indeed, it slightly biases the
estimate of the intercept, but only by a small value since the
coefficient goes from -2.19662 in <em>rec_7</em> to -2.20643 in
<em>rec_8</em> and remains significant. Finally, we can conclude that
the model related in <em>rec_8</em> is the most optimal as all the
coefficients are significant, the AIC and BIC perform better than any
other model and the anova test leads us to choose the simplified model.
Regarding the results from the cross-validation test, they perform
slightly poorer, but score a lower standard deviation, which thus is
better in term of uncertainty related to the model out-of-sample
performance. Besides, the cross validation results from all the
different tests only vary by a <span class="math inline">\(10^{-4}\)</span> value.</p>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" tabindex="-1"></a>rec_8 <span class="ot">&lt;-</span> <span class="fu">recipe</span>(NCLAIMS <span class="sc">~</span> EXP <span class="sc">+</span> COVERAGE <span class="sc">+</span> FUEL <span class="sc">+</span> SEX <span class="sc">+</span></span>
<span id="cb183-2"><a href="#cb183-2" tabindex="-1"></a>                            FLEET<span class="sc">+</span> AGEPH_fac <span class="sc">+</span> AGEC_fac <span class="sc">+</span> POWER_fac <span class="sc">+</span></span>
<span id="cb183-3"><a href="#cb183-3" tabindex="-1"></a>                            BM_fac , <span class="at">data =</span> training_set) <span class="sc">%&gt;%</span></span>
<span id="cb183-4"><a href="#cb183-4" tabindex="-1"></a>  <span class="fu">step_mutate</span>(<span class="at">COVERAGE =</span> forcats<span class="sc">::</span><span class="fu">fct_collapse</span>(COVERAGE, <span class="st">&quot;All&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;PO&quot;</span>,<span class="st">&quot;FO&quot;</span>)))<span class="sc">%&gt;%</span></span>
<span id="cb183-5"><a href="#cb183-5" tabindex="-1"></a>  <span class="fu">step_mutate</span>(<span class="at">AGEC_fac =</span> forcats<span class="sc">::</span><span class="fu">fct_collapse</span>(AGEC_fac, <span class="st">&quot;All&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;(5,9]&quot;</span>,<span class="st">&quot;(9,48]&quot;</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb183-6"><a href="#cb183-6" tabindex="-1"></a>  <span class="fu">step_mutate</span>(<span class="at">AGEPH_fac=</span> forcats <span class="sc">::</span> <span class="fu">fct_collapse</span>(AGEPH_fac, <span class="st">&quot;rest&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;(43.7,56.5]&quot;</span>, <span class="st">&quot;(82.2,95.1]&quot;</span>,<span class="st">&quot;(30.8,43.7]&quot;</span>)))<span class="sc">%&gt;%</span></span>
<span id="cb183-7"><a href="#cb183-7" tabindex="-1"></a>  <span class="fu">step_relevel</span>(AGEPH_fac, <span class="at">ref_level =</span> <span class="st">&quot;rest&quot;</span>)</span>
<span id="cb183-8"><a href="#cb183-8" tabindex="-1"></a></span>
<span id="cb183-9"><a href="#cb183-9" tabindex="-1"></a>m8_wflow <span class="ot">&lt;-</span> </span>
<span id="cb183-10"><a href="#cb183-10" tabindex="-1"></a>  <span class="fu">workflow</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb183-11"><a href="#cb183-11" tabindex="-1"></a>  <span class="fu">add_recipe</span>(rec_8) <span class="sc">%&gt;%</span></span>
<span id="cb183-12"><a href="#cb183-12" tabindex="-1"></a>  <span class="fu">add_model</span>(m2_mod, <span class="at">formula =</span> NCLAIMS <span class="sc">~</span> <span class="fu">offset</span>(<span class="fu">log</span>(EXP)) <span class="sc">+</span> . <span class="sc">-</span> EXP) <span class="co"># Formula of the model</span></span>
<span id="cb183-13"><a href="#cb183-13" tabindex="-1"></a>  </span>
<span id="cb183-14"><a href="#cb183-14" tabindex="-1"></a>m8_wflow</span></code></pre></div>
<pre><code>## ══ Workflow ════════════════════════════════════════════════════════════════════
## Preprocessor: Recipe
## Model: poisson_reg()
## 
## ── Preprocessor ────────────────────────────────────────────────────────────────
## 4 Recipe Steps
## 
## • step_mutate()
## • step_mutate()
## • step_mutate()
## • step_relevel()
## 
## ── Model ───────────────────────────────────────────────────────────────────────
## Poisson Regression Model Specification (regression)
## 
## Computational engine: glm</code></pre>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" tabindex="-1"></a>m8_fit <span class="ot">&lt;-</span> <span class="fu">fit</span>(m8_wflow, <span class="at">data =</span> training_set)</span>
<span id="cb185-2"><a href="#cb185-2" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">extract_fit_engine</span>(m8_fit))</span></code></pre></div>
<pre><code>## 
## Call:
## stats::glm(formula = NCLAIMS ~ offset(log(EXP)) + . - EXP, family = stats::poisson, 
##     data = data)
## 
## Coefficients:
##                      Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)          -2.20643    0.03138 -70.311  &lt; 2e-16 ***
## COVERAGEAll          -0.05780    0.01747  -3.309 0.000936 ***
## FUELgasoline         -0.17352    0.01743  -9.953  &lt; 2e-16 ***
## SEXfemale             0.04263    0.01815   2.348 0.018857 *  
## FLEETY               -0.15283    0.04870  -3.138 0.001700 ** 
## AGEPH_fac(56.5,69.3] -0.21384    0.02360  -9.061  &lt; 2e-16 ***
## AGEPH_fac(17.9,30.8]  0.18384    0.02143   8.579  &lt; 2e-16 ***
## AGEPH_fac(69.3,82.2] -0.23635    0.03460  -6.831 8.44e-12 ***
## AGEC_facAll           0.04191    0.01807   2.320 0.020343 *  
## POWER_fac(40,48]      0.09078    0.02545   3.566 0.000362 ***
## POWER_fac(48,55]      0.09219    0.02447   3.767 0.000165 ***
## POWER_fac(55,66]      0.10133    0.02622   3.864 0.000112 ***
## POWER_fac(66,243]     0.20262    0.02547   7.955 1.79e-15 ***
## BM_fac(0,5]           0.22120    0.02016  10.974  &lt; 2e-16 ***
## BM_fac(5,11]          0.59481    0.02277  26.127  &lt; 2e-16 ***
## BM_fac(11,22]         0.81801    0.03904  20.951  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for poisson family taken to be 1)
## 
##     Null deviance: 71970  on 130584  degrees of freedom
## Residual deviance: 69945  on 130569  degrees of freedom
## AIC: 100289
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" tabindex="-1"></a><span class="fu">BIC</span>(<span class="fu">extract_fit_engine</span>(m8_fit))</span></code></pre></div>
<pre><code>## [1] 100445.6</code></pre>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" tabindex="-1"></a><span class="fu">anova</span>(<span class="fu">extract_fit_engine</span>(m2_fit), <span class="fu">extract_fit_engine</span>(m8_fit), <span class="at">test =</span><span class="st">&quot;Chisq&quot;</span>)</span></code></pre></div>
<pre><code>## Analysis of Deviance Table
## 
## Model 1: NCLAIMS ~ offset(log(EXP)) + (EXP + COVERAGE + FUEL + SEX + USE + 
##     FLEET + AGEPH_fac + AGEC_fac + POWER_fac + BM_fac) - EXP
## Model 2: NCLAIMS ~ offset(log(EXP)) + (EXP + COVERAGE + FUEL + SEX + FLEET + 
##     AGEPH_fac + AGEC_fac + POWER_fac + BM_fac) - EXP
##   Resid. Df Resid. Dev Df Deviance Pr(&gt;Chi)
## 1    130564      69938                     
## 2    130569      69945 -5  -7.2525   0.2025</code></pre>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" tabindex="-1"></a>folds <span class="ot">=</span> training_set <span class="sc">%&gt;%</span> <span class="fu">vfold_cv</span>(<span class="at">strata =</span> NCLAIMS, <span class="at">v =</span> <span class="dv">5</span>)</span>
<span id="cb191-2"><a href="#cb191-2" tabindex="-1"></a>res <span class="ot">=</span> <span class="fu">fit_resamples</span>(m8_wflow,</span>
<span id="cb191-3"><a href="#cb191-3" tabindex="-1"></a>                    <span class="at">resamples =</span> folds,</span>
<span id="cb191-4"><a href="#cb191-4" tabindex="-1"></a>                    <span class="at">metrics =</span> <span class="fu">metric_set</span>(poisson_log_loss))</span>
<span id="cb191-5"><a href="#cb191-5" tabindex="-1"></a><span class="fu">collect_metrics</span>(res) <span class="sc">%&gt;%</span></span>
<span id="cb191-6"><a href="#cb191-6" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb191-7"><a href="#cb191-7" tabindex="-1"></a>    <span class="at">mean =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%.6f&quot;</span>, mean),</span>
<span id="cb191-8"><a href="#cb191-8" tabindex="-1"></a>    <span class="at">std_err =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%.6f&quot;</span>, std_err)</span>
<span id="cb191-9"><a href="#cb191-9" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## # A tibble: 1 × 6
##   .metric          .estimator mean         n std_err  .config        
##   &lt;chr&gt;            &lt;chr&gt;      &lt;chr&gt;    &lt;int&gt; &lt;chr&gt;    &lt;chr&gt;          
## 1 poisson_log_loss standard   0.384007     5 0.001928 pre0_mod0_post0</code></pre>
<p>Let’s build a dataframe gathering all those metrics acquired with our
computation.</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1" tabindex="-1"></a>rec0<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;rec0&quot;</span>, <span class="dv">100299</span>, <span class="dv">100495</span>, <span class="st">&quot;/&quot;</span>, <span class="fl">0.384128</span>,  <span class="dv">69947</span>)</span>
<span id="cb193-2"><a href="#cb193-2" tabindex="-1"></a>rec1<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;rec1&quot;</span>,  <span class="dv">102021</span>, <span class="dv">102089</span> , <span class="st">&quot;&lt; 2.2e-16&quot;</span> , <span class="fl">0.390671</span>, <span class="dv">71695</span>)</span>
<span id="cb193-3"><a href="#cb193-3" tabindex="-1"></a>rec2<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;rec2&quot;</span>, <span class="dv">100292</span>, <span class="fl">100497.3</span>, <span class="st">&quot;/&quot;</span> , <span class="fl">0.383969</span>,  <span class="dv">69938</span>)</span>
<span id="cb193-4"><a href="#cb193-4" tabindex="-1"></a>rec3<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;rec3&quot;</span>, <span class="dv">100266</span>, <span class="fl">100714.1</span>, <span class="st">&quot;/&quot;</span>, <span class="fl">0.383981</span>,  <span class="dv">69860</span>)</span>
<span id="cb193-5"><a href="#cb193-5" tabindex="-1"></a>rec4<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;rec4&quot;</span>, <span class="dv">100272</span>, <span class="fl">100516.7</span>, <span class="st">&quot;/&quot;</span>, <span class="fl">0.383993</span>,  <span class="dv">69910</span>)</span>
<span id="cb193-6"><a href="#cb193-6" tabindex="-1"></a>rec5<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;rec5&quot;</span>, <span class="dv">100292</span>, <span class="fl">100487.4</span>, <span class="fl">0.1679</span>, <span class="fl">0.384059</span>,  <span class="dv">69940</span>)</span>
<span id="cb193-7"><a href="#cb193-7" tabindex="-1"></a>rec6<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;rec6&quot;</span>, <span class="dv">100291</span>, <span class="fl">100476.5</span>, <span class="fl">0.2438</span>, <span class="fl">0.384017</span>,  <span class="dv">69941</span>)</span>
<span id="cb193-8"><a href="#cb193-8" tabindex="-1"></a>rec7<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;rec7&quot;</span>, <span class="dv">100291</span>, <span class="fl">100467.4</span>, <span class="fl">0.1403</span>, <span class="fl">0.384018</span>,  <span class="dv">69943</span>)</span>
<span id="cb193-9"><a href="#cb193-9" tabindex="-1"></a>rec8<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;rec8&quot;</span>, <span class="dv">100289</span>, <span class="fl">100445.6</span>, <span class="fl">0.2025</span>, <span class="fl">0.383995</span>,  <span class="dv">69945</span>)</span>
<span id="cb193-10"><a href="#cb193-10" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data =</span> <span class="fu">rbind</span>(rec0, rec1, rec2, rec3, rec4, rec5, rec6, rec7, rec8),<span class="at">nrow =</span> <span class="dv">9</span>, <span class="at">ncol =</span> <span class="dv">6</span>)</span>
<span id="cb193-11"><a href="#cb193-11" tabindex="-1"></a>df_freq <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(m)</span>
<span id="cb193-12"><a href="#cb193-12" tabindex="-1"></a><span class="fu">colnames</span>(df_freq) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Model&quot;</span>, <span class="st">&quot;AIC&quot;</span>, <span class="st">&quot;BIC&quot;</span>, <span class="st">&quot;Anova&quot;</span>, <span class="st">&quot;CV&quot;</span>, <span class="st">&quot;Residual Deviance&quot;</span>)</span>
<span id="cb193-13"><a href="#cb193-13" tabindex="-1"></a>df_freq</span></code></pre></div>
<pre><code>##   Model    AIC      BIC     Anova       CV Residual Deviance
## 1  rec0 100299   100495         / 0.384128             69947
## 2  rec1 102021   102089 &lt; 2.2e-16 0.390671             71695
## 3  rec2 100292 100497.3         / 0.383969             69938
## 4  rec3 100266 100714.1         / 0.383981             69860
## 5  rec4 100272 100516.7         / 0.383993             69910
## 6  rec5 100292 100487.4    0.1679 0.384059             69940
## 7  rec6 100291 100476.5    0.2438 0.384017             69941
## 8  rec7 100291 100467.4    0.1403 0.384018             69943
## 9  rec8 100289 100445.6    0.2025 0.383995             69945</code></pre>
<p>Based on these results, we see that the <em>rec_8</em> model stands
out and is the most preferable option.</p>
</div>
</div>
<div id="severity-model-log-gamma" class="section level2">
<h2>Severity model (Log-Gamma)</h2>
<p>We will in this section explore a GLM based severity model and try to
find underlying pattern and the best explanatory variables. We start by
remodelling our data set to only consider number of claims superior or
equal to 1, and get rid of the years without claims (NAs). We do not
forget to partition the data to properly compute under recipe and
workflows functions. In this scenario, average claim amount will be
assumed to follow a log-Gamma distribution. Based on the assumptions
from the previous section on frequency models, we used the bins for
continuous variables that we computed ourselves in the first
section.</p>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1" tabindex="-1"></a>dataset <span class="ot">&lt;-</span> mtpl_be <span class="sc">%&gt;%</span> <span class="fu">filter</span>(NCLAIMS<span class="sc">&gt;</span><span class="dv">0</span>)</span>
<span id="cb195-2"><a href="#cb195-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)  <span class="co"># For reproducibility</span></span>
<span id="cb195-3"><a href="#cb195-3" tabindex="-1"></a>in_training <span class="ot">=</span> <span class="fu">createDataPartition</span>(dataset<span class="sc">$</span>AVG, <span class="at">times =</span> <span class="dv">1</span>, <span class="at">p =</span> <span class="fl">0.8</span>, <span class="at">list =</span> <span class="cn">FALSE</span>)</span>
<span id="cb195-4"><a href="#cb195-4" tabindex="-1"></a>training_set <span class="ot">=</span> dataset[in_training, ]</span>
<span id="cb195-5"><a href="#cb195-5" tabindex="-1"></a>testing_set <span class="ot">=</span> dataset[<span class="sc">-</span>in_training, ]</span>
<span id="cb195-6"><a href="#cb195-6" tabindex="-1"></a><span class="fu">hist</span>(dataset<span class="sc">$</span>NCLAIMS)</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="100%" /></p>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" tabindex="-1"></a>sev0 <span class="ot">&lt;-</span> <span class="fu">recipe</span>(AVG <span class="sc">~</span> COVERAGE <span class="sc">+</span> FUEL <span class="sc">+</span> SEX <span class="sc">+</span> USE <span class="sc">+</span> FLEET <span class="sc">+</span> AGEPH_fac <span class="sc">+</span></span>
<span id="cb196-2"><a href="#cb196-2" tabindex="-1"></a>                 AGEC_fac <span class="sc">+</span> POWER_fac <span class="sc">+</span> BM_fac, <span class="at">data =</span> training_set)</span>
<span id="cb196-3"><a href="#cb196-3" tabindex="-1"></a></span>
<span id="cb196-4"><a href="#cb196-4" tabindex="-1"></a>s0_mod <span class="ot">&lt;-</span> <span class="fu">linear_reg</span>() <span class="sc">%&gt;%</span></span>
<span id="cb196-5"><a href="#cb196-5" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">&quot;glm&quot;</span>, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link =</span> <span class="st">&quot;log&quot;</span>))</span>
<span id="cb196-6"><a href="#cb196-6" tabindex="-1"></a></span>
<span id="cb196-7"><a href="#cb196-7" tabindex="-1"></a>s0_wflow <span class="ot">&lt;-</span> </span>
<span id="cb196-8"><a href="#cb196-8" tabindex="-1"></a>  <span class="fu">workflow</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb196-9"><a href="#cb196-9" tabindex="-1"></a>  <span class="fu">add_model</span>(s0_mod, <span class="at">formula =</span> AVG <span class="sc">~</span> . ) <span class="sc">%&gt;%</span> <span class="co"># Formula of the model</span></span>
<span id="cb196-10"><a href="#cb196-10" tabindex="-1"></a>  <span class="fu">add_recipe</span>(sev0)</span>
<span id="cb196-11"><a href="#cb196-11" tabindex="-1"></a></span>
<span id="cb196-12"><a href="#cb196-12" tabindex="-1"></a>s0_fit <span class="ot">&lt;-</span> <span class="fu">fit</span>(s0_wflow, <span class="at">data =</span> training_set)</span>
<span id="cb196-13"><a href="#cb196-13" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">extract_fit_engine</span>(s0_fit))</span></code></pre></div>
<pre><code>## 
## Call:
## stats::glm(formula = AVG ~ ., family = ~Gamma(link = &quot;log&quot;), 
##     data = data)
## 
## Coefficients:
##                        Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)           7.0059136  0.2272564  30.828   &lt;2e-16 ***
## COVERAGEPO           -0.1283723  0.1317785  -0.974   0.3300    
## COVERAGEFO            0.2626444  0.1812865   1.449   0.1474    
## FUELgasoline          0.1677912  0.1196754   1.402   0.1609    
## SEXfemale             0.0952951  0.1229255   0.775   0.4382    
## USEwork              -0.0005477  0.2524809  -0.002   0.9983    
## FLEETY               -0.3031253  0.3272373  -0.926   0.3543    
## AGEPH_fac(43.7,56.5] -0.0551190  0.1423727  -0.387   0.6987    
## AGEPH_fac(56.5,69.3] -0.3169405  0.1711375  -1.852   0.0641 .  
## AGEPH_fac(17.9,30.8] -0.2008319  0.1601721  -1.254   0.2099    
## AGEPH_fac(69.3,82.2] -0.0404612  0.2396931  -0.169   0.8660    
## AGEPH_fac(82.2,95.1]  0.0389405  0.7361010   0.053   0.9578    
## AGEC_fac(5,9]         0.1628502  0.1375450   1.184   0.2364    
## AGEC_fac(9,48]        0.2436375  0.1542065   1.580   0.1141    
## POWER_fac(40,48]     -0.0688098  0.1739690  -0.396   0.6925    
## POWER_fac(48,55]      0.0838101  0.1669307   0.502   0.6156    
## POWER_fac(55,66]      0.3620102  0.1802207   2.009   0.0446 *  
## POWER_fac(66,243]     0.0407447  0.1745376   0.233   0.8154    
## BM_fac(0,5]          -0.0019317  0.1356572  -0.014   0.9886    
## BM_fac(5,11]          0.2784222  0.1553684   1.792   0.0732 .  
## BM_fac(11,22]         0.3094075  0.2717810   1.138   0.2550    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for Gamma family taken to be 41.61009)
## 
##     Null deviance: 37162  on 14637  degrees of freedom
## Residual deviance: 35636  on 14617  degrees of freedom
## AIC: 239017
## 
## Number of Fisher Scoring iterations: 16</code></pre>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" tabindex="-1"></a>resS0 <span class="ot">=</span> <span class="fu">fit_resamples</span>(s0_wflow,</span>
<span id="cb198-2"><a href="#cb198-2" tabindex="-1"></a>                    <span class="at">resamples =</span> folds,</span>
<span id="cb198-3"><a href="#cb198-3" tabindex="-1"></a>                    <span class="at">metrics =</span> <span class="fu">metric_set</span>(rmse, mae))</span>
<span id="cb198-4"><a href="#cb198-4" tabindex="-1"></a><span class="fu">collect_metrics</span>(resS0) <span class="sc">%&gt;%</span></span>
<span id="cb198-5"><a href="#cb198-5" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb198-6"><a href="#cb198-6" tabindex="-1"></a>    <span class="at">mean =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%.6f&quot;</span>, mean),</span>
<span id="cb198-7"><a href="#cb198-7" tabindex="-1"></a>    <span class="at">std_err =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%.6f&quot;</span>, std_err)</span>
<span id="cb198-8"><a href="#cb198-8" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## # A tibble: 2 × 6
##   .metric .estimator mean             n std_err     .config        
##   &lt;chr&gt;   &lt;chr&gt;      &lt;chr&gt;        &lt;int&gt; &lt;chr&gt;       &lt;chr&gt;          
## 1 mae     standard   1829.345764      5 149.500933  pre0_mod0_post0
## 2 rmse    standard   13358.073248     5 6370.667349 pre0_mod0_post0</code></pre>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" tabindex="-1"></a><span class="fu">BIC</span>(<span class="fu">extract_fit_engine</span>(s0_fit))</span></code></pre></div>
<pre><code>## [1] 239183.8</code></pre>
<p>The early conclusion we can made based on the summary of our base
model above is that no coefficient seems to be significant to predict
the average claim amount, except maybe for horsepower. When we take a
deeper look at what we are trying to predict, it seems fair that none of
these information do have a link or influence on the claim amount, or at
least have a direct relationship. So far we only find medium Power range
being (barely) significant. Let’s now try to add some interactions which
might help with our model.</p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="#cb202-1" tabindex="-1"></a>sev1 <span class="ot">&lt;-</span> <span class="fu">recipe</span>(AVG <span class="sc">~</span> COVERAGE <span class="sc">+</span> FUEL <span class="sc">+</span> SEX <span class="sc">+</span> USE <span class="sc">+</span> FLEET <span class="sc">+</span> AGEPH_fac <span class="sc">+</span></span>
<span id="cb202-2"><a href="#cb202-2" tabindex="-1"></a>                 AGEC_fac <span class="sc">+</span> POWER_fac <span class="sc">+</span> BM_fac , <span class="at">data =</span> training_set) </span>
<span id="cb202-3"><a href="#cb202-3" tabindex="-1"></a></span>
<span id="cb202-4"><a href="#cb202-4" tabindex="-1"></a>s1_mod <span class="ot">&lt;-</span> <span class="fu">linear_reg</span>() <span class="sc">%&gt;%</span></span>
<span id="cb202-5"><a href="#cb202-5" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">&quot;glm&quot;</span>, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link =</span> <span class="st">&quot;log&quot;</span>))</span>
<span id="cb202-6"><a href="#cb202-6" tabindex="-1"></a></span>
<span id="cb202-7"><a href="#cb202-7" tabindex="-1"></a>s1_wflow <span class="ot">&lt;-</span> </span>
<span id="cb202-8"><a href="#cb202-8" tabindex="-1"></a>  <span class="fu">workflow</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb202-9"><a href="#cb202-9" tabindex="-1"></a>  <span class="fu">add_model</span>(s1_mod, <span class="at">formula =</span> AVG <span class="sc">~</span> FUEL<span class="sc">*</span>POWER_fac <span class="sc">+</span> AGEPH_fac<span class="sc">*</span>BM_fac <span class="sc">+</span> COVERAGE<span class="sc">*</span>BM_fac<span class="sc">+</span> . ) <span class="sc">%&gt;%</span> <span class="co"># Formula of the model</span></span>
<span id="cb202-10"><a href="#cb202-10" tabindex="-1"></a>  <span class="fu">add_recipe</span>(sev1)</span>
<span id="cb202-11"><a href="#cb202-11" tabindex="-1"></a></span>
<span id="cb202-12"><a href="#cb202-12" tabindex="-1"></a>s1_fit <span class="ot">&lt;-</span> <span class="fu">fit</span>(s1_wflow, <span class="at">data =</span> training_set)</span>
<span id="cb202-13"><a href="#cb202-13" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">extract_fit_engine</span>(s1_fit))</span></code></pre></div>
<pre><code>## 
## Call:
## stats::glm(formula = AVG ~ FUEL * POWER_fac + AGEPH_fac * BM_fac + 
##     COVERAGE * BM_fac + ., family = ~Gamma(link = &quot;log&quot;), data = data)
## 
## Coefficients: (1 not defined because of singularities)
##                                    Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)                         7.03522    0.30375  23.161   &lt;2e-16 ***
## FUELgasoline                        0.03858    0.24379   0.158   0.8743    
## POWER_fac(40,48]                   -0.09583    0.26503  -0.362   0.7177    
## POWER_fac(48,55]                   -0.08460    0.26335  -0.321   0.7480    
## POWER_fac(55,66]                    0.12495    0.30531   0.409   0.6824    
## POWER_fac(66,243]                   0.01852    0.33197   0.056   0.9555    
## AGEPH_fac(43.7,56.5]                0.01396    0.22489   0.062   0.9505    
## AGEPH_fac(56.5,69.3]               -0.28049    0.25313  -1.108   0.2679    
## AGEPH_fac(17.9,30.8]                0.02186    0.58643   0.037   0.9703    
## AGEPH_fac(69.3,82.2]                0.14106    0.32228   0.438   0.6616    
## AGEPH_fac(82.2,95.1]               -0.33083    1.17381  -0.282   0.7781    
## BM_fac(0,5]                        -0.01141    0.24168  -0.047   0.9623    
## BM_fac(5,11]                        0.59373    0.25772   2.304   0.0212 *  
## BM_fac(11,22]                       0.40821    0.47050   0.868   0.3856    
## COVERAGEPO                         -0.05307    0.20490  -0.259   0.7956    
## COVERAGEFO                          0.38782    0.26641   1.456   0.1455    
## SEXfemale                           0.07157    0.11062   0.647   0.5177    
## USEwork                             0.04243    0.22777   0.186   0.8522    
## FLEETY                             -0.29021    0.29438  -0.986   0.3242    
## AGEC_fac(5,9]                       0.14723    0.12441   1.183   0.2367    
## AGEC_fac(9,48]                      0.21731    0.14074   1.544   0.1226    
## FUELgasoline:POWER_fac(40,48]      -0.04040    0.33053  -0.122   0.9027    
## FUELgasoline:POWER_fac(48,55]       0.25358    0.31965   0.793   0.4276    
## FUELgasoline:POWER_fac(55,66]       0.23131    0.35163   0.658   0.5107    
## FUELgasoline:POWER_fac(66,243]      0.02543    0.36608   0.069   0.9446    
## AGEPH_fac(43.7,56.5]:BM_fac(0,5]    0.17437    0.30187   0.578   0.5635    
## AGEPH_fac(56.5,69.3]:BM_fac(0,5]    0.23420    0.34897   0.671   0.5022    
## AGEPH_fac(17.9,30.8]:BM_fac(0,5]   -0.09485    0.64137  -0.148   0.8824    
## AGEPH_fac(69.3,82.2]:BM_fac(0,5]   -0.09378    0.46792  -0.200   0.8411    
## AGEPH_fac(82.2,95.1]:BM_fac(0,5]    0.70363    1.46840   0.479   0.6318    
## AGEPH_fac(43.7,56.5]:BM_fac(5,11]  -0.53826    0.34657  -1.553   0.1204    
## AGEPH_fac(56.5,69.3]:BM_fac(5,11]  -0.47806    0.43482  -1.099   0.2716    
## AGEPH_fac(17.9,30.8]:BM_fac(5,11]  -0.39850    0.62276  -0.640   0.5223    
## AGEPH_fac(69.3,82.2]:BM_fac(5,11]  -0.69968    0.67770  -1.032   0.3019    
## AGEPH_fac(82.2,95.1]:BM_fac(5,11]   0.28639    2.18245   0.131   0.8956    
## AGEPH_fac(43.7,56.5]:BM_fac(11,22] -0.11621    0.71277  -0.163   0.8705    
## AGEPH_fac(56.5,69.3]:BM_fac(11,22] -0.33539    0.92452  -0.363   0.7168    
## AGEPH_fac(17.9,30.8]:BM_fac(11,22] -0.42797    0.78430  -0.546   0.5853    
## AGEPH_fac(69.3,82.2]:BM_fac(11,22] -0.46850    1.46839  -0.319   0.7497    
## AGEPH_fac(82.2,95.1]:BM_fac(11,22]       NA         NA      NA       NA    
## BM_fac(0,5]:COVERAGEPO             -0.24546    0.27290  -0.899   0.3684    
## BM_fac(5,11]:COVERAGEPO            -0.06346    0.30065  -0.211   0.8328    
## BM_fac(11,22]:COVERAGEPO            0.49784    0.57208   0.870   0.3842    
## BM_fac(0,5]:COVERAGEFO             -0.05368    0.34937  -0.154   0.8779    
## BM_fac(5,11]:COVERAGEFO            -0.37060    0.38108  -0.972   0.3308    
## BM_fac(11,22]:COVERAGEFO           -0.92899    0.77813  -1.194   0.2326    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for Gamma family taken to be 33.57241)
## 
##     Null deviance: 37162  on 14637  degrees of freedom
## Residual deviance: 35157  on 14593  degrees of freedom
## AIC: 238806
## 
## Number of Fisher Scoring iterations: 25</code></pre>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="#cb204-1" tabindex="-1"></a>resS1 <span class="ot">=</span> <span class="fu">fit_resamples</span>(s1_wflow,</span>
<span id="cb204-2"><a href="#cb204-2" tabindex="-1"></a>                    <span class="at">resamples =</span> folds,</span>
<span id="cb204-3"><a href="#cb204-3" tabindex="-1"></a>                    <span class="at">metrics =</span> <span class="fu">metric_set</span>(rmse, mae))</span>
<span id="cb204-4"><a href="#cb204-4" tabindex="-1"></a><span class="fu">collect_metrics</span>(resS1) <span class="sc">%&gt;%</span></span>
<span id="cb204-5"><a href="#cb204-5" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb204-6"><a href="#cb204-6" tabindex="-1"></a>    <span class="at">mean =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%.6f&quot;</span>, mean),</span>
<span id="cb204-7"><a href="#cb204-7" tabindex="-1"></a>    <span class="at">std_err =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%.6f&quot;</span>, std_err)</span>
<span id="cb204-8"><a href="#cb204-8" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## # A tibble: 2 × 6
##   .metric .estimator mean            n std_err .config        
##   &lt;chr&gt;   &lt;chr&gt;      &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;   &lt;chr&gt;          
## 1 mae     standard   1616.861516     1 NA      pre0_mod0_post0
## 2 rmse    standard   5684.110132     1 NA      pre0_mod0_post0</code></pre>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="#cb206-1" tabindex="-1"></a><span class="fu">BIC</span>(<span class="fu">extract_fit_engine</span>(s1_fit))</span></code></pre></div>
<pre><code>## [1] 239155.1</code></pre>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="#cb208-1" tabindex="-1"></a><span class="fu">anova</span>(<span class="fu">extract_fit_engine</span>(s0_fit), <span class="fu">extract_fit_engine</span>(s1_fit), <span class="at">test=</span> <span class="st">&quot;Chisq&quot;</span>)</span></code></pre></div>
<pre><code>## Analysis of Deviance Table
## 
## Model 1: AVG ~ COVERAGE + FUEL + SEX + USE + FLEET + AGEPH_fac + AGEC_fac + 
##     POWER_fac + BM_fac
## Model 2: AVG ~ FUEL * POWER_fac + AGEPH_fac * BM_fac + COVERAGE * BM_fac + 
##     (COVERAGE + FUEL + SEX + USE + FLEET + AGEPH_fac + AGEC_fac + 
##         POWER_fac + BM_fac)
##   Resid. Df Resid. Dev Df Deviance Pr(&gt;Chi)
## 1     14617      35636                     
## 2     14593      35157 24   478.24   0.9409</code></pre>
<p>The results from the anova test with respect to the extended model
with interaction cannot reject the hypothesis of all additional
coefficients to be 0. We thus prefer the simplified model.</p>
<p>Besides, we further recompute an extended model in <em>sev2</em> but
with only the interaction of Sex and Power of the vehicle, which returns
an anova p-value under 5%. Therefore, we go for the extended model.</p>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb210-1"><a href="#cb210-1" tabindex="-1"></a>sev2 <span class="ot">&lt;-</span> <span class="fu">recipe</span>(AVG <span class="sc">~</span> COVERAGE <span class="sc">+</span> FUEL <span class="sc">+</span> SEX <span class="sc">+</span> USE <span class="sc">+</span> FLEET <span class="sc">+</span> AGEPH_fac <span class="sc">+</span></span>
<span id="cb210-2"><a href="#cb210-2" tabindex="-1"></a>                 AGEC_fac <span class="sc">+</span> POWER_fac <span class="sc">+</span> BM_fac , <span class="at">data =</span> training_set) </span>
<span id="cb210-3"><a href="#cb210-3" tabindex="-1"></a></span>
<span id="cb210-4"><a href="#cb210-4" tabindex="-1"></a>s2_mod <span class="ot">&lt;-</span> <span class="fu">linear_reg</span>() <span class="sc">%&gt;%</span></span>
<span id="cb210-5"><a href="#cb210-5" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">&quot;glm&quot;</span>, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link =</span> <span class="st">&quot;log&quot;</span>))</span>
<span id="cb210-6"><a href="#cb210-6" tabindex="-1"></a></span>
<span id="cb210-7"><a href="#cb210-7" tabindex="-1"></a>s2_wflow <span class="ot">&lt;-</span> </span>
<span id="cb210-8"><a href="#cb210-8" tabindex="-1"></a>  <span class="fu">workflow</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb210-9"><a href="#cb210-9" tabindex="-1"></a>  <span class="fu">add_model</span>(s2_mod, <span class="at">formula =</span> AVG <span class="sc">~</span>  SEX <span class="sc">*</span> POWER_fac<span class="sc">+</span> . ) <span class="sc">%&gt;%</span> <span class="co"># Formula of the model</span></span>
<span id="cb210-10"><a href="#cb210-10" tabindex="-1"></a>  <span class="fu">add_recipe</span>(sev2)</span>
<span id="cb210-11"><a href="#cb210-11" tabindex="-1"></a></span>
<span id="cb210-12"><a href="#cb210-12" tabindex="-1"></a>s2_fit <span class="ot">&lt;-</span> <span class="fu">fit</span>(s2_wflow, <span class="at">data =</span> training_set)</span>
<span id="cb210-13"><a href="#cb210-13" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">extract_fit_engine</span>(s2_fit))</span></code></pre></div>
<pre><code>## 
## Call:
## stats::glm(formula = AVG ~ SEX * POWER_fac + ., family = ~Gamma(link = &quot;log&quot;), 
##     data = data)
## 
## Coefficients:
##                              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)                  7.138195   0.188159  37.937  &lt; 2e-16 ***
## SEXfemale                   -0.136056   0.183265  -0.742   0.4579    
## POWER_fac(40,48]            -0.124316   0.166327  -0.747   0.4548    
## POWER_fac(48,55]             0.063771   0.158248   0.403   0.6870    
## POWER_fac(55,66]            -0.056425   0.167382  -0.337   0.7360    
## POWER_fac(66,243]           -0.087186   0.160953  -0.542   0.5880    
## COVERAGEPO                  -0.175656   0.102273  -1.718   0.0859 .  
## COVERAGEFO                   0.245316   0.140670   1.744   0.0812 .  
## FUELgasoline                 0.121342   0.092938   1.306   0.1917    
## USEwork                      0.018544   0.196026   0.095   0.9246    
## FLEETY                      -0.270794   0.253948  -1.066   0.2863    
## AGEPH_fac(43.7,56.5]         0.040049   0.110489   0.362   0.7170    
## AGEPH_fac(56.5,69.3]        -0.245714   0.132805  -1.850   0.0643 .  
## AGEPH_fac(17.9,30.8]        -0.061283   0.124342  -0.493   0.6221    
## AGEPH_fac(69.3,82.2]         0.024996   0.186091   0.134   0.8932    
## AGEPH_fac(82.2,95.1]         0.087706   0.571487   0.153   0.8780    
## AGEC_fac(5,9]                0.158964   0.106786   1.489   0.1366    
## AGEC_fac(9,48]               0.150280   0.119800   1.254   0.2097    
## BM_fac(0,5]                  0.004416   0.105268   0.042   0.9665    
## BM_fac(5,11]                 0.200146   0.120580   1.660   0.0970 .  
## BM_fac(11,22]                0.168440   0.210906   0.799   0.4245    
## SEXfemale:POWER_fac(40,48]  -0.006748   0.276718  -0.024   0.9805    
## SEXfemale:POWER_fac(48,55]  -0.175470   0.270716  -0.648   0.5169    
## SEXfemale:POWER_fac(55,66]   1.316727   0.301701   4.364 1.28e-05 ***
## SEXfemale:POWER_fac(66,243]  0.352627   0.296617   1.189   0.2345    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for Gamma family taken to be 25.05346)
## 
##     Null deviance: 37162  on 14637  degrees of freedom
## Residual deviance: 34956  on 14613  degrees of freedom
## AIC: 238656
## 
## Number of Fisher Scoring iterations: 18</code></pre>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="#cb212-1" tabindex="-1"></a>resS2 <span class="ot">=</span> <span class="fu">fit_resamples</span>(s2_wflow,</span>
<span id="cb212-2"><a href="#cb212-2" tabindex="-1"></a>                    <span class="at">resamples =</span> folds,</span>
<span id="cb212-3"><a href="#cb212-3" tabindex="-1"></a>                    <span class="at">metrics =</span> <span class="fu">metric_set</span>(rmse, mae))</span>
<span id="cb212-4"><a href="#cb212-4" tabindex="-1"></a><span class="fu">collect_metrics</span>(resS2) <span class="sc">%&gt;%</span></span>
<span id="cb212-5"><a href="#cb212-5" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb212-6"><a href="#cb212-6" tabindex="-1"></a>    <span class="at">mean =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%.6f&quot;</span>, mean),</span>
<span id="cb212-7"><a href="#cb212-7" tabindex="-1"></a>    <span class="at">std_err =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%.6f&quot;</span>, std_err)</span>
<span id="cb212-8"><a href="#cb212-8" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## # A tibble: 2 × 6
##   .metric .estimator mean             n std_err     .config        
##   &lt;chr&gt;   &lt;chr&gt;      &lt;chr&gt;        &lt;int&gt; &lt;chr&gt;       &lt;chr&gt;          
## 1 mae     standard   1839.467727      5 147.857359  pre0_mod0_post0
## 2 rmse    standard   13375.081099     5 6366.340023 pre0_mod0_post0</code></pre>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="#cb214-1" tabindex="-1"></a><span class="fu">BIC</span>(<span class="fu">extract_fit_engine</span>(s2_fit))</span></code></pre></div>
<pre><code>## [1] 238853.2</code></pre>
<p>If we look at the cross validation results to determine the
prediction performance of the extended models with interaction, we see
that their performance is poorer. We will thus continue further with an
interactionless model.</p>
<p>Clearly, doing so step-by-step while no coefficient is ever
significant, we will first evaluate if a model with only the intercept
might be a good solution with respect to the anova test. If not, we will
do the step by step iteration and aim for the best performance
indicators and best highest anova p-value.</p>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="#cb216-1" tabindex="-1"></a>sev_I <span class="ot">&lt;-</span> <span class="fu">recipe</span>(AVG <span class="sc">~</span> COVERAGE <span class="sc">+</span> FUEL <span class="sc">+</span> FLEET <span class="sc">+</span> USE <span class="sc">+</span> SEX <span class="sc">+</span>  AGEPH_fac <span class="sc">+</span></span>
<span id="cb216-2"><a href="#cb216-2" tabindex="-1"></a>                 AGEC_fac <span class="sc">+</span> POWER_fac <span class="sc">+</span> BM_fac , <span class="at">data =</span> training_set) </span>
<span id="cb216-3"><a href="#cb216-3" tabindex="-1"></a> </span>
<span id="cb216-4"><a href="#cb216-4" tabindex="-1"></a></span>
<span id="cb216-5"><a href="#cb216-5" tabindex="-1"></a>sI_mod <span class="ot">&lt;-</span> <span class="fu">linear_reg</span>() <span class="sc">%&gt;%</span></span>
<span id="cb216-6"><a href="#cb216-6" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">&quot;glm&quot;</span>, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link =</span> <span class="st">&quot;log&quot;</span>))</span>
<span id="cb216-7"><a href="#cb216-7" tabindex="-1"></a></span>
<span id="cb216-8"><a href="#cb216-8" tabindex="-1"></a>sI_wflow <span class="ot">&lt;-</span> </span>
<span id="cb216-9"><a href="#cb216-9" tabindex="-1"></a>  <span class="fu">workflow</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb216-10"><a href="#cb216-10" tabindex="-1"></a>  <span class="fu">add_model</span>(sI_mod, <span class="at">formula =</span> AVG <span class="sc">~</span> <span class="dv">1</span>  ) <span class="sc">%&gt;%</span> <span class="co"># Formula of the model</span></span>
<span id="cb216-11"><a href="#cb216-11" tabindex="-1"></a>  <span class="fu">add_recipe</span>(sev_I)</span>
<span id="cb216-12"><a href="#cb216-12" tabindex="-1"></a></span>
<span id="cb216-13"><a href="#cb216-13" tabindex="-1"></a>sI_fit <span class="ot">&lt;-</span> <span class="fu">fit</span>(sI_wflow, <span class="at">data =</span> training_set)</span>
<span id="cb216-14"><a href="#cb216-14" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">extract_fit_engine</span>(sI_fit))</span></code></pre></div>
<pre><code>## 
## Call:
## stats::glm(formula = AVG ~ 1, family = ~Gamma(link = &quot;log&quot;), 
##     data = data)
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  7.38637    0.09265   79.73   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for Gamma family taken to be 125.6423)
## 
##     Null deviance: 37162  on 14637  degrees of freedom
## Residual deviance: 37162  on 14637  degrees of freedom
## AIC: 239784
## 
## Number of Fisher Scoring iterations: 7</code></pre>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="#cb218-1" tabindex="-1"></a>resSI <span class="ot">=</span> <span class="fu">fit_resamples</span>(sI_wflow,</span>
<span id="cb218-2"><a href="#cb218-2" tabindex="-1"></a>                    <span class="at">resamples =</span> folds,</span>
<span id="cb218-3"><a href="#cb218-3" tabindex="-1"></a>                    <span class="at">metrics =</span> <span class="fu">metric_set</span>(rmse, mae))</span>
<span id="cb218-4"><a href="#cb218-4" tabindex="-1"></a><span class="fu">collect_metrics</span>(resSI) <span class="sc">%&gt;%</span></span>
<span id="cb218-5"><a href="#cb218-5" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb218-6"><a href="#cb218-6" tabindex="-1"></a>    <span class="at">mean =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%.6f&quot;</span>, mean),</span>
<span id="cb218-7"><a href="#cb218-7" tabindex="-1"></a>    <span class="at">std_err =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%.6f&quot;</span>, std_err)</span>
<span id="cb218-8"><a href="#cb218-8" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## # A tibble: 2 × 6
##   .metric .estimator mean             n std_err     .config        
##   &lt;chr&gt;   &lt;chr&gt;      &lt;chr&gt;        &lt;int&gt; &lt;chr&gt;       &lt;chr&gt;          
## 1 mae     standard   1806.717919      5 147.646328  pre0_mod0_post0
## 2 rmse    standard   13348.117195     5 6375.011109 pre0_mod0_post0</code></pre>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="#cb220-1" tabindex="-1"></a><span class="fu">BIC</span>(<span class="fu">extract_fit_engine</span>(sI_fit))</span></code></pre></div>
<pre><code>## [1] 239799.2</code></pre>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="#cb222-1" tabindex="-1"></a><span class="fu">anova</span>(<span class="fu">extract_fit_engine</span>(s0_fit), <span class="fu">extract_fit_engine</span>(sI_fit), <span class="at">test=</span> <span class="st">&quot;Chisq&quot;</span>)</span></code></pre></div>
<pre><code>## Analysis of Deviance Table
## 
## Model 1: AVG ~ COVERAGE + FUEL + SEX + USE + FLEET + AGEPH_fac + AGEC_fac + 
##     POWER_fac + BM_fac
## Model 2: AVG ~ 1
##   Resid. Df Resid. Dev  Df Deviance Pr(&gt;Chi)  
## 1     14617      35636                        
## 2     14637      37162 -20  -1526.3  0.01278 *
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Clearly the in-sample metrics perform poorly but regarding cross
validation, the out-of-sample performance is much better. Additionally,
the anova tests, reject the hypothesis that the coefficients withdrawn
are equal to 0. Therefore, at least one of them must be important. Now
we will iteratively remove arguments to find the model with optimal
metrics. First we will remove coefficient that appear the least relevant
based on their significance. We start by removing the <em>USE</em> and
<em>FLEET</em> arguments.</p>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="#cb224-1" tabindex="-1"></a>sev3 <span class="ot">&lt;-</span> <span class="fu">recipe</span>(AVG <span class="sc">~</span> COVERAGE <span class="sc">+</span> FUEL <span class="sc">+</span> AGEPH_fac <span class="sc">+</span> SEX <span class="sc">+</span></span>
<span id="cb224-2"><a href="#cb224-2" tabindex="-1"></a>                 AGEC_fac <span class="sc">+</span> POWER_fac <span class="sc">+</span> BM_fac , <span class="at">data =</span> training_set) </span>
<span id="cb224-3"><a href="#cb224-3" tabindex="-1"></a></span>
<span id="cb224-4"><a href="#cb224-4" tabindex="-1"></a>s3_mod <span class="ot">&lt;-</span> <span class="fu">linear_reg</span>() <span class="sc">%&gt;%</span></span>
<span id="cb224-5"><a href="#cb224-5" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">&quot;glm&quot;</span>, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link =</span> <span class="st">&quot;log&quot;</span>))</span>
<span id="cb224-6"><a href="#cb224-6" tabindex="-1"></a></span>
<span id="cb224-7"><a href="#cb224-7" tabindex="-1"></a>s3_wflow <span class="ot">&lt;-</span> </span>
<span id="cb224-8"><a href="#cb224-8" tabindex="-1"></a>  <span class="fu">workflow</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb224-9"><a href="#cb224-9" tabindex="-1"></a>  <span class="fu">add_model</span>(s3_mod, <span class="at">formula =</span> AVG <span class="sc">~</span>  . ) <span class="sc">%&gt;%</span> <span class="co"># Formula of the model</span></span>
<span id="cb224-10"><a href="#cb224-10" tabindex="-1"></a>  <span class="fu">add_recipe</span>(sev3)</span>
<span id="cb224-11"><a href="#cb224-11" tabindex="-1"></a></span>
<span id="cb224-12"><a href="#cb224-12" tabindex="-1"></a>s3_fit <span class="ot">&lt;-</span> <span class="fu">fit</span>(s3_wflow, <span class="at">data =</span> training_set)</span>
<span id="cb224-13"><a href="#cb224-13" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">extract_fit_engine</span>(s3_fit))</span></code></pre></div>
<pre><code>## 
## Call:
## stats::glm(formula = AVG ~ ., family = ~Gamma(link = &quot;log&quot;), 
##     data = data)
## 
## Coefficients:
##                       Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)           7.005200   0.227615  30.777   &lt;2e-16 ***
## COVERAGEPO           -0.131453   0.131939  -0.996   0.3191    
## COVERAGEFO            0.253307   0.181073   1.399   0.1619    
## FUELgasoline          0.170644   0.119665   1.426   0.1539    
## AGEPH_fac(43.7,56.5] -0.057163   0.142672  -0.401   0.6887    
## AGEPH_fac(56.5,69.3] -0.325584   0.171400  -1.900   0.0575 .  
## AGEPH_fac(17.9,30.8] -0.201379   0.160430  -1.255   0.2094    
## AGEPH_fac(69.3,82.2] -0.049210   0.240078  -0.205   0.8376    
## AGEPH_fac(82.2,95.1]  0.007856   0.737586   0.011   0.9915    
## SEXfemale             0.093480   0.123215   0.759   0.4481    
## AGEC_fac(5,9]         0.161565   0.137868   1.172   0.2413    
## AGEC_fac(9,48]        0.244169   0.154561   1.580   0.1142    
## POWER_fac(40,48]     -0.068054   0.174404  -0.390   0.6964    
## POWER_fac(48,55]      0.080272   0.167324   0.480   0.6314    
## POWER_fac(55,66]      0.359855   0.180623   1.992   0.0464 *  
## POWER_fac(66,243]     0.032922   0.174340   0.189   0.8502    
## BM_fac(0,5]          -0.003974   0.135978  -0.029   0.9767    
## BM_fac(5,11]          0.279483   0.155744   1.794   0.0728 .  
## BM_fac(11,22]         0.310496   0.271277   1.145   0.2524    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for Gamma family taken to be 41.82092)
## 
##     Null deviance: 37162  on 14637  degrees of freedom
## Residual deviance: 35668  on 14619  degrees of freedom
## AIC: 239030
## 
## Number of Fisher Scoring iterations: 16</code></pre>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="#cb226-1" tabindex="-1"></a>resS3 <span class="ot">=</span> <span class="fu">fit_resamples</span>(s3_wflow,</span>
<span id="cb226-2"><a href="#cb226-2" tabindex="-1"></a>                    <span class="at">resamples =</span> folds,</span>
<span id="cb226-3"><a href="#cb226-3" tabindex="-1"></a>                    <span class="at">metrics =</span> <span class="fu">metric_set</span>(rmse, mae))</span>
<span id="cb226-4"><a href="#cb226-4" tabindex="-1"></a><span class="fu">collect_metrics</span>(resS3) <span class="sc">%&gt;%</span></span>
<span id="cb226-5"><a href="#cb226-5" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb226-6"><a href="#cb226-6" tabindex="-1"></a>    <span class="at">mean =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%.6f&quot;</span>, mean),</span>
<span id="cb226-7"><a href="#cb226-7" tabindex="-1"></a>    <span class="at">std_err =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%.6f&quot;</span>, std_err)</span>
<span id="cb226-8"><a href="#cb226-8" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## # A tibble: 2 × 6
##   .metric .estimator mean             n std_err     .config        
##   &lt;chr&gt;   &lt;chr&gt;      &lt;chr&gt;        &lt;int&gt; &lt;chr&gt;       &lt;chr&gt;          
## 1 mae     standard   1828.710699      5 149.589692  pre0_mod0_post0
## 2 rmse    standard   13357.968973     5 6370.692421 pre0_mod0_post0</code></pre>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb228-1"><a href="#cb228-1" tabindex="-1"></a><span class="fu">BIC</span>(<span class="fu">extract_fit_engine</span>(s3_fit))</span></code></pre></div>
<pre><code>## [1] 239182.1</code></pre>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="#cb230-1" tabindex="-1"></a><span class="fu">anova</span>(<span class="fu">extract_fit_engine</span>(s0_fit), <span class="fu">extract_fit_engine</span>(s3_fit), <span class="at">test=</span> <span class="st">&quot;Chisq&quot;</span>)</span></code></pre></div>
<pre><code>## Analysis of Deviance Table
## 
## Model 1: AVG ~ COVERAGE + FUEL + SEX + USE + FLEET + AGEPH_fac + AGEC_fac + 
##     POWER_fac + BM_fac
## Model 2: AVG ~ COVERAGE + FUEL + AGEPH_fac + SEX + AGEC_fac + POWER_fac + 
##     BM_fac
##   Resid. Df Resid. Dev Df Deviance Pr(&gt;Chi)
## 1     14617      35636                     
## 2     14619      35668 -2  -32.517   0.6766</code></pre>
<p>Unfortunately, we did not make any step forward in terms of
coefficients that are significant but the anova test shows that we
should choose the simplified model. Next, we remove <em>SEX</em>.</p>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="#cb232-1" tabindex="-1"></a>sev4 <span class="ot">&lt;-</span> <span class="fu">recipe</span>(AVG <span class="sc">~</span>  FUEL  <span class="sc">+</span> AGEPH_fac <span class="sc">+</span> COVERAGE <span class="sc">+</span></span>
<span id="cb232-2"><a href="#cb232-2" tabindex="-1"></a>                 AGEC_fac <span class="sc">+</span> POWER_fac <span class="sc">+</span> BM_fac , <span class="at">data =</span> training_set)</span>
<span id="cb232-3"><a href="#cb232-3" tabindex="-1"></a></span>
<span id="cb232-4"><a href="#cb232-4" tabindex="-1"></a>s4_mod <span class="ot">&lt;-</span> <span class="fu">linear_reg</span>() <span class="sc">%&gt;%</span></span>
<span id="cb232-5"><a href="#cb232-5" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">&quot;glm&quot;</span>, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link =</span> <span class="st">&quot;log&quot;</span>))</span>
<span id="cb232-6"><a href="#cb232-6" tabindex="-1"></a></span>
<span id="cb232-7"><a href="#cb232-7" tabindex="-1"></a>s4_wflow <span class="ot">&lt;-</span> </span>
<span id="cb232-8"><a href="#cb232-8" tabindex="-1"></a>  <span class="fu">workflow</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb232-9"><a href="#cb232-9" tabindex="-1"></a>  <span class="fu">add_model</span>(s4_mod, <span class="at">formula =</span> AVG <span class="sc">~</span> . ) <span class="sc">%&gt;%</span> <span class="co"># Formula of the model</span></span>
<span id="cb232-10"><a href="#cb232-10" tabindex="-1"></a>  <span class="fu">add_recipe</span>(sev4)</span>
<span id="cb232-11"><a href="#cb232-11" tabindex="-1"></a></span>
<span id="cb232-12"><a href="#cb232-12" tabindex="-1"></a>s4_fit <span class="ot">&lt;-</span> <span class="fu">fit</span>(s4_wflow, <span class="at">data =</span> training_set)</span>
<span id="cb232-13"><a href="#cb232-13" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">extract_fit_engine</span>(s4_fit))</span></code></pre></div>
<pre><code>## 
## Call:
## stats::glm(formula = AVG ~ ., family = ~Gamma(link = &quot;log&quot;), 
##     data = data)
## 
## Coefficients:
##                       Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)           7.043084   0.228138  30.872   &lt;2e-16 ***
## FUELgasoline          0.182972   0.120741   1.515   0.1297    
## AGEPH_fac(43.7,56.5] -0.074621   0.145219  -0.514   0.6074    
## AGEPH_fac(56.5,69.3] -0.345182   0.173956  -1.984   0.0472 *  
## AGEPH_fac(17.9,30.8] -0.221121   0.163309  -1.354   0.1758    
## AGEPH_fac(69.3,82.2] -0.076036   0.243788  -0.312   0.7551    
## AGEPH_fac(82.2,95.1] -0.028633   0.750183  -0.038   0.9696    
## COVERAGEPO           -0.130539   0.134374  -0.971   0.3313    
## COVERAGEFO            0.258403   0.184348   1.402   0.1610    
## AGEC_fac(5,9]         0.157315   0.140407   1.120   0.2626    
## AGEC_fac(9,48]        0.243075   0.157377   1.545   0.1225    
## POWER_fac(40,48]     -0.074724   0.177345  -0.421   0.6735    
## POWER_fac(48,55]      0.066096   0.169683   0.390   0.6969    
## POWER_fac(55,66]      0.358613   0.182373   1.966   0.0493 *  
## POWER_fac(66,243]     0.015645   0.174943   0.089   0.9287    
## BM_fac(0,5]          -0.004583   0.138345  -0.033   0.9736    
## BM_fac(5,11]          0.289571   0.158324   1.829   0.0674 .  
## BM_fac(11,22]         0.323456   0.276266   1.171   0.2417    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for Gamma family taken to be 43.38336)
## 
##     Null deviance: 37162  on 14637  degrees of freedom
## Residual deviance: 35691  on 14620  degrees of freedom
## AIC: 239041
## 
## Number of Fisher Scoring iterations: 13</code></pre>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="#cb234-1" tabindex="-1"></a>resS4 <span class="ot">=</span> <span class="fu">fit_resamples</span>(s4_wflow,</span>
<span id="cb234-2"><a href="#cb234-2" tabindex="-1"></a>                    <span class="at">resamples =</span> folds,</span>
<span id="cb234-3"><a href="#cb234-3" tabindex="-1"></a>                    <span class="at">metrics =</span> <span class="fu">metric_set</span>(rmse, mae))</span>
<span id="cb234-4"><a href="#cb234-4" tabindex="-1"></a><span class="fu">collect_metrics</span>(resS4) <span class="sc">%&gt;%</span></span>
<span id="cb234-5"><a href="#cb234-5" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb234-6"><a href="#cb234-6" tabindex="-1"></a>    <span class="at">mean =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%.6f&quot;</span>, mean),</span>
<span id="cb234-7"><a href="#cb234-7" tabindex="-1"></a>    <span class="at">std_err =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%.6f&quot;</span>, std_err)</span>
<span id="cb234-8"><a href="#cb234-8" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## # A tibble: 2 × 6
##   .metric .estimator mean             n std_err     .config        
##   &lt;chr&gt;   &lt;chr&gt;      &lt;chr&gt;        &lt;int&gt; &lt;chr&gt;       &lt;chr&gt;          
## 1 mae     standard   1830.281580      5 149.282387  pre0_mod0_post0
## 2 rmse    standard   13357.845795     5 6370.840714 pre0_mod0_post0</code></pre>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="#cb236-1" tabindex="-1"></a><span class="fu">BIC</span>(<span class="fu">extract_fit_engine</span>(s4_fit))</span></code></pre></div>
<pre><code>## [1] 239184.9</code></pre>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="#cb238-1" tabindex="-1"></a><span class="fu">anova</span>(<span class="fu">extract_fit_engine</span>(s0_fit), <span class="fu">extract_fit_engine</span>(s4_fit), <span class="at">test=</span> <span class="st">&quot;Chisq&quot;</span>)</span></code></pre></div>
<pre><code>## Analysis of Deviance Table
## 
## Model 1: AVG ~ COVERAGE + FUEL + SEX + USE + FLEET + AGEPH_fac + AGEC_fac + 
##     POWER_fac + BM_fac
## Model 2: AVG ~ FUEL + AGEPH_fac + COVERAGE + AGEC_fac + POWER_fac + BM_fac
##   Resid. Df Resid. Dev Df Deviance Pr(&gt;Chi)
## 1     14617      35636                     
## 2     14620      35691 -3   -55.49   0.7212</code></pre>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="#cb240-1" tabindex="-1"></a><span class="fu">anova</span>(<span class="fu">extract_fit_engine</span>(s3_fit), <span class="fu">extract_fit_engine</span>(s4_fit), <span class="at">test=</span> <span class="st">&quot;Chisq&quot;</span>)</span></code></pre></div>
<pre><code>## Analysis of Deviance Table
## 
## Model 1: AVG ~ COVERAGE + FUEL + AGEPH_fac + SEX + AGEC_fac + POWER_fac + 
##     BM_fac
## Model 2: AVG ~ FUEL + AGEPH_fac + COVERAGE + AGEC_fac + POWER_fac + BM_fac
##   Resid. Df Resid. Dev Df Deviance Pr(&gt;Chi)
## 1     14619      35668                     
## 2     14620      35691 -1  -22.973   0.4586</code></pre>
<p>It appears that removing the SEX factors make the model perform worse
than <em>sev3</em>. Instead, we will add SEX back and remove
Coverage.</p>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="#cb242-1" tabindex="-1"></a>sev5 <span class="ot">&lt;-</span> <span class="fu">recipe</span>(AVG <span class="sc">~</span> FUEL <span class="sc">+</span> SEX <span class="sc">+</span>  AGEPH_fac <span class="sc">+</span></span>
<span id="cb242-2"><a href="#cb242-2" tabindex="-1"></a>                 AGEC_fac <span class="sc">+</span> POWER_fac <span class="sc">+</span> BM_fac , <span class="at">data =</span> training_set) </span>
<span id="cb242-3"><a href="#cb242-3" tabindex="-1"></a> </span>
<span id="cb242-4"><a href="#cb242-4" tabindex="-1"></a></span>
<span id="cb242-5"><a href="#cb242-5" tabindex="-1"></a>s5_mod <span class="ot">&lt;-</span> <span class="fu">linear_reg</span>() <span class="sc">%&gt;%</span></span>
<span id="cb242-6"><a href="#cb242-6" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">&quot;glm&quot;</span>, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link =</span> <span class="st">&quot;log&quot;</span>))</span>
<span id="cb242-7"><a href="#cb242-7" tabindex="-1"></a></span>
<span id="cb242-8"><a href="#cb242-8" tabindex="-1"></a>s5_wflow <span class="ot">&lt;-</span> </span>
<span id="cb242-9"><a href="#cb242-9" tabindex="-1"></a>  <span class="fu">workflow</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb242-10"><a href="#cb242-10" tabindex="-1"></a>  <span class="fu">add_model</span>(s5_mod, <span class="at">formula =</span> AVG <span class="sc">~</span> . ) <span class="sc">%&gt;%</span> <span class="co"># Formula of the model</span></span>
<span id="cb242-11"><a href="#cb242-11" tabindex="-1"></a>  <span class="fu">add_recipe</span>(sev5)</span>
<span id="cb242-12"><a href="#cb242-12" tabindex="-1"></a></span>
<span id="cb242-13"><a href="#cb242-13" tabindex="-1"></a>s5_fit <span class="ot">&lt;-</span> <span class="fu">fit</span>(s5_wflow, <span class="at">data =</span> training_set)</span>
<span id="cb242-14"><a href="#cb242-14" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">extract_fit_engine</span>(s5_fit))</span></code></pre></div>
<pre><code>## 
## Call:
## stats::glm(formula = AVG ~ ., family = ~Gamma(link = &quot;log&quot;), 
##     data = data)
## 
## Coefficients:
##                       Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)           7.071112   0.210409  33.607   &lt;2e-16 ***
## FUELgasoline          0.155572   0.118998   1.307   0.1911    
## SEXfemale             0.101178   0.122629   0.825   0.4093    
## AGEPH_fac(43.7,56.5] -0.061065   0.142048  -0.430   0.6673    
## AGEPH_fac(56.5,69.3] -0.317372   0.170627  -1.860   0.0629 .  
## AGEPH_fac(17.9,30.8] -0.205440   0.159643  -1.287   0.1982    
## AGEPH_fac(69.3,82.2] -0.065966   0.238993  -0.276   0.7825    
## AGEPH_fac(82.2,95.1] -0.031442   0.734241  -0.043   0.9658    
## AGEC_fac(5,9]         0.083069   0.128762   0.645   0.5188    
## AGEC_fac(9,48]        0.189654   0.139380   1.361   0.1736    
## POWER_fac(40,48]     -0.078523   0.173593  -0.452   0.6510    
## POWER_fac(48,55]      0.050882   0.166532   0.306   0.7600    
## POWER_fac(55,66]      0.348092   0.179694   1.937   0.0527 .  
## POWER_fac(66,243]     0.050040   0.173190   0.289   0.7726    
## BM_fac(0,5]           0.003144   0.135375   0.023   0.9815    
## BM_fac(5,11]          0.279230   0.154706   1.805   0.0711 .  
## BM_fac(11,22]         0.259895   0.269928   0.963   0.3356    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for Gamma family taken to be 41.45841)
## 
##     Null deviance: 37162  on 14637  degrees of freedom
## Residual deviance: 35847  on 14621  degrees of freedom
## AIC: 239122
## 
## Number of Fisher Scoring iterations: 15</code></pre>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="#cb244-1" tabindex="-1"></a>resS5 <span class="ot">=</span> <span class="fu">fit_resamples</span>(s5_wflow,</span>
<span id="cb244-2"><a href="#cb244-2" tabindex="-1"></a>                    <span class="at">resamples =</span> folds,</span>
<span id="cb244-3"><a href="#cb244-3" tabindex="-1"></a>                    <span class="at">metrics =</span> <span class="fu">metric_set</span>(rmse, mae))</span>
<span id="cb244-4"><a href="#cb244-4" tabindex="-1"></a><span class="fu">collect_metrics</span>(resS5) <span class="sc">%&gt;%</span></span>
<span id="cb244-5"><a href="#cb244-5" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb244-6"><a href="#cb244-6" tabindex="-1"></a>    <span class="at">mean =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%.6f&quot;</span>, mean),</span>
<span id="cb244-7"><a href="#cb244-7" tabindex="-1"></a>    <span class="at">std_err =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%.6f&quot;</span>, std_err)</span>
<span id="cb244-8"><a href="#cb244-8" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## # A tibble: 2 × 6
##   .metric .estimator mean             n std_err     .config        
##   &lt;chr&gt;   &lt;chr&gt;      &lt;chr&gt;        &lt;int&gt; &lt;chr&gt;       &lt;chr&gt;          
## 1 mae     standard   1827.917231      5 148.884558  pre0_mod0_post0
## 2 rmse    standard   13358.627196     5 6370.636035 pre0_mod0_post0</code></pre>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="#cb246-1" tabindex="-1"></a><span class="fu">BIC</span>(<span class="fu">extract_fit_engine</span>(s5_fit))</span></code></pre></div>
<pre><code>## [1] 239258.8</code></pre>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="#cb248-1" tabindex="-1"></a><span class="fu">anova</span>(<span class="fu">extract_fit_engine</span>(s0_fit), <span class="fu">extract_fit_engine</span>(s5_fit), <span class="at">test=</span> <span class="st">&quot;Chisq&quot;</span>)</span></code></pre></div>
<pre><code>## Analysis of Deviance Table
## 
## Model 1: AVG ~ COVERAGE + FUEL + SEX + USE + FLEET + AGEPH_fac + AGEC_fac + 
##     POWER_fac + BM_fac
## Model 2: AVG ~ FUEL + SEX + AGEPH_fac + AGEC_fac + POWER_fac + BM_fac
##   Resid. Df Resid. Dev Df Deviance Pr(&gt;Chi)
## 1     14617      35636                     
## 2     14621      35847 -4     -211   0.2801</code></pre>
<p>Clearly results are worse than when we add only removed <em>SEX</em>.
Since adding and removing one coefficient at a time is heavy in
computations and fluctuates a lot without us being able to determine a
solid pattern, we will make an assumption and remove <em>COVERAGE</em>,
<em>SEX</em>, <em>FUEL</em> <em>USE</em> and <em>FLEET</em> from the
base model.</p>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb250-1"><a href="#cb250-1" tabindex="-1"></a>sev6 <span class="ot">&lt;-</span> <span class="fu">recipe</span>(AVG <span class="sc">~</span>   AGEPH_fac <span class="sc">+</span> AGEC_fac <span class="sc">+</span> POWER_fac <span class="sc">+</span> BM_fac , <span class="at">data =</span> training_set) </span>
<span id="cb250-2"><a href="#cb250-2" tabindex="-1"></a> </span>
<span id="cb250-3"><a href="#cb250-3" tabindex="-1"></a></span>
<span id="cb250-4"><a href="#cb250-4" tabindex="-1"></a>s6_mod <span class="ot">&lt;-</span> <span class="fu">linear_reg</span>() <span class="sc">%&gt;%</span></span>
<span id="cb250-5"><a href="#cb250-5" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">&quot;glm&quot;</span>, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link =</span> <span class="st">&quot;log&quot;</span>))</span>
<span id="cb250-6"><a href="#cb250-6" tabindex="-1"></a></span>
<span id="cb250-7"><a href="#cb250-7" tabindex="-1"></a>s6_wflow <span class="ot">&lt;-</span> </span>
<span id="cb250-8"><a href="#cb250-8" tabindex="-1"></a>  <span class="fu">workflow</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb250-9"><a href="#cb250-9" tabindex="-1"></a>  <span class="fu">add_model</span>(s6_mod, <span class="at">formula =</span> AVG <span class="sc">~</span> .) <span class="sc">%&gt;%</span> <span class="co"># Formula of the model</span></span>
<span id="cb250-10"><a href="#cb250-10" tabindex="-1"></a>  <span class="fu">add_recipe</span>(sev6)</span>
<span id="cb250-11"><a href="#cb250-11" tabindex="-1"></a></span>
<span id="cb250-12"><a href="#cb250-12" tabindex="-1"></a>s6_fit <span class="ot">&lt;-</span> <span class="fu">fit</span>(s6_wflow, <span class="at">data =</span> training_set)</span>
<span id="cb250-13"><a href="#cb250-13" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">extract_fit_engine</span>(s6_fit))</span></code></pre></div>
<pre><code>## 
## Call:
## stats::glm(formula = AVG ~ ., family = ~Gamma(link = &quot;log&quot;), 
##     data = data)
## 
## Coefficients:
##                       Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)           7.226341   0.203495  35.511   &lt;2e-16 ***
## AGEPH_fac(43.7,56.5] -0.087225   0.149674  -0.583   0.5601    
## AGEPH_fac(56.5,69.3] -0.327921   0.178996  -1.832   0.0670 .  
## AGEPH_fac(17.9,30.8] -0.231883   0.168191  -1.379   0.1680    
## AGEPH_fac(69.3,82.2] -0.057146   0.249277  -0.229   0.8187    
## AGEPH_fac(82.2,95.1] -0.021393   0.772328  -0.028   0.9779    
## AGEC_fac(5,9]         0.093653   0.135353   0.692   0.4890    
## AGEC_fac(9,48]        0.204000   0.146121   1.396   0.1627    
## POWER_fac(40,48]     -0.132564   0.180145  -0.736   0.4618    
## POWER_fac(48,55]      0.011564   0.173075   0.067   0.9467    
## POWER_fac(55,66]      0.347974   0.187856   1.852   0.0640 .  
## POWER_fac(66,243]     0.048383   0.179536   0.269   0.7876    
## BM_fac(0,5]          -0.006572   0.142602  -0.046   0.9632    
## BM_fac(5,11]          0.297552   0.162815   1.828   0.0676 .  
## BM_fac(11,22]         0.270857   0.284600   0.952   0.3413    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for Gamma family taken to be 46.10354)
## 
##     Null deviance: 37162  on 14637  degrees of freedom
## Residual deviance: 35956  on 14623  degrees of freedom
## AIC: 239177
## 
## Number of Fisher Scoring iterations: 13</code></pre>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb252-1"><a href="#cb252-1" tabindex="-1"></a>resS6 <span class="ot">=</span> <span class="fu">fit_resamples</span>(s6_wflow,</span>
<span id="cb252-2"><a href="#cb252-2" tabindex="-1"></a>                    <span class="at">resamples =</span> folds,</span>
<span id="cb252-3"><a href="#cb252-3" tabindex="-1"></a>                    <span class="at">metrics =</span> <span class="fu">metric_set</span>(rmse, mae))</span>
<span id="cb252-4"><a href="#cb252-4" tabindex="-1"></a><span class="fu">collect_metrics</span>(resS6) <span class="sc">%&gt;%</span></span>
<span id="cb252-5"><a href="#cb252-5" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb252-6"><a href="#cb252-6" tabindex="-1"></a>    <span class="at">mean =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%.6f&quot;</span>, mean),</span>
<span id="cb252-7"><a href="#cb252-7" tabindex="-1"></a>    <span class="at">std_err =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%.6f&quot;</span>, std_err)</span>
<span id="cb252-8"><a href="#cb252-8" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## # A tibble: 2 × 6
##   .metric .estimator mean             n std_err     .config        
##   &lt;chr&gt;   &lt;chr&gt;      &lt;chr&gt;        &lt;int&gt; &lt;chr&gt;       &lt;chr&gt;          
## 1 mae     standard   1829.212792      5 148.273730  pre0_mod0_post0
## 2 rmse    standard   13358.414291     5 6370.841257 pre0_mod0_post0</code></pre>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb254-1"><a href="#cb254-1" tabindex="-1"></a><span class="fu">BIC</span>(<span class="fu">extract_fit_engine</span>(s6_fit))</span></code></pre></div>
<pre><code>## [1] 239298.2</code></pre>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb256-1"><a href="#cb256-1" tabindex="-1"></a><span class="fu">anova</span>(<span class="fu">extract_fit_engine</span>(s0_fit), <span class="fu">extract_fit_engine</span>(s6_fit), <span class="at">test=</span> <span class="st">&quot;Chisq&quot;</span>)</span></code></pre></div>
<pre><code>## Analysis of Deviance Table
## 
## Model 1: AVG ~ COVERAGE + FUEL + SEX + USE + FLEET + AGEPH_fac + AGEC_fac + 
##     POWER_fac + BM_fac
## Model 2: AVG ~ AGEPH_fac + AGEC_fac + POWER_fac + BM_fac
##   Resid. Df Resid. Dev Df Deviance Pr(&gt;Chi)
## 1     14617      35636                     
## 2     14623      35956 -6  -320.51   0.2607</code></pre>
<p>It results a much worse model than we found before. Therefore, we
remember than in model <em>sev_3</em> we obtained the best indicators so
far with <em>USE</em> and <em>FLEET</em> being removed. We thus start
back from that model and this time we will try improving the model by
merging factors from same categories together. We merge factors with
similar estimates relative to <em>BM</em>, <em>AGEPH</em> and
<em>AGEC</em>. Intuitively, we avoid grouping estimates which have
opposite effects or which are too different from one another.</p>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb258-1"><a href="#cb258-1" tabindex="-1"></a>sev7 <span class="ot">&lt;-</span> <span class="fu">recipe</span>(AVG <span class="sc">~</span> COVERAGE <span class="sc">+</span> FUEL <span class="sc">+</span> SEX <span class="sc">+</span>  AGEPH_fac <span class="sc">+</span></span>
<span id="cb258-2"><a href="#cb258-2" tabindex="-1"></a>                 AGEC_fac <span class="sc">+</span> POWER_fac <span class="sc">+</span> BM_fac , <span class="at">data =</span> training_set) <span class="sc">%&gt;%</span></span>
<span id="cb258-3"><a href="#cb258-3" tabindex="-1"></a>  <span class="fu">step_mutate</span>(<span class="at">BM_fac =</span> forcats<span class="sc">::</span> <span class="fu">fct_collapse</span>(BM_fac,<span class="st">&quot;(5,22]&quot;</span><span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;(5,11]&quot;</span>, <span class="st">&quot;(11,22]&quot;</span>)))<span class="sc">%&gt;%</span></span>
<span id="cb258-4"><a href="#cb258-4" tabindex="-1"></a>  <span class="fu">step_mutate</span>(<span class="at">AGEPH_fac =</span> forcats<span class="sc">::</span> <span class="fu">fct_collapse</span>(AGEPH_fac,<span class="st">&quot;1&quot;</span><span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;(17.9,30.8]&quot;</span>, <span class="st">&quot;(56.5,69.3]&quot;</span>)))<span class="sc">%&gt;%</span></span>
<span id="cb258-5"><a href="#cb258-5" tabindex="-1"></a>  <span class="fu">step_mutate</span>(<span class="at">AGEPH_fac =</span> forcats<span class="sc">::</span> <span class="fu">fct_collapse</span>(AGEPH_fac,<span class="st">&quot;2&quot;</span><span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;(43.7,56.5]&quot;</span>, <span class="st">&quot;(69.3,82.2]&quot;</span>, <span class="st">&quot;(82.2,95.1]&quot;</span>)))<span class="sc">%&gt;%</span></span>
<span id="cb258-6"><a href="#cb258-6" tabindex="-1"></a>  <span class="fu">step_mutate</span>(<span class="at">AGEC_fac =</span> forcats<span class="sc">::</span> <span class="fu">fct_collapse</span>(AGEC_fac,<span class="st">&quot;(5,48]&quot;</span><span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;(5,9]&quot;</span>, <span class="st">&quot;(9,48]&quot;</span>)))</span>
<span id="cb258-7"><a href="#cb258-7" tabindex="-1"></a></span>
<span id="cb258-8"><a href="#cb258-8" tabindex="-1"></a> </span>
<span id="cb258-9"><a href="#cb258-9" tabindex="-1"></a></span>
<span id="cb258-10"><a href="#cb258-10" tabindex="-1"></a>s7_mod <span class="ot">&lt;-</span> <span class="fu">linear_reg</span>() <span class="sc">%&gt;%</span></span>
<span id="cb258-11"><a href="#cb258-11" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">&quot;glm&quot;</span>, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link =</span> <span class="st">&quot;log&quot;</span>))</span>
<span id="cb258-12"><a href="#cb258-12" tabindex="-1"></a></span>
<span id="cb258-13"><a href="#cb258-13" tabindex="-1"></a>s7_wflow <span class="ot">&lt;-</span> </span>
<span id="cb258-14"><a href="#cb258-14" tabindex="-1"></a>  <span class="fu">workflow</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb258-15"><a href="#cb258-15" tabindex="-1"></a>  <span class="fu">add_model</span>(s7_mod, <span class="at">formula =</span> AVG <span class="sc">~</span> . ) <span class="sc">%&gt;%</span> <span class="co"># Formula of the model</span></span>
<span id="cb258-16"><a href="#cb258-16" tabindex="-1"></a>  <span class="fu">add_recipe</span>(sev7)</span>
<span id="cb258-17"><a href="#cb258-17" tabindex="-1"></a></span>
<span id="cb258-18"><a href="#cb258-18" tabindex="-1"></a>s7_fit <span class="ot">&lt;-</span> <span class="fu">fit</span>(s7_wflow, <span class="at">data =</span> training_set)</span>
<span id="cb258-19"><a href="#cb258-19" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">extract_fit_engine</span>(s7_fit))</span></code></pre></div>
<pre><code>## 
## Call:
## stats::glm(formula = AVG ~ ., family = ~Gamma(link = &quot;log&quot;), 
##     data = data)
## 
## Coefficients:
##                    Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)        7.008294   0.225592  31.066   &lt;2e-16 ***
## COVERAGEPO        -0.147592   0.129806  -1.137   0.2555    
## COVERAGEFO         0.238875   0.180704   1.322   0.1862    
## FUELgasoline       0.168115   0.118873   1.414   0.1573    
## SEXfemale          0.094775   0.123072   0.770   0.4413    
## AGEPH_fac2        -0.045917   0.135550  -0.339   0.7348    
## AGEPH_fac1        -0.256827   0.134006  -1.917   0.0553 .  
## AGEC_fac(5,48]     0.191084   0.128087   1.492   0.1358    
## POWER_fac(40,48]  -0.079601   0.173904  -0.458   0.6472    
## POWER_fac(48,55]   0.071101   0.166871   0.426   0.6701    
## POWER_fac(55,66]   0.352743   0.179371   1.967   0.0493 *  
## POWER_fac(66,243]  0.014442   0.172112   0.084   0.9331    
## BM_fac(0,5]        0.005242   0.135246   0.039   0.9691    
## BM_fac(5,22]       0.328594   0.141420   2.324   0.0202 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for Gamma family taken to be 42.04202)
## 
##     Null deviance: 37162  on 14637  degrees of freedom
## Residual deviance: 35697  on 14624  degrees of freedom
## AIC: 239036
## 
## Number of Fisher Scoring iterations: 14</code></pre>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb260-1"><a href="#cb260-1" tabindex="-1"></a>resS7 <span class="ot">=</span> <span class="fu">fit_resamples</span>(s7_wflow,</span>
<span id="cb260-2"><a href="#cb260-2" tabindex="-1"></a>                    <span class="at">resamples =</span> folds,</span>
<span id="cb260-3"><a href="#cb260-3" tabindex="-1"></a>                    <span class="at">metrics =</span> <span class="fu">metric_set</span>(rmse, mae))</span>
<span id="cb260-4"><a href="#cb260-4" tabindex="-1"></a><span class="fu">collect_metrics</span>(resS7) <span class="sc">%&gt;%</span></span>
<span id="cb260-5"><a href="#cb260-5" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb260-6"><a href="#cb260-6" tabindex="-1"></a>    <span class="at">mean =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%.6f&quot;</span>, mean),</span>
<span id="cb260-7"><a href="#cb260-7" tabindex="-1"></a>    <span class="at">std_err =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%.6f&quot;</span>, std_err)</span>
<span id="cb260-8"><a href="#cb260-8" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## # A tibble: 2 × 6
##   .metric .estimator mean             n std_err     .config        
##   &lt;chr&gt;   &lt;chr&gt;      &lt;chr&gt;        &lt;int&gt; &lt;chr&gt;       &lt;chr&gt;          
## 1 mae     standard   1826.471224      5 148.096550  pre0_mod0_post0
## 2 rmse    standard   13358.292153     5 6370.133979 pre0_mod0_post0</code></pre>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb262-1"><a href="#cb262-1" tabindex="-1"></a><span class="fu">BIC</span>(<span class="fu">extract_fit_engine</span>(s7_fit))</span></code></pre></div>
<pre><code>## [1] 239149.7</code></pre>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb264-1"><a href="#cb264-1" tabindex="-1"></a><span class="fu">anova</span>(<span class="fu">extract_fit_engine</span>(s0_fit), <span class="fu">extract_fit_engine</span>(s7_fit), <span class="at">test=</span> <span class="st">&quot;Chisq&quot;</span>)</span></code></pre></div>
<pre><code>## Analysis of Deviance Table
## 
## Model 1: AVG ~ COVERAGE + FUEL + SEX + USE + FLEET + AGEPH_fac + AGEC_fac + 
##     POWER_fac + BM_fac
## Model 2: AVG ~ COVERAGE + FUEL + SEX + AGEPH_fac + AGEC_fac + POWER_fac + 
##     BM_fac
##   Resid. Df Resid. Dev Df Deviance Pr(&gt;Chi)
## 1     14617      35636                     
## 2     14624      35697 -7  -61.444   0.9831</code></pre>
<p>Here we made a leap forward in term of accuracy indicators. Indeed,
<em>sev_7</em> performs now best in terms of BIC, Anova and MAE. On the
other hand, it is slightly worse in terms of AIC, RMSE and residuals
deviance. But we tend to give more importance to the BIC and anova
tests. Additionally, now two estimates became significant, namely
vehicle with horsepower between 55 and 66 and bonus-malus levels between
5 and 22. We performed all the possible merger of categories we could do
with respect to our model. As a last resort, we will again, try to
remove some inconsistent variables. We thus try to remove <em>SEX</em>
having the highest p-value for a lone category.</p>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb266-1"><a href="#cb266-1" tabindex="-1"></a>sev8 <span class="ot">&lt;-</span> <span class="fu">recipe</span>(AVG <span class="sc">~</span> COVERAGE <span class="sc">+</span> FUEL <span class="sc">+</span>  AGEPH_fac <span class="sc">+</span></span>
<span id="cb266-2"><a href="#cb266-2" tabindex="-1"></a>                 AGEC_fac <span class="sc">+</span> POWER_fac <span class="sc">+</span> BM_fac , <span class="at">data =</span> training_set) <span class="sc">%&gt;%</span></span>
<span id="cb266-3"><a href="#cb266-3" tabindex="-1"></a>  <span class="fu">step_mutate</span>(<span class="at">BM_fac =</span> forcats<span class="sc">::</span> <span class="fu">fct_collapse</span>(BM_fac,<span class="st">&quot;(5,22]&quot;</span><span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;(5,11]&quot;</span>, <span class="st">&quot;(11,22]&quot;</span>)))<span class="sc">%&gt;%</span></span>
<span id="cb266-4"><a href="#cb266-4" tabindex="-1"></a>  <span class="fu">step_mutate</span>(<span class="at">AGEPH_fac =</span> forcats<span class="sc">::</span> <span class="fu">fct_collapse</span>(AGEPH_fac,<span class="st">&quot;1&quot;</span><span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;(17.9,30.8]&quot;</span>, <span class="st">&quot;(56.5,69.3]&quot;</span>)))<span class="sc">%&gt;%</span></span>
<span id="cb266-5"><a href="#cb266-5" tabindex="-1"></a>  <span class="fu">step_mutate</span>(<span class="at">AGEPH_fac =</span> forcats<span class="sc">::</span> <span class="fu">fct_collapse</span>(AGEPH_fac,<span class="st">&quot;2&quot;</span><span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;(43.7,56.5]&quot;</span>, <span class="st">&quot;(69.3,82.2]&quot;</span>, <span class="st">&quot;(82.2,95.1]&quot;</span>)))<span class="sc">%&gt;%</span></span>
<span id="cb266-6"><a href="#cb266-6" tabindex="-1"></a>  <span class="fu">step_mutate</span>(<span class="at">AGEC_fac =</span> forcats<span class="sc">::</span> <span class="fu">fct_collapse</span>(AGEC_fac,<span class="st">&quot;(5,48]&quot;</span><span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;(5,9]&quot;</span>, <span class="st">&quot;(9,48]&quot;</span>)))</span>
<span id="cb266-7"><a href="#cb266-7" tabindex="-1"></a></span>
<span id="cb266-8"><a href="#cb266-8" tabindex="-1"></a> </span>
<span id="cb266-9"><a href="#cb266-9" tabindex="-1"></a></span>
<span id="cb266-10"><a href="#cb266-10" tabindex="-1"></a>s8_mod <span class="ot">&lt;-</span> <span class="fu">linear_reg</span>() <span class="sc">%&gt;%</span></span>
<span id="cb266-11"><a href="#cb266-11" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">&quot;glm&quot;</span>, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link =</span> <span class="st">&quot;log&quot;</span>))</span>
<span id="cb266-12"><a href="#cb266-12" tabindex="-1"></a></span>
<span id="cb266-13"><a href="#cb266-13" tabindex="-1"></a>s8_wflow <span class="ot">&lt;-</span> </span>
<span id="cb266-14"><a href="#cb266-14" tabindex="-1"></a>  <span class="fu">workflow</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb266-15"><a href="#cb266-15" tabindex="-1"></a>  <span class="fu">add_model</span>(s8_mod, <span class="at">formula =</span> AVG <span class="sc">~</span> . ) <span class="sc">%&gt;%</span> <span class="co"># Formula of the model</span></span>
<span id="cb266-16"><a href="#cb266-16" tabindex="-1"></a>  <span class="fu">add_recipe</span>(sev8)</span>
<span id="cb266-17"><a href="#cb266-17" tabindex="-1"></a></span>
<span id="cb266-18"><a href="#cb266-18" tabindex="-1"></a>s8_fit <span class="ot">&lt;-</span> <span class="fu">fit</span>(s8_wflow, <span class="at">data =</span> training_set)</span>
<span id="cb266-19"><a href="#cb266-19" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">extract_fit_engine</span>(s8_fit))</span></code></pre></div>
<pre><code>## 
## Call:
## stats::glm(formula = AVG ~ ., family = ~Gamma(link = &quot;log&quot;), 
##     data = data)
## 
## Coefficients:
##                    Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)        7.046929   0.226531  31.108   &lt;2e-16 ***
## COVERAGEPO        -0.147068   0.132355  -1.111   0.2665    
## COVERAGEFO         0.244139   0.184176   1.326   0.1850    
## FUELgasoline       0.179825   0.120215   1.496   0.1347    
## AGEPH_fac2        -0.065610   0.137991  -0.475   0.6345    
## AGEPH_fac1        -0.276860   0.136305  -2.031   0.0423 *  
## AGEC_fac(5,48]     0.188114   0.130580   1.441   0.1497    
## POWER_fac(40,48]  -0.086839   0.177054  -0.490   0.6238    
## POWER_fac(48,55]   0.056621   0.169442   0.334   0.7383    
## POWER_fac(55,66]   0.351962   0.181399   1.940   0.0524 .  
## POWER_fac(66,243] -0.002700   0.173026  -0.016   0.9876    
## BM_fac(0,5]        0.005045   0.137710   0.037   0.9708    
## BM_fac(5,22]       0.340028   0.143699   2.366   0.0180 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for Gamma family taken to be 43.7142)
## 
##     Null deviance: 37162  on 14637  degrees of freedom
## Residual deviance: 35721  on 14625  degrees of freedom
## AIC: 239047
## 
## Number of Fisher Scoring iterations: 12</code></pre>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb268-1"><a href="#cb268-1" tabindex="-1"></a>resS8 <span class="ot">=</span> <span class="fu">fit_resamples</span>(s8_wflow,</span>
<span id="cb268-2"><a href="#cb268-2" tabindex="-1"></a>                    <span class="at">resamples =</span> folds,</span>
<span id="cb268-3"><a href="#cb268-3" tabindex="-1"></a>                    <span class="at">metrics =</span> <span class="fu">metric_set</span>(rmse, mae))</span>
<span id="cb268-4"><a href="#cb268-4" tabindex="-1"></a><span class="fu">collect_metrics</span>(resS8) <span class="sc">%&gt;%</span></span>
<span id="cb268-5"><a href="#cb268-5" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb268-6"><a href="#cb268-6" tabindex="-1"></a>    <span class="at">mean =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%.6f&quot;</span>, mean),</span>
<span id="cb268-7"><a href="#cb268-7" tabindex="-1"></a>    <span class="at">std_err =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%.6f&quot;</span>, std_err)</span>
<span id="cb268-8"><a href="#cb268-8" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## # A tibble: 2 × 6
##   .metric .estimator mean             n std_err     .config        
##   &lt;chr&gt;   &lt;chr&gt;      &lt;chr&gt;        &lt;int&gt; &lt;chr&gt;       &lt;chr&gt;          
## 1 mae     standard   1828.350343      5 147.531709  pre0_mod0_post0
## 2 rmse    standard   13358.370609     5 6370.306022 pre0_mod0_post0</code></pre>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb270-1"><a href="#cb270-1" tabindex="-1"></a><span class="fu">BIC</span>(<span class="fu">extract_fit_engine</span>(s8_fit))</span></code></pre></div>
<pre><code>## [1] 239152.9</code></pre>
<div class="sourceCode" id="cb272"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb272-1"><a href="#cb272-1" tabindex="-1"></a><span class="fu">anova</span>(<span class="fu">extract_fit_engine</span>(s0_fit), <span class="fu">extract_fit_engine</span>(s8_fit), <span class="at">test=</span> <span class="st">&quot;Chisq&quot;</span>)</span></code></pre></div>
<pre><code>## Analysis of Deviance Table
## 
## Model 1: AVG ~ COVERAGE + FUEL + SEX + USE + FLEET + AGEPH_fac + AGEC_fac + 
##     POWER_fac + BM_fac
## Model 2: AVG ~ COVERAGE + FUEL + AGEPH_fac + AGEC_fac + POWER_fac + BM_fac
##   Resid. Df Resid. Dev Df Deviance Pr(&gt;Chi)
## 1     14617      35636                     
## 2     14625      35721 -8  -85.154   0.9796</code></pre>
<p>Results only got worse, therefore we will stick with model
<em>sev_7</em> with respect to severity.</p>
<p>Let’s build a dataframe gathering all those metrics acquired with our
computation.</p>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb274-1"><a href="#cb274-1" tabindex="-1"></a>s0<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;sev0&quot;</span>, <span class="dv">239017</span>, <span class="fl">239183.8</span>, <span class="st">&quot;/&quot;</span>, <span class="fl">1829.36</span>, <span class="fl">13358.07</span>, <span class="dv">35636</span>)</span>
<span id="cb274-2"><a href="#cb274-2" tabindex="-1"></a>s1<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;sev1&quot;</span>,  <span class="dv">238624</span> , <span class="fl">238858.9</span>, <span class="fl">0.0003305</span>, <span class="fl">1845.3</span>, <span class="fl">13198.3</span>, <span class="dv">34879</span>)</span>
<span id="cb274-3"><a href="#cb274-3" tabindex="-1"></a>s2<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;sev2&quot;</span>, <span class="dv">238656</span>, <span class="fl">238853.2</span>, <span class="st">&quot;/&quot;</span> , <span class="fl">1839.46</span>, <span class="fl">13375.08</span>, <span class="dv">34956</span>)</span>
<span id="cb274-4"><a href="#cb274-4" tabindex="-1"></a>sI <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;sevI&quot;</span>, <span class="dv">239784</span>, <span class="fl">239799.2</span>, <span class="fl">0.01278</span> , <span class="fl">1806.72</span>, <span class="fl">13348.12</span>, <span class="dv">37162</span>) <span class="co">#intercept</span></span>
<span id="cb274-5"><a href="#cb274-5" tabindex="-1"></a>s3<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;sev3&quot;</span>, <span class="dv">239030</span>, <span class="fl">239182.1</span>, <span class="fl">0.6766</span>, <span class="fl">1828.71</span>, <span class="fl">13357.96</span>, <span class="dv">35668</span>) <span class="co">#remove USE and Fleet</span></span>
<span id="cb274-6"><a href="#cb274-6" tabindex="-1"></a>s4<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;sev4&quot;</span>, <span class="dv">239041</span>, <span class="fl">239184.9</span>, <span class="fl">0.7212</span>, <span class="fl">1830.28</span>, <span class="fl">13357.85</span>, <span class="dv">35691</span>) <span class="co">#remove sex</span></span>
<span id="cb274-7"><a href="#cb274-7" tabindex="-1"></a>s5<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;sev5&quot;</span>, <span class="dv">239122</span>, <span class="fl">239258.8</span>, <span class="fl">0.2801</span>, <span class="fl">1827.92</span>, <span class="fl">13358.63</span>, <span class="dv">35847</span>) <span class="co">#add sex and remove cov</span></span>
<span id="cb274-8"><a href="#cb274-8" tabindex="-1"></a>s6<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;sev6&quot;</span>, <span class="dv">239177</span>, <span class="fl">239298.2</span>, <span class="fl">0.2607</span>, <span class="fl">1829.2</span>, <span class="fl">13358.4</span>, <span class="dv">35956</span>) <span class="co">#w/o Cov, sex, use, fleet, fuel</span></span>
<span id="cb274-9"><a href="#cb274-9" tabindex="-1"></a>s7<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;sev7&quot;</span>, <span class="dv">239036</span>, <span class="fl">239149.7</span>, <span class="fl">0.9831</span>, <span class="fl">1826.47</span>, <span class="fl">13358.29</span>, <span class="dv">35697</span>) <span class="co"># merge BM, AGEPH and AGEC</span></span>
<span id="cb274-10"><a href="#cb274-10" tabindex="-1"></a>s8 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;sev8&quot;</span>, <span class="dv">239047</span>, <span class="fl">239152.9</span>, <span class="fl">0.9796</span>, <span class="fl">1828.35</span>, <span class="fl">13358.37</span>, <span class="dv">35721</span>) <span class="co"># remove SEX</span></span>
<span id="cb274-11"><a href="#cb274-11" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data =</span> <span class="fu">rbind</span>(s0, s1, s2, sI, s3, s4, s5, s6, s7, s8),<span class="at">nrow =</span> <span class="dv">10</span>, <span class="at">ncol =</span> <span class="dv">7</span>)</span>
<span id="cb274-12"><a href="#cb274-12" tabindex="-1"></a>df_sev <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(m)</span>
<span id="cb274-13"><a href="#cb274-13" tabindex="-1"></a><span class="fu">colnames</span>(df_sev) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Model&quot;</span>, <span class="st">&quot;AIC&quot;</span>, <span class="st">&quot;BIC&quot;</span>, <span class="st">&quot;Anova&quot;</span>, <span class="st">&quot;MAE&quot;</span>, <span class="st">&quot;RMSE&quot;</span>, <span class="st">&quot;Residual Deviance&quot;</span>)</span>
<span id="cb274-14"><a href="#cb274-14" tabindex="-1"></a>df_sev</span></code></pre></div>
<pre><code>##    Model    AIC      BIC     Anova     MAE     RMSE Residual Deviance
## 1   sev0 239017 239183.8         / 1829.36 13358.07             35636
## 2   sev1 238624 238858.9 0.0003305  1845.3  13198.3             34879
## 3   sev2 238656 238853.2         / 1839.46 13375.08             34956
## 4   sevI 239784 239799.2   0.01278 1806.72 13348.12             37162
## 5   sev3 239030 239182.1    0.6766 1828.71 13357.96             35668
## 6   sev4 239041 239184.9    0.7212 1830.28 13357.85             35691
## 7   sev5 239122 239258.8    0.2801 1827.92 13358.63             35847
## 8   sev6 239177 239298.2    0.2607  1829.2  13358.4             35956
## 9   sev7 239036 239149.7    0.9831 1826.47 13358.29             35697
## 10  sev8 239047 239152.9    0.9796 1828.35 13358.37             35721</code></pre>
<div id="report-results" class="section level3">
<h3>Report results</h3>
<p>Resulting from our analysis regarding the frequency (Poisson) and
severity (Gamma) models, here is what we conclude. While most main
effects, without interaction, have a significant effect on the frequency
of claims, we cannot say the same for the severity model. Indeed, most
if not all the coefficients are not considered significant. This can be
easily explained by the idea that no feature corresponding to a
policyholder or policy might indicate the severity of a claim, being
mainly circumstantial.</p>
<p>Let’s first develop the final model regarding the frequency, namely
<em>rec_8</em>. We achieve all coefficients in the model to be
significant while obtaining optimal performance indicators. They are the
following :</p>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb276-1"><a href="#cb276-1" tabindex="-1"></a>df_freq[<span class="dv">9</span>,]</span></code></pre></div>
<pre><code>##   Model    AIC      BIC  Anova       CV Residual Deviance
## 9  rec8 100289 100445.6 0.2025 0.383995             69945</code></pre>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb278-1"><a href="#cb278-1" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">extract_fit_engine</span>(m8_fit))</span></code></pre></div>
<pre><code>## 
## Call:
## stats::glm(formula = NCLAIMS ~ offset(log(EXP)) + . - EXP, family = stats::poisson, 
##     data = data)
## 
## Coefficients:
##                      Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)          -2.20643    0.03138 -70.311  &lt; 2e-16 ***
## COVERAGEAll          -0.05780    0.01747  -3.309 0.000936 ***
## FUELgasoline         -0.17352    0.01743  -9.953  &lt; 2e-16 ***
## SEXfemale             0.04263    0.01815   2.348 0.018857 *  
## FLEETY               -0.15283    0.04870  -3.138 0.001700 ** 
## AGEPH_fac(56.5,69.3] -0.21384    0.02360  -9.061  &lt; 2e-16 ***
## AGEPH_fac(17.9,30.8]  0.18384    0.02143   8.579  &lt; 2e-16 ***
## AGEPH_fac(69.3,82.2] -0.23635    0.03460  -6.831 8.44e-12 ***
## AGEC_facAll           0.04191    0.01807   2.320 0.020343 *  
## POWER_fac(40,48]      0.09078    0.02545   3.566 0.000362 ***
## POWER_fac(48,55]      0.09219    0.02447   3.767 0.000165 ***
## POWER_fac(55,66]      0.10133    0.02622   3.864 0.000112 ***
## POWER_fac(66,243]     0.20262    0.02547   7.955 1.79e-15 ***
## BM_fac(0,5]           0.22120    0.02016  10.974  &lt; 2e-16 ***
## BM_fac(5,11]          0.59481    0.02277  26.127  &lt; 2e-16 ***
## BM_fac(11,22]         0.81801    0.03904  20.951  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for poisson family taken to be 1)
## 
##     Null deviance: 71970  on 130584  degrees of freedom
## Residual deviance: 69945  on 130569  degrees of freedom
## AIC: 100289
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<p>AIC accounting from in-sample performance and out-of-sample deviance
is frequently used to assess model complexity and fit but is not the
best since it does not penalize the model for having more coefficients.
The more arguments, the more precise will the model be, even though the
additional arguments are not that relevant. BIC remedies to this issue
by penalizing the model depending on the number of arguments: <span class="math inline">\(-2ln(L) + k\times ln(N)\)</span>, where L is the
likelihood of the model, N is the number of observation in the sample
and k is the number of parameters. Besides, the anova test shows that
this simplified model is preferred to the more complex initial one. To
obtain our final model, we removed the <em>USE</em> argument and merged
<em>COVERAGE</em>, <em>AGEC</em> and <em>AGEPH</em>. Lastly, we compared
cross-validation results to evaluate model stability and predictive
performance and the model performed 3rd, but by only few <span class="math inline">\(10^{-6}\)</span> and therefore did not penalize it
regarding this indicator.</p>
<p>The Poisson GLM is estimated with the exposure as offset, so all
coefficients are interpreted as multiplicative effects on the claim
frequency, holding exposure constant and relative to their respective
reference categories.</p>
<p>The intercept corresponds to the baseline log–claim frequency for a
policyholder in all reference categories (<em>TPL</em> coverage,
<em>diesel</em> fuel, <em>male</em>, <em>non-fleet</em> use,
policyholder aged between 31 and 56 years old, car age between 0 and 5,
<em>lowest power</em> class and <em>lowest bonus–malus</em> level). The
exponential of the intercept gives the baseline (reference level)
expected claim frequency per unit of exposure, being equal to a claim
frequency of 11%. Hereunder, we define how the claim frequency evolves
with respect to particular characteristics.</p>
<p><strong>Coverage</strong> type has a statistically significant
effect: policies with PO and FO (All) coverage exhibit a lower claim
frequency than the reference coverage (TPL), with an estimated decrease
of about 5.6%. It suggests a more cautious behavior or stronger
underwriting selection. Vehicles running on <strong>gasoline</strong>
have a substantially lower expected claim frequency (around 16% less)
compared to <em>diesel</em> running vehicles, indicating a materially
safer risk profile. <strong>Female</strong> policyholders display a
slightly higher claim frequency (approximately +4.4%) compared to males,
although the magnitude of the effect remains modest despite statistical
significance. <strong>Fleet</strong> vehicles are associated with a
significantly lower claim frequency (around −14%), which may reflect
professional use, structured driving patterns or stronger risk
management.</p>
<p><strong>Policyholder age (AGEPH)</strong> shows a pronounced and
non-linear relationship with claim frequency. Compared to the reference
age group, younger drivers (17.9–30.8 years) have a significantly higher
claim frequency (approximately +20%), while older drivers (56.5–69.3 and
69.3–82.2 years) exhibit substantially lower frequencies (around −19% to
−21%). This pattern is consistent with well-documented life-cycle
effects in motor insurance risk.</p>
<p><strong>Vehicle age (AGEC)</strong> also contributes positively to
claim frequency: cars older than 5 years have an estimated increase of
about 4.3% relative to the reference group 0 to 5, indicating slightly
higher risk for older or non-baseline vehicles. <strong>Engine
power</strong> displays a clear monotonic effect: higher power classes
are associated with progressively higher claim frequencies, ranging from
roughly +9% for moderate power vehicles to more than +22% for the
highest power class, reflecting increased driving intensity or
risk-taking behavior.</p>
<p>Finally, the <strong>bonus–malus (BM)</strong> factor emerges as the
strongest predictor in the model. Relative to the level 0, higher BM
levels correspond to sharply increasing claim frequencies, with effects
ranging from approximately +25% up to more than +125% for levels between
12 and 22. This confirms the strong persistence of individual risk and
the high predictive power of past claims experience.</p>
<p>On the other hand, we dealt with the severity model which, as said in
the beginning of this section, brought up more challenge in
interpretation. Claim severity is not directly impacted by any of the
information retrieved from the different policies. As a result, no
coefficient other than the intercept were significant. We still tried to
process the model by making it as simple as it can. A model with only
the intercept was not possible due the p-value of the anova test being
lower than the 5% threshold. After numerous iteration, we obtain a
relatively optimal model with following results and coefficients.</p>
<div class="sourceCode" id="cb280"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb280-1"><a href="#cb280-1" tabindex="-1"></a>df_sev[<span class="dv">9</span>,]</span></code></pre></div>
<pre><code>##   Model    AIC      BIC  Anova     MAE     RMSE Residual Deviance
## 9  sev7 239036 239149.7 0.9831 1826.47 13358.29             35697</code></pre>
<div class="sourceCode" id="cb282"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb282-1"><a href="#cb282-1" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">extract_fit_engine</span>(s7_fit))</span></code></pre></div>
<pre><code>## 
## Call:
## stats::glm(formula = AVG ~ ., family = ~Gamma(link = &quot;log&quot;), 
##     data = data)
## 
## Coefficients:
##                    Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)        7.008294   0.225592  31.066   &lt;2e-16 ***
## COVERAGEPO        -0.147592   0.129806  -1.137   0.2555    
## COVERAGEFO         0.238875   0.180704   1.322   0.1862    
## FUELgasoline       0.168115   0.118873   1.414   0.1573    
## SEXfemale          0.094775   0.123072   0.770   0.4413    
## AGEPH_fac2        -0.045917   0.135550  -0.339   0.7348    
## AGEPH_fac1        -0.256827   0.134006  -1.917   0.0553 .  
## AGEC_fac(5,48]     0.191084   0.128087   1.492   0.1358    
## POWER_fac(40,48]  -0.079601   0.173904  -0.458   0.6472    
## POWER_fac(48,55]   0.071101   0.166871   0.426   0.6701    
## POWER_fac(55,66]   0.352743   0.179371   1.967   0.0493 *  
## POWER_fac(66,243]  0.014442   0.172112   0.084   0.9331    
## BM_fac(0,5]        0.005242   0.135246   0.039   0.9691    
## BM_fac(5,22]       0.328594   0.141420   2.324   0.0202 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for Gamma family taken to be 42.04202)
## 
##     Null deviance: 37162  on 14637  degrees of freedom
## Residual deviance: 35697  on 14624  degrees of freedom
## AIC: 239036
## 
## Number of Fisher Scoring iterations: 14</code></pre>
<p>Interestingly enough, narrowing down the coefficients did not made
them all significant, but two of them appeared to be:
<em>POWER_fac(55,66]</em> and <em>BM_fac(5,22]</em>. We could not narrow
them down further due to a noticeable increase in the performance
indicators. Removing the coefficients which were not significant only
increase indicators as well and even worsen the significance of the two
parameters. We thus decided to stick to this mixed model. Meanwhile, our
model scored best in BIC, ANOVA and MAE testing.</p>
<p>Analyzing significant coefficient is a bit less straightforward in
this case since most of them are not. The average claim amount for a
policy corresponding to the reference level has an <strong>average claim
of 1105,44</strong>. This prediction can be assumed to all the other
non-significant factors as well. But for the two significant
characteristics, we observe that vehicle with horsepower between 56 and
66 kilowatts tend to increase the severity by 42%. It is surprising that
the same effect has not been observed for even higher horsepower though.
Furthermore, for policyholders sitting between level 6 and 22 on the
bonus-malus ladder increase the severity by 39%.</p>
<p>Below, we computed insurance premiums as a function of the
policyholder’s age and its level on the bonus-malus scale. To properly
calculate the premium, we have thus fixed all other characteristics to
the reference level, knowingly a man driving a diesel car younger than 5
years old with horsepower lower than 40kw. The car is for private use
and is not part of a fleet, while being covered under Third Party policy
(TPL). Let’s recall that the insurance premium is computed with: <span class="math inline">\(Premium_i = Frequency_i \times Severity_i\)</span>
with i being the specific condition to each policyholder. We only have
one factor influencing severity, which is for policyholders in levels
higher than 5 in the bonus-malus scale with a multiplicator level equal
to <span class="math inline">\(exp(0.328594)\)</span>. Then with respect
to frequency, we add multiplicator coefficient depending on age and
level on the bonus-malus ladder.</p>
<div class="sourceCode" id="cb284"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb284-1"><a href="#cb284-1" tabindex="-1"></a><span class="co"># Reference level with BM=0 and AGEPH [31,43]</span></span>
<span id="cb284-2"><a href="#cb284-2" tabindex="-1"></a>r0 <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="fl">2.20643</span>)<span class="sc">*</span><span class="fu">exp</span>(<span class="fl">7.008294</span>)</span>
<span id="cb284-3"><a href="#cb284-3" tabindex="-1"></a></span>
<span id="cb284-4"><a href="#cb284-4" tabindex="-1"></a><span class="co"># BM = 0</span></span>
<span id="cb284-5"><a href="#cb284-5" tabindex="-1"></a>pi_11 <span class="ot">&lt;-</span> r0 <span class="sc">*</span> <span class="fu">exp</span>(<span class="fl">0.18384</span>)  <span class="co">#AGE [18,30]</span></span>
<span id="cb284-6"><a href="#cb284-6" tabindex="-1"></a>pi_12 <span class="ot">&lt;-</span> r0                 <span class="co">#AGE [31,43]</span></span>
<span id="cb284-7"><a href="#cb284-7" tabindex="-1"></a>pi_13 <span class="ot">&lt;-</span> r0                 <span class="co">#AGE [44,56]</span></span>
<span id="cb284-8"><a href="#cb284-8" tabindex="-1"></a>pi_14 <span class="ot">&lt;-</span> r0 <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.21384</span>) <span class="co">#AGE [57,69]</span></span>
<span id="cb284-9"><a href="#cb284-9" tabindex="-1"></a>pi_15 <span class="ot">&lt;-</span> r0 <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.23635</span>) <span class="co">#AGE [70,82]</span></span>
<span id="cb284-10"><a href="#cb284-10" tabindex="-1"></a>pi_16 <span class="ot">&lt;-</span> r0                 <span class="co">#AGE [83,95]</span></span>
<span id="cb284-11"><a href="#cb284-11" tabindex="-1"></a>BM0<span class="ot">&lt;-</span> <span class="fu">c</span>(pi_11, pi_12, pi_13, pi_14, pi_15, pi_16)</span>
<span id="cb284-12"><a href="#cb284-12" tabindex="-1"></a></span>
<span id="cb284-13"><a href="#cb284-13" tabindex="-1"></a><span class="co"># BM = [1,5]</span></span>
<span id="cb284-14"><a href="#cb284-14" tabindex="-1"></a>pi_21 <span class="ot">&lt;-</span> r0 <span class="sc">*</span> <span class="fu">exp</span>(<span class="fl">0.22120</span> <span class="sc">+</span> <span class="fl">0.18384</span>)  <span class="co">#AGE [18,30]</span></span>
<span id="cb284-15"><a href="#cb284-15" tabindex="-1"></a>pi_22 <span class="ot">&lt;-</span> r0 <span class="sc">*</span> <span class="fu">exp</span>(<span class="fl">0.22120</span>)            <span class="co">#AGE [31,43]</span></span>
<span id="cb284-16"><a href="#cb284-16" tabindex="-1"></a>pi_23 <span class="ot">&lt;-</span> r0 <span class="sc">*</span> <span class="fu">exp</span>(<span class="fl">0.22120</span>)            <span class="co">#AGE [44,56]</span></span>
<span id="cb284-17"><a href="#cb284-17" tabindex="-1"></a>pi_24 <span class="ot">&lt;-</span> r0 <span class="sc">*</span> <span class="fu">exp</span>(<span class="fl">0.22120</span> <span class="sc">-</span> <span class="fl">0.21384</span>)  <span class="co">#AGE [57,69]</span></span>
<span id="cb284-18"><a href="#cb284-18" tabindex="-1"></a>pi_25 <span class="ot">&lt;-</span> r0 <span class="sc">*</span> <span class="fu">exp</span>(<span class="fl">0.22120</span> <span class="sc">-</span> <span class="fl">0.23635</span>)  <span class="co">#AGE [70,82]</span></span>
<span id="cb284-19"><a href="#cb284-19" tabindex="-1"></a>pi_26 <span class="ot">&lt;-</span> r0 <span class="sc">*</span> <span class="fu">exp</span>(<span class="fl">0.22120</span>)            <span class="co">#AGE [83,95]</span></span>
<span id="cb284-20"><a href="#cb284-20" tabindex="-1"></a>BM1<span class="ot">&lt;-</span> <span class="fu">c</span>(pi_21, pi_22, pi_23, pi_24, pi_25, pi_26)</span>
<span id="cb284-21"><a href="#cb284-21" tabindex="-1"></a></span>
<span id="cb284-22"><a href="#cb284-22" tabindex="-1"></a><span class="co"># BM = [6,11]</span></span>
<span id="cb284-23"><a href="#cb284-23" tabindex="-1"></a>pi_31 <span class="ot">&lt;-</span> r0 <span class="sc">*</span> <span class="fu">exp</span>(<span class="fl">0.59481</span> <span class="sc">+</span> <span class="fl">0.18384</span>) <span class="sc">*</span> <span class="fu">exp</span>(<span class="fl">0.328594</span>)  <span class="co">#AGE [18,30]</span></span>
<span id="cb284-24"><a href="#cb284-24" tabindex="-1"></a>pi_32 <span class="ot">&lt;-</span> r0 <span class="sc">*</span> <span class="fu">exp</span>(<span class="fl">0.59481</span>) <span class="sc">*</span> <span class="fu">exp</span>(<span class="fl">0.328594</span>)            <span class="co">#AGE [31,43]</span></span>
<span id="cb284-25"><a href="#cb284-25" tabindex="-1"></a>pi_33 <span class="ot">&lt;-</span> r0 <span class="sc">*</span> <span class="fu">exp</span>(<span class="fl">0.59481</span>) <span class="sc">*</span> <span class="fu">exp</span>(<span class="fl">0.328594</span>)            <span class="co">#AGE [44,56]</span></span>
<span id="cb284-26"><a href="#cb284-26" tabindex="-1"></a>pi_34 <span class="ot">&lt;-</span> r0 <span class="sc">*</span> <span class="fu">exp</span>(<span class="fl">0.59481</span> <span class="sc">-</span> <span class="fl">0.21384</span>) <span class="sc">*</span> <span class="fu">exp</span>(<span class="fl">0.328594</span>)  <span class="co">#AGE [57,69]</span></span>
<span id="cb284-27"><a href="#cb284-27" tabindex="-1"></a>pi_35 <span class="ot">&lt;-</span> r0 <span class="sc">*</span> <span class="fu">exp</span>(<span class="fl">0.59481</span> <span class="sc">-</span> <span class="fl">0.23635</span>) <span class="sc">*</span> <span class="fu">exp</span>(<span class="fl">0.328594</span>)  <span class="co">#AGE [70,82]</span></span>
<span id="cb284-28"><a href="#cb284-28" tabindex="-1"></a>pi_36 <span class="ot">&lt;-</span> r0 <span class="sc">*</span> <span class="fu">exp</span>(<span class="fl">0.59481</span>)          <span class="sc">*</span> <span class="fu">exp</span>(<span class="fl">0.328594</span>)   <span class="co">#AGE [83,95]</span></span>
<span id="cb284-29"><a href="#cb284-29" tabindex="-1"></a>BM6<span class="ot">&lt;-</span> <span class="fu">c</span>(pi_31, pi_32, pi_33, pi_34, pi_35, pi_36)</span>
<span id="cb284-30"><a href="#cb284-30" tabindex="-1"></a></span>
<span id="cb284-31"><a href="#cb284-31" tabindex="-1"></a><span class="co"># BM = [12,22]</span></span>
<span id="cb284-32"><a href="#cb284-32" tabindex="-1"></a>pi_41 <span class="ot">&lt;-</span> r0 <span class="sc">*</span> <span class="fu">exp</span>(<span class="fl">0.81801</span> <span class="sc">+</span> <span class="fl">0.18384</span>) <span class="sc">*</span> <span class="fu">exp</span>(<span class="fl">0.328594</span>)  <span class="co">#AGE [18,30]</span></span>
<span id="cb284-33"><a href="#cb284-33" tabindex="-1"></a>pi_42 <span class="ot">&lt;-</span> r0 <span class="sc">*</span> <span class="fu">exp</span>(<span class="fl">0.81801</span>) <span class="sc">*</span> <span class="fu">exp</span>(<span class="fl">0.328594</span>)            <span class="co">#AGE [31,43]</span></span>
<span id="cb284-34"><a href="#cb284-34" tabindex="-1"></a>pi_43 <span class="ot">&lt;-</span> r0 <span class="sc">*</span> <span class="fu">exp</span>(<span class="fl">0.81801</span>) <span class="sc">*</span> <span class="fu">exp</span>(<span class="fl">0.328594</span>)            <span class="co">#AGE [44,56]</span></span>
<span id="cb284-35"><a href="#cb284-35" tabindex="-1"></a>pi_44 <span class="ot">&lt;-</span> r0 <span class="sc">*</span> <span class="fu">exp</span>(<span class="fl">0.81801</span> <span class="sc">-</span> <span class="fl">0.21384</span>) <span class="sc">*</span> <span class="fu">exp</span>(<span class="fl">0.328594</span>)  <span class="co">#AGE [57,69]</span></span>
<span id="cb284-36"><a href="#cb284-36" tabindex="-1"></a>pi_45 <span class="ot">&lt;-</span> r0 <span class="sc">*</span> <span class="fu">exp</span>(<span class="fl">0.81801</span> <span class="sc">-</span> <span class="fl">0.23635</span>) <span class="sc">*</span> <span class="fu">exp</span>(<span class="fl">0.328594</span>)  <span class="co">#AGE [70,82]</span></span>
<span id="cb284-37"><a href="#cb284-37" tabindex="-1"></a>pi_46 <span class="ot">&lt;-</span> r0 <span class="sc">*</span> <span class="fu">exp</span>(<span class="fl">0.81801</span>) <span class="sc">*</span> <span class="fu">exp</span>(<span class="fl">0.328594</span>)            <span class="co">#AGE [83,95]</span></span>
<span id="cb284-38"><a href="#cb284-38" tabindex="-1"></a>BM12<span class="ot">&lt;-</span> <span class="fu">c</span>(pi_41, pi_42, pi_43, pi_44, pi_45, pi_46)</span>
<span id="cb284-39"><a href="#cb284-39" tabindex="-1"></a></span>
<span id="cb284-40"><a href="#cb284-40" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb284-41"><a href="#cb284-41" tabindex="-1"></a></span>
<span id="cb284-42"><a href="#cb284-42" tabindex="-1"></a>age_levels <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb284-43"><a href="#cb284-43" tabindex="-1"></a>  <span class="st">&quot;[18,30]&quot;</span>, <span class="st">&quot;[31,43]&quot;</span>, <span class="st">&quot;[44,56]&quot;</span>,</span>
<span id="cb284-44"><a href="#cb284-44" tabindex="-1"></a>  <span class="st">&quot;[57,69]&quot;</span>, <span class="st">&quot;[70,82]&quot;</span>, <span class="st">&quot;[83,95]&quot;</span></span>
<span id="cb284-45"><a href="#cb284-45" tabindex="-1"></a>)</span>
<span id="cb284-46"><a href="#cb284-46" tabindex="-1"></a></span>
<span id="cb284-47"><a href="#cb284-47" tabindex="-1"></a>premium_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb284-48"><a href="#cb284-48" tabindex="-1"></a>  <span class="at">AGEPH =</span> <span class="fu">factor</span>(</span>
<span id="cb284-49"><a href="#cb284-49" tabindex="-1"></a>    <span class="fu">rep</span>(age_levels, <span class="at">times =</span> <span class="dv">4</span>),</span>
<span id="cb284-50"><a href="#cb284-50" tabindex="-1"></a>    <span class="at">levels =</span> age_levels</span>
<span id="cb284-51"><a href="#cb284-51" tabindex="-1"></a>  ),</span>
<span id="cb284-52"><a href="#cb284-52" tabindex="-1"></a>  <span class="at">Premium =</span> <span class="fu">c</span>(BM0, BM1, BM6, BM12),</span>
<span id="cb284-53"><a href="#cb284-53" tabindex="-1"></a>  <span class="at">BM =</span> <span class="fu">factor</span>(</span>
<span id="cb284-54"><a href="#cb284-54" tabindex="-1"></a>    <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;BM = 0&quot;</span>, <span class="st">&quot;BM = [1,5]&quot;</span>, <span class="st">&quot;BM = [6,11]&quot;</span>, <span class="st">&quot;BM = [12,22]&quot;</span>),</span>
<span id="cb284-55"><a href="#cb284-55" tabindex="-1"></a>        <span class="at">each =</span> <span class="fu">length</span>(age_levels))</span>
<span id="cb284-56"><a href="#cb284-56" tabindex="-1"></a>  )</span>
<span id="cb284-57"><a href="#cb284-57" tabindex="-1"></a>)</span>
<span id="cb284-58"><a href="#cb284-58" tabindex="-1"></a></span>
<span id="cb284-59"><a href="#cb284-59" tabindex="-1"></a></span>
<span id="cb284-60"><a href="#cb284-60" tabindex="-1"></a><span class="fu">ggplot</span>(premium_df,</span>
<span id="cb284-61"><a href="#cb284-61" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> AGEPH, <span class="at">y =</span> Premium, <span class="at">group =</span> BM, <span class="at">color =</span> <span class="fu">factor</span>(BM, <span class="at">levels =</span> <span class="fu">c</span>(</span>
<span id="cb284-62"><a href="#cb284-62" tabindex="-1"></a>    <span class="st">&quot;BM = 0&quot;</span>,</span>
<span id="cb284-63"><a href="#cb284-63" tabindex="-1"></a>    <span class="st">&quot;BM = [1,5]&quot;</span>,</span>
<span id="cb284-64"><a href="#cb284-64" tabindex="-1"></a>    <span class="st">&quot;BM = [6,11]&quot;</span>,</span>
<span id="cb284-65"><a href="#cb284-65" tabindex="-1"></a>    <span class="st">&quot;BM = [12,22]&quot;</span></span>
<span id="cb284-66"><a href="#cb284-66" tabindex="-1"></a>  )))) <span class="sc">+</span></span>
<span id="cb284-67"><a href="#cb284-67" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">1.1</span>) <span class="sc">+</span></span>
<span id="cb284-68"><a href="#cb284-68" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb284-69"><a href="#cb284-69" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Dark2&quot;</span>) <span class="sc">+</span></span>
<span id="cb284-70"><a href="#cb284-70" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb284-71"><a href="#cb284-71" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Policyholder age interval&quot;</span>,</span>
<span id="cb284-72"><a href="#cb284-72" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Insurance premium*&quot;</span>,</span>
<span id="cb284-73"><a href="#cb284-73" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;Bonus–Malus levels&quot;</span>,</span>
<span id="cb284-74"><a href="#cb284-74" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Insurance premium by age and Bonus–Malus level&quot;</span>,</span>
<span id="cb284-75"><a href="#cb284-75" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">&quot;*Premium expressed in euros&quot;</span></span>
<span id="cb284-76"><a href="#cb284-76" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb284-77"><a href="#cb284-77" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">13</span>) <span class="sc">+</span></span>
<span id="cb284-78"><a href="#cb284-78" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb284-79"><a href="#cb284-79" tabindex="-1"></a>    <span class="at">plot.caption =</span> <span class="fu">element_text</span>(</span>
<span id="cb284-80"><a href="#cb284-80" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">9</span>,</span>
<span id="cb284-81"><a href="#cb284-81" tabindex="-1"></a>    <span class="at">hjust =</span> <span class="dv">0</span>,     <span class="co"># left aligned</span></span>
<span id="cb284-82"><a href="#cb284-82" tabindex="-1"></a>    <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>)</span>
<span id="cb284-83"><a href="#cb284-83" tabindex="-1"></a>    ),</span>
<span id="cb284-84"><a href="#cb284-84" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;right&quot;</span>,</span>
<span id="cb284-85"><a href="#cb284-85" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">0</span>)</span>
<span id="cb284-86"><a href="#cb284-86" tabindex="-1"></a>  )<span class="sc">+</span></span>
<span id="cb284-87"><a href="#cb284-87" tabindex="-1"></a>  <span class="fu">theme_gray</span>()</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="100%" /></p>
<p>On the plot, we may observe the difference in insurance premiums
depending on the position of the policyholder on the bonus-malus scale
and with respect to his age for the reference level. It is fair to
assume than the lower in the scale you are positioned, the less risk you
represent to the insurer and the less you should pay as an insured. This
is mainly influence by the severity multiplicator that increases
massively for levels 6 to 22, which explains the huge gap in price
between the lowest and highest levels. Moreover, we observe the same
intuitive pattern we observe in the data exploration section regarding
policyholder’s age. Younger driver represent more risk and thus pay
higher premium. The older the insured the less risk it represents for
the insurer, except an upward movement for older ages, which can be
explained by more claims caused by elderlies. This plot actually gives
us a good intuition of the behavior of insurance premium regarding
bonus-malus scale and age but is a bit to extreme in the differences
among the different categories. That can be explained mainly by the
continuous variable management in GLM models. Indeed there is a need for
them to be discretized and factorized, but it is complex to find an
optimal discretization step to fully reflect the information carried by
those continuous variables. By smoothing this discretization, we could
obtain more representative and accurate pricing for each policyholders.
In the following section, we will apply GAM models as a solution to this
issue regarding continuous variables management.</p>
</div>
</div>
</div>
<div id="gam-models" class="section level1">
<h1>GAM models</h1>
<div class="sourceCode" id="cb285"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb285-1"><a href="#cb285-1" tabindex="-1"></a><span class="fu">require</span>(<span class="st">&quot;mgcv&quot;</span>)</span>
<span id="cb285-2"><a href="#cb285-2" tabindex="-1"></a><span class="fu">require</span>(<span class="st">&quot;plyr&quot;</span>)</span>
<span id="cb285-3"><a href="#cb285-3" tabindex="-1"></a><span class="fu">require</span>(<span class="st">&quot;ggplot2&quot;</span>)</span>
<span id="cb285-4"><a href="#cb285-4" tabindex="-1"></a><span class="fu">require</span>(<span class="st">&quot;gridExtra&quot;</span>)</span>
<span id="cb285-5"><a href="#cb285-5" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(<span class="st">&quot;parallel&quot;</span>)) <span class="fu">install.packages</span>(<span class="st">&quot;parallel&quot;</span>)</span>
<span id="cb285-6"><a href="#cb285-6" tabindex="-1"></a><span class="fu">require</span>(<span class="st">&quot;parallel&quot;</span>)</span>
<span id="cb285-7"><a href="#cb285-7" tabindex="-1"></a><span class="fu">require</span>(<span class="st">&quot;arrow&quot;</span>)</span>
<span id="cb285-8"><a href="#cb285-8" tabindex="-1"></a><span class="fu">require</span>(<span class="st">&quot;tidymodels&quot;</span>)</span></code></pre></div>
<p>Before getting started with GAMs, it is important to understand that
it is a model based on GLMs, which is specifically made to deal with
continuous variables. More specifically, we will use the continuous
variables used in our GLM models and will add two more, long and lat,
accounting for the longitude and latitude where the policyholder
resides. To properly include continuous variables, GAMs use a smoothing
function <em>s()</em>. As evoked, we will deal with longitude and
latitude information from each policyholder and need to include this
information into our GAM as well. To this end, we may use a bivariate
function <span class="math inline">\(f(long,lat)\)</span> to account for
the spatial metrics. There is two possible smoothing functions that
might be used for bivariate functions, s or te, but we will use <em>s(
,by=“tp”)</em> as it is more suited for for quantities measured in same
units, such as spatial effects.</p>
<div id="frequency-model-with-smoothing" class="section level2">
<h2>Frequency model with smoothing</h2>
<p>Computational time is quite extensive while dealing with gam.
Therefore, we will rely on the bam function to lower the time needed
while using recipe to fasten the process. For the sake of comparison, we
test the two different bivariate smoothing functions, namely
<em>s()</em> and <em>te()</em> to assess which one retrieves the highest
Log-likelihood result.</p>
<div class="sourceCode" id="cb286"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb286-1"><a href="#cb286-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">21</span>)</span>
<span id="cb286-2"><a href="#cb286-2" tabindex="-1"></a>in_training <span class="ot">=</span> <span class="fu">createDataPartition</span>(mtpl_be<span class="sc">$</span>NCLAIMS, <span class="at">times =</span> <span class="dv">1</span>, <span class="at">p =</span> <span class="fl">0.8</span>, <span class="at">list =</span> <span class="cn">FALSE</span>)</span>
<span id="cb286-3"><a href="#cb286-3" tabindex="-1"></a>training_set <span class="ot">=</span> mtpl_be[in_training, ]</span>
<span id="cb286-4"><a href="#cb286-4" tabindex="-1"></a>testing_set <span class="ot">=</span> mtpl_be[<span class="sc">-</span>in_training, ]</span>
<span id="cb286-5"><a href="#cb286-5" tabindex="-1"></a></span>
<span id="cb286-6"><a href="#cb286-6" tabindex="-1"></a><span class="fu">require</span>(parallel)</span>
<span id="cb286-7"><a href="#cb286-7" tabindex="-1"></a>cl <span class="ot">=</span> <span class="fu">makeCluster</span>(<span class="fu">detectCores</span>() <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb286-8"><a href="#cb286-8" tabindex="-1"></a>rec <span class="ot">&lt;-</span> <span class="fu">recipe</span>(NCLAIMS <span class="sc">~</span> POWER <span class="sc">+</span>  COVERAGE <span class="sc">+</span> FUEL<span class="sc">+</span> FLEET <span class="sc">+</span> USE <span class="sc">+</span> SEX <span class="sc">+</span> AGEPH <span class="sc">+</span> AGEC<span class="sc">+</span> BM <span class="sc">+</span> LONG <span class="sc">+</span> LAT <span class="sc">+</span> EXP, <span class="at">data =</span> training_set)<span class="sc">%&gt;%</span></span>
<span id="cb286-9"><a href="#cb286-9" tabindex="-1"></a>  <span class="fu">prep</span>()</span>
<span id="cb286-10"><a href="#cb286-10" tabindex="-1"></a></span>
<span id="cb286-11"><a href="#cb286-11" tabindex="-1"></a>m_bam <span class="ot">=</span> <span class="fu">bam</span>(NCLAIMS <span class="sc">~</span> <span class="fu">offset</span>(<span class="fu">log</span>(EXP)) <span class="sc">+</span>  COVERAGE <span class="sc">+</span> FUEL <span class="sc">+</span> FLEET <span class="sc">+</span> USE <span class="sc">+</span> SEX <span class="sc">+</span> <span class="fu">s</span>(POWER) <span class="sc">+</span> <span class="fu">s</span>(AGEC) <span class="sc">+</span> <span class="fu">s</span>(AGEPH) <span class="sc">+</span> <span class="fu">s</span>(BM) <span class="sc">+</span> <span class="fu">te</span>(LONG,LAT), <span class="at">data =</span> <span class="fu">bake</span>(rec, training_set),</span>
<span id="cb286-12"><a href="#cb286-12" tabindex="-1"></a>    <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> log), <span class="at">cluster =</span> cl)</span>
<span id="cb286-13"><a href="#cb286-13" tabindex="-1"></a><span class="fu">stopCluster</span>(cl)</span>
<span id="cb286-14"><a href="#cb286-14" tabindex="-1"></a><span class="fu">logLik.gam</span>(m_bam)</span></code></pre></div>
<pre><code>## &#39;log Lik.&#39; -49861.82 (df=48.31019)</code></pre>
<div class="sourceCode" id="cb288"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb288-1"><a href="#cb288-1" tabindex="-1"></a>cl <span class="ot">=</span> <span class="fu">makeCluster</span>(<span class="fu">detectCores</span>() <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb288-2"><a href="#cb288-2" tabindex="-1"></a>rec <span class="ot">&lt;-</span> <span class="fu">recipe</span>(NCLAIMS <span class="sc">~</span> POWER <span class="sc">+</span>  COVERAGE <span class="sc">+</span> FUEL<span class="sc">+</span> FLEET <span class="sc">+</span> USE <span class="sc">+</span> SEX <span class="sc">+</span> AGEPH <span class="sc">+</span> AGEC<span class="sc">+</span> BM <span class="sc">+</span> LONG <span class="sc">+</span> LAT <span class="sc">+</span> EXP, <span class="at">data =</span> training_set)<span class="sc">%&gt;%</span></span>
<span id="cb288-3"><a href="#cb288-3" tabindex="-1"></a>  <span class="fu">prep</span>()</span>
<span id="cb288-4"><a href="#cb288-4" tabindex="-1"></a></span>
<span id="cb288-5"><a href="#cb288-5" tabindex="-1"></a>m0_bam <span class="ot">=</span> <span class="fu">bam</span>(NCLAIMS <span class="sc">~</span> <span class="fu">offset</span>(<span class="fu">log</span>(EXP)) <span class="sc">+</span>  COVERAGE <span class="sc">+</span> FUEL <span class="sc">+</span> FLEET <span class="sc">+</span> USE <span class="sc">+</span> SEX <span class="sc">+</span> <span class="fu">s</span>(POWER) <span class="sc">+</span> <span class="fu">s</span>(AGEC) <span class="sc">+</span> <span class="fu">s</span>(AGEPH) <span class="sc">+</span> <span class="fu">s</span>(BM) <span class="sc">+</span> <span class="fu">s</span>(LONG,LAT, <span class="at">bs=</span><span class="st">&quot;tp&quot;</span>), <span class="at">data =</span> <span class="fu">bake</span>(rec, training_set),</span>
<span id="cb288-6"><a href="#cb288-6" tabindex="-1"></a>    <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> log), <span class="at">cluster =</span> cl)</span>
<span id="cb288-7"><a href="#cb288-7" tabindex="-1"></a><span class="fu">stopCluster</span>(cl)</span>
<span id="cb288-8"><a href="#cb288-8" tabindex="-1"></a></span>
<span id="cb288-9"><a href="#cb288-9" tabindex="-1"></a><span class="fu">logLik.gam</span>(m0_bam)</span></code></pre></div>
<pre><code>## &#39;log Lik.&#39; -49835.92 (df=54.16803)</code></pre>
<p>The log-likelihood is thus maximized with the smoothing function
<em>s( ,bs=“tp”)</em> and will therefore use it for our following
computations</p>
<div class="sourceCode" id="cb290"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb290-1"><a href="#cb290-1" tabindex="-1"></a><span class="fu">AIC</span>(m0_bam); <span class="fu">BIC</span>(m0_bam)</span></code></pre></div>
<pre><code>## [1] 99780.17</code></pre>
<pre><code>## [1] 100309.9</code></pre>
<div class="sourceCode" id="cb293"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb293-1"><a href="#cb293-1" tabindex="-1"></a><span class="fu">summary</span>(m0_bam)</span></code></pre></div>
<pre><code>## 
## Family: poisson 
## Link function: log 
## 
## Formula:
## NCLAIMS ~ offset(log(EXP)) + COVERAGE + FUEL + FLEET + USE + 
##     SEX + s(POWER) + s(AGEC) + s(AGEPH) + s(BM) + s(LONG, LAT, 
##     bs = &quot;tp&quot;)
## 
## Parametric coefficients:
##              Estimate Std. Error  z value Pr(&gt;|z|)    
## (Intercept)  -1.84703    0.01656 -111.530  &lt; 2e-16 ***
## COVERAGEPO   -0.10269    0.02004   -5.124 2.98e-07 ***
## COVERAGEFO   -0.10018    0.02813   -3.561  0.00037 ***
## FUELgasoline -0.20082    0.01750  -11.476  &lt; 2e-16 ***
## FLEETY       -0.14862    0.04897   -3.035  0.00241 ** 
## USEwork      -0.06392    0.03755   -1.702  0.08874 .  
## SEXfemale     0.03494    0.01823    1.916  0.05531 .  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Approximate significance of smooth terms:
##                edf Ref.df Chi.sq p-value    
## s(POWER)     2.718  3.459  67.50  &lt;2e-16 ***
## s(AGEC)      5.339  6.146  38.15  &lt;2e-16 ***
## s(AGEPH)     6.156  7.168 247.44  &lt;2e-16 ***
## s(BM)        5.417  6.434 782.89  &lt;2e-16 ***
## s(LONG,LAT) 23.243 26.933 308.87  &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## R-sq.(adj) =  0.0198   Deviance explained = 3.73%
## fREML = 1.9597e+05  Scale est. = 1         n = 130585</code></pre>
<p>At first glance, we can already observe in the summary that
continuous variables are being processed differently and that they are
all significant. Regarding discrete variables, they all appear highly
significant, except for <em>USE</em> and <em>SEX</em>. As in the
previous section regarding GLMs, we use specific performance indicator
to assess the accuracy and fit of our models. Naturally, we rely again
on the AIC and BIC, but we will reintroduce as well the cross-validation
test to properly assess the predictive performance of our GAMs. Here we
computed the k-folds cross-validation and will compare the mean of the
folds with the ones from other models. Furthermore, we include the
maximization of the log-likelihood as performance indicator as well as
the adjusted R-squared which evaluates the percentage of the model being
explained. Therefore, we aim for higher log-likelihood value and
R-squared.</p>
<div class="sourceCode" id="cb295"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb295-1"><a href="#cb295-1" tabindex="-1"></a><span class="fu">require</span>(caret)</span>
<span id="cb295-2"><a href="#cb295-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">81</span>)</span>
<span id="cb295-3"><a href="#cb295-3" tabindex="-1"></a>folds <span class="ot">=</span> <span class="fu">createFolds</span>(training_set<span class="sc">$</span>NCLAIMS, <span class="at">k =</span> <span class="dv">5</span>)</span>
<span id="cb295-4"><a href="#cb295-4" tabindex="-1"></a>res0 <span class="ot">=</span> <span class="fu">lapply</span>(folds, <span class="cf">function</span>(X) {</span>
<span id="cb295-5"><a href="#cb295-5" tabindex="-1"></a>    cl <span class="ot">=</span> <span class="fu">makeCluster</span>(<span class="fu">detectCores</span>() <span class="sc">-</span> <span class="dv">1</span>)  <span class="co"># Number of cores to use</span></span>
<span id="cb295-6"><a href="#cb295-6" tabindex="-1"></a>    m0_bam <span class="ot">=</span> <span class="fu">bam</span>(NCLAIMS <span class="sc">~</span> <span class="fu">offset</span>(<span class="fu">log</span>(EXP)) <span class="sc">+</span>  COVERAGE <span class="sc">+</span> FUEL <span class="sc">+</span> FLEET <span class="sc">+</span> USE <span class="sc">+</span> SEX <span class="sc">+</span> <span class="fu">s</span>(POWER) <span class="sc">+</span> <span class="fu">s</span>(AGEC) <span class="sc">+</span> <span class="fu">s</span>(AGEPH) <span class="sc">+</span> <span class="fu">s</span>(BM) <span class="sc">+</span> <span class="fu">s</span>(LONG,LAT, <span class="at">bs=</span><span class="st">&quot;tp&quot;</span>),</span>
<span id="cb295-7"><a href="#cb295-7" tabindex="-1"></a>        <span class="at">data =</span> <span class="fu">bake</span>(rec, training_set[<span class="sc">-</span>X, ]), <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> log), <span class="at">cluster =</span> cl)</span>
<span id="cb295-8"><a href="#cb295-8" tabindex="-1"></a>    <span class="fu">stopCluster</span>(cl)</span>
<span id="cb295-9"><a href="#cb295-9" tabindex="-1"></a>    pred <span class="ot">=</span> <span class="fu">predict</span>(m0_bam, <span class="fu">bake</span>(rec, training_set[X, ]), <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb295-10"><a href="#cb295-10" tabindex="-1"></a>    <span class="fu">sum</span>(<span class="fu">dpois</span>(<span class="at">x =</span> <span class="fu">bake</span>(rec, training_set[X, ])<span class="sc">$</span>NCLAIMS, <span class="at">lambda =</span> pred, <span class="at">log =</span> <span class="cn">TRUE</span>))</span>
<span id="cb295-11"><a href="#cb295-11" tabindex="-1"></a>})</span>
<span id="cb295-12"><a href="#cb295-12" tabindex="-1"></a>res0</span></code></pre></div>
<pre><code>## $Fold1
## [1] -9960.493
## 
## $Fold2
## [1] -9843.953
## 
## $Fold3
## [1] -10069.22
## 
## $Fold4
## [1] -10089.37
## 
## $Fold5
## [1] -9932.975</code></pre>
<div class="sourceCode" id="cb297"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb297-1"><a href="#cb297-1" tabindex="-1"></a><span class="fu">apply</span>(<span class="fu">cbind</span>(<span class="fu">unlist</span>(res0)), <span class="dv">2</span>, mean)</span></code></pre></div>
<pre><code>## [1] -9979.203</code></pre>
<p>A conclusion we can already make, based on this bam reference model
with all the variables, is that we get a lower AIC and significantly
lower BIC compared to the GLM’s. Additionally, Policyholder’s age is
widely significant in the bam while in the GLM, in was not for ages
between 44 and 56 and over 86. <em>USE</em> is not significant is both
models and finally, the <em>FO</em> coverage is significant here but was
not in GLM and the opposite for <em>SEX</em>.</p>
<p>Let’s now get rid of the USE and SEX to assess how it impacts our
model.</p>
<div class="sourceCode" id="cb299"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb299-1"><a href="#cb299-1" tabindex="-1"></a>cl <span class="ot">=</span> <span class="fu">makeCluster</span>(<span class="fu">detectCores</span>() <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb299-2"><a href="#cb299-2" tabindex="-1"></a>rec1 <span class="ot">&lt;-</span> <span class="fu">recipe</span>(NCLAIMS <span class="sc">~</span> POWER <span class="sc">+</span>  COVERAGE <span class="sc">+</span> FUEL<span class="sc">+</span> FLEET <span class="sc">+</span> AGEPH <span class="sc">+</span> AGEC<span class="sc">+</span> BM <span class="sc">+</span> LONG <span class="sc">+</span> LAT <span class="sc">+</span> EXP, <span class="at">data =</span> training_set)<span class="sc">%&gt;%</span></span>
<span id="cb299-3"><a href="#cb299-3" tabindex="-1"></a>  <span class="fu">prep</span>()</span>
<span id="cb299-4"><a href="#cb299-4" tabindex="-1"></a></span>
<span id="cb299-5"><a href="#cb299-5" tabindex="-1"></a>m1_bam <span class="ot">=</span> <span class="fu">bam</span>(NCLAIMS <span class="sc">~</span> <span class="fu">offset</span>(<span class="fu">log</span>(EXP)) <span class="sc">+</span>  COVERAGE <span class="sc">+</span> FUEL <span class="sc">+</span> FLEET  <span class="sc">+</span> <span class="fu">s</span>(POWER) <span class="sc">+</span> <span class="fu">s</span>(AGEC) <span class="sc">+</span> <span class="fu">s</span>(AGEPH) <span class="sc">+</span> <span class="fu">s</span>(BM) <span class="sc">+</span> <span class="fu">s</span>(LONG,LAT, <span class="at">bs=</span><span class="st">&quot;tp&quot;</span>), <span class="at">data =</span> <span class="fu">bake</span>(rec1, training_set),</span>
<span id="cb299-6"><a href="#cb299-6" tabindex="-1"></a>    <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> log), <span class="at">cluster =</span> cl)</span>
<span id="cb299-7"><a href="#cb299-7" tabindex="-1"></a><span class="fu">stopCluster</span>(cl)</span>
<span id="cb299-8"><a href="#cb299-8" tabindex="-1"></a><span class="fu">AIC</span>(m1_bam); <span class="fu">BIC</span>(m1_bam)</span></code></pre></div>
<pre><code>## [1] 99784.1</code></pre>
<pre><code>## [1] 100300</code></pre>
<div class="sourceCode" id="cb302"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb302-1"><a href="#cb302-1" tabindex="-1"></a><span class="fu">logLik.gam</span>(m1_bam)</span></code></pre></div>
<pre><code>## &#39;log Lik.&#39; -49839.3 (df=52.75181)</code></pre>
<div class="sourceCode" id="cb304"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb304-1"><a href="#cb304-1" tabindex="-1"></a><span class="fu">summary</span>(m1_bam)</span></code></pre></div>
<pre><code>## 
## Family: poisson 
## Link function: log 
## 
## Formula:
## NCLAIMS ~ offset(log(EXP)) + COVERAGE + FUEL + FLEET + s(POWER) + 
##     s(AGEC) + s(AGEPH) + s(BM) + s(LONG, LAT, bs = &quot;tp&quot;)
## 
## Parametric coefficients:
##              Estimate Std. Error  z value Pr(&gt;|z|)    
## (Intercept)  -1.84487    0.01613 -114.407  &lt; 2e-16 ***
## COVERAGEPO   -0.10265    0.02003   -5.124 2.99e-07 ***
## COVERAGEFO   -0.10255    0.02804   -3.657 0.000255 ***
## FUELgasoline -0.19460    0.01728  -11.263  &lt; 2e-16 ***
## FLEETY       -0.15224    0.04884   -3.117 0.001825 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Approximate significance of smooth terms:
##                edf Ref.df Chi.sq p-value    
## s(POWER)     2.590  3.303  61.68 &lt; 2e-16 ***
## s(AGEC)      5.354  6.159  38.72 3.2e-06 ***
## s(AGEPH)     6.156  7.168 257.53 &lt; 2e-16 ***
## s(BM)        5.444  6.461 789.48 &lt; 2e-16 ***
## s(LONG,LAT) 23.250 26.937 310.29 &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## R-sq.(adj) =  0.0198   Deviance explained = 3.72%
## fREML = 1.9599e+05  Scale est. = 1         n = 130585</code></pre>
<div class="sourceCode" id="cb306"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb306-1"><a href="#cb306-1" tabindex="-1"></a><span class="fu">anova</span>(m0_bam, m1_bam, <span class="at">test =</span> <span class="st">&quot;Chisq&quot;</span>)</span></code></pre></div>
<pre><code>## Analysis of Deviance Table
## 
## Model 1: NCLAIMS ~ offset(log(EXP)) + COVERAGE + FUEL + FLEET + USE + 
##     SEX + s(POWER) + s(AGEC) + s(AGEPH) + s(BM) + s(LONG, LAT, 
##     bs = &quot;tp&quot;)
## Model 2: NCLAIMS ~ offset(log(EXP)) + COVERAGE + FUEL + FLEET + s(POWER) + 
##     s(AGEC) + s(AGEPH) + s(BM) + s(LONG, LAT, bs = &quot;tp&quot;)
##   Resid. Df Resid. Dev     Df Deviance Pr(&gt;Chi)  
## 1    130524      69360                           
## 2    130525      69367 -1.448  -6.7614  0.01807 *
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>When implementing a second model without the <em>USE</em> and
<em>SEX</em> variable, we see that even though we obtain a better BIC,
the AIC, Log-likelihood perform poorer. Moreover, the anova test tells
us that at least one of the two coefficients removed has a value
different than 0. We now implement the same model but we add
<em>SEX</em> back as it is the coefficient with the lowest p-value of
the two in <em>m0_bam</em>.</p>
<div class="sourceCode" id="cb308"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb308-1"><a href="#cb308-1" tabindex="-1"></a>cl <span class="ot">=</span> <span class="fu">makeCluster</span>(<span class="fu">detectCores</span>() <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb308-2"><a href="#cb308-2" tabindex="-1"></a>rec2 <span class="ot">&lt;-</span> <span class="fu">recipe</span>(NCLAIMS <span class="sc">~</span> POWER <span class="sc">+</span>  COVERAGE <span class="sc">+</span> FUEL<span class="sc">+</span> FLEET <span class="sc">+</span> SEX <span class="sc">+</span> AGEPH <span class="sc">+</span> AGEC<span class="sc">+</span> BM <span class="sc">+</span> LONG <span class="sc">+</span> LAT <span class="sc">+</span> EXP, <span class="at">data =</span> training_set)<span class="sc">%&gt;%</span></span>
<span id="cb308-3"><a href="#cb308-3" tabindex="-1"></a>  <span class="fu">prep</span>()</span>
<span id="cb308-4"><a href="#cb308-4" tabindex="-1"></a></span>
<span id="cb308-5"><a href="#cb308-5" tabindex="-1"></a>m2_bam <span class="ot">=</span> <span class="fu">bam</span>(NCLAIMS <span class="sc">~</span> <span class="fu">offset</span>(<span class="fu">log</span>(EXP)) <span class="sc">+</span>  COVERAGE <span class="sc">+</span> FUEL <span class="sc">+</span> FLEET <span class="sc">+</span> <span class="fu">s</span>(POWER) <span class="sc">+</span> SEX <span class="sc">+</span> <span class="fu">s</span>(AGEPH) <span class="sc">+</span> <span class="fu">s</span>(BM) <span class="sc">+</span> <span class="fu">s</span>(AGEC) <span class="sc">+</span> <span class="fu">s</span>(LONG,LAT, <span class="at">bs=</span><span class="st">&quot;tp&quot;</span>), <span class="at">data =</span> <span class="fu">bake</span>(rec2, training_set),</span>
<span id="cb308-6"><a href="#cb308-6" tabindex="-1"></a>    <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> log), <span class="at">cluster =</span> cl)</span>
<span id="cb308-7"><a href="#cb308-7" tabindex="-1"></a><span class="fu">stopCluster</span>(cl)</span>
<span id="cb308-8"><a href="#cb308-8" tabindex="-1"></a><span class="fu">AIC</span>(m2_bam); <span class="fu">BIC</span>(m2_bam)</span></code></pre></div>
<pre><code>## [1] 99780.55</code></pre>
<pre><code>## [1] 100302.9</code></pre>
<div class="sourceCode" id="cb311"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb311-1"><a href="#cb311-1" tabindex="-1"></a><span class="fu">logLik.gam</span>(m2_bam)</span></code></pre></div>
<pre><code>## &#39;log Lik.&#39; -49836.87 (df=53.40711)</code></pre>
<div class="sourceCode" id="cb313"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb313-1"><a href="#cb313-1" tabindex="-1"></a><span class="fu">summary</span>(m2_bam)</span></code></pre></div>
<pre><code>## 
## Family: poisson 
## Link function: log 
## 
## Formula:
## NCLAIMS ~ offset(log(EXP)) + COVERAGE + FUEL + FLEET + s(POWER) + 
##     SEX + s(AGEPH) + s(BM) + s(AGEC) + s(LONG, LAT, bs = &quot;tp&quot;)
## 
## Parametric coefficients:
##              Estimate Std. Error  z value Pr(&gt;|z|)    
## (Intercept)  -1.85140    0.01645 -112.570  &lt; 2e-16 ***
## COVERAGEPO   -0.10329    0.02004   -5.156 2.53e-07 ***
## COVERAGEFO   -0.10380    0.02805   -3.700 0.000216 ***
## FUELgasoline -0.19792    0.01749  -11.317  &lt; 2e-16 ***
## FLEETY       -0.15464    0.04885   -3.166 0.001548 ** 
## SEXfemale     0.03523    0.01823    1.932 0.053311 .  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Approximate significance of smooth terms:
##                edf Ref.df Chi.sq  p-value    
## s(POWER)     2.949  3.733  65.65  &lt; 2e-16 ***
## s(AGEPH)     6.158  7.169 251.25  &lt; 2e-16 ***
## s(BM)        5.423  6.440 780.53  &lt; 2e-16 ***
## s(AGEC)      5.366  6.170  38.52 3.24e-06 ***
## s(LONG,LAT) 23.250 26.937 309.72  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## R-sq.(adj) =  0.0198   Deviance explained = 3.73%
## fREML = 1.9595e+05  Scale est. = 1         n = 130585</code></pre>
<div class="sourceCode" id="cb315"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb315-1"><a href="#cb315-1" tabindex="-1"></a><span class="fu">anova</span>(m0_bam, m2_bam, <span class="at">test =</span> <span class="st">&quot;Chisq&quot;</span>)</span></code></pre></div>
<pre><code>## Analysis of Deviance Table
## 
## Model 1: NCLAIMS ~ offset(log(EXP)) + COVERAGE + FUEL + FLEET + USE + 
##     SEX + s(POWER) + s(AGEC) + s(AGEPH) + s(BM) + s(LONG, LAT, 
##     bs = &quot;tp&quot;)
## Model 2: NCLAIMS ~ offset(log(EXP)) + COVERAGE + FUEL + FLEET + s(POWER) + 
##     SEX + s(AGEPH) + s(BM) + s(AGEC) + s(LONG, LAT, bs = &quot;tp&quot;)
##   Resid. Df Resid. Dev       Df Deviance Pr(&gt;Chi)
## 1    130524      69360                           
## 2    130524      69362 -0.72147  -1.8954   0.1135</code></pre>
<p>Unfortunately, putting back SEX has not made that variable
significant. The anova test shows that we can keep this simpler model
over m0_bam and BIC supports that stance. On the other hand,
Log-likelihood is not maximized and AIC is not improved.</p>
<div class="sourceCode" id="cb317"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb317-1"><a href="#cb317-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">82</span>)</span>
<span id="cb317-2"><a href="#cb317-2" tabindex="-1"></a>folds <span class="ot">=</span> <span class="fu">createFolds</span>(training_set<span class="sc">$</span>NCLAIMS, <span class="at">k =</span> <span class="dv">5</span>)</span>
<span id="cb317-3"><a href="#cb317-3" tabindex="-1"></a>res2 <span class="ot">=</span> <span class="fu">lapply</span>(folds, <span class="cf">function</span>(X) {</span>
<span id="cb317-4"><a href="#cb317-4" tabindex="-1"></a>    cl <span class="ot">=</span> <span class="fu">makeCluster</span>(<span class="fu">detectCores</span>() <span class="sc">-</span> <span class="dv">1</span>)  <span class="co"># Number of cores to use</span></span>
<span id="cb317-5"><a href="#cb317-5" tabindex="-1"></a>    m2_bam <span class="ot">=</span> <span class="fu">bam</span>(NCLAIMS <span class="sc">~</span> <span class="fu">offset</span>(<span class="fu">log</span>(EXP)) <span class="sc">+</span>  COVERAGE <span class="sc">+</span> FUEL <span class="sc">+</span> FLEET <span class="sc">+</span> <span class="fu">s</span>(POWER) <span class="sc">+</span> <span class="fu">s</span>(AGEC) <span class="sc">+</span> <span class="fu">s</span>(AGEPH) <span class="sc">+</span> <span class="fu">s</span>(BM) <span class="sc">+</span> <span class="fu">s</span>(LONG,LAT, <span class="at">bs=</span><span class="st">&quot;tp&quot;</span>),</span>
<span id="cb317-6"><a href="#cb317-6" tabindex="-1"></a>        <span class="at">data =</span> <span class="fu">bake</span>(rec2, training_set[<span class="sc">-</span>X, ]), <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> log), <span class="at">cluster =</span> cl)</span>
<span id="cb317-7"><a href="#cb317-7" tabindex="-1"></a>    <span class="fu">stopCluster</span>(cl)</span>
<span id="cb317-8"><a href="#cb317-8" tabindex="-1"></a>    pred <span class="ot">=</span> <span class="fu">predict</span>(m2_bam, <span class="fu">bake</span>(rec, training_set[X, ]), <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb317-9"><a href="#cb317-9" tabindex="-1"></a>    <span class="fu">sum</span>(<span class="fu">dpois</span>(<span class="at">x =</span> <span class="fu">bake</span>(rec2, training_set[X, ])<span class="sc">$</span>NCLAIMS, <span class="at">lambda =</span> pred, <span class="at">log =</span> <span class="cn">TRUE</span>))</span>
<span id="cb317-10"><a href="#cb317-10" tabindex="-1"></a>})</span>
<span id="cb317-11"><a href="#cb317-11" tabindex="-1"></a></span>
<span id="cb317-12"><a href="#cb317-12" tabindex="-1"></a>res2</span></code></pre></div>
<pre><code>## $Fold1
## [1] -9914.874
## 
## $Fold2
## [1] -10009.83
## 
## $Fold3
## [1] -10035.88
## 
## $Fold4
## [1] -9872.378
## 
## $Fold5
## [1] -10058.52</code></pre>
<div class="sourceCode" id="cb319"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb319-1"><a href="#cb319-1" tabindex="-1"></a><span class="fu">apply</span>(<span class="fu">cbind</span>(<span class="fu">unlist</span>(res0), <span class="fu">unlist</span>(res2)), <span class="dv">2</span>, mean)</span></code></pre></div>
<pre><code>## [1] -9979.203 -9978.296</code></pre>
<p>Cross validation results display better performance for model
<em>m2_bam</em>. Starting from here, we may explore a possible
interaction between SEX and POWER or AGE to analyze if it makes our
model more robust.</p>
<div class="sourceCode" id="cb321"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb321-1"><a href="#cb321-1" tabindex="-1"></a>cl <span class="ot">=</span> <span class="fu">makeCluster</span>(<span class="fu">detectCores</span>() <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb321-2"><a href="#cb321-2" tabindex="-1"></a>rec3 <span class="ot">&lt;-</span> <span class="fu">recipe</span>(NCLAIMS <span class="sc">~</span> POWER <span class="sc">+</span>  COVERAGE <span class="sc">+</span> FUEL<span class="sc">+</span> SEX<span class="sc">+</span> FLEET <span class="sc">+</span> AGEPH <span class="sc">+</span> AGEC<span class="sc">+</span> BM <span class="sc">+</span></span>
<span id="cb321-3"><a href="#cb321-3" tabindex="-1"></a>                 LONG <span class="sc">+</span> LAT <span class="sc">+</span> EXP, <span class="at">data =</span> training_set)<span class="sc">%&gt;%</span></span>
<span id="cb321-4"><a href="#cb321-4" tabindex="-1"></a>  <span class="fu">prep</span>()</span>
<span id="cb321-5"><a href="#cb321-5" tabindex="-1"></a> </span>
<span id="cb321-6"><a href="#cb321-6" tabindex="-1"></a>m3_bam <span class="ot">=</span> <span class="fu">bam</span>(NCLAIMS <span class="sc">~</span> <span class="fu">offset</span>(<span class="fu">log</span>(EXP)) <span class="sc">+</span>  COVERAGE <span class="sc">+</span> FUEL <span class="sc">+</span> FLEET <span class="sc">+</span> <span class="fu">s</span>(POWER) <span class="sc">+</span> <span class="fu">s</span>(AGEC) <span class="sc">+</span> <span class="fu">s</span>(AGEPH, <span class="at">by=</span>SEX) <span class="sc">+</span> <span class="fu">s</span>(BM) <span class="sc">+</span> <span class="fu">s</span>(LONG,LAT, <span class="at">bs=</span><span class="st">&quot;tp&quot;</span>), <span class="at">data =</span> <span class="fu">bake</span>(rec3, training_set),</span>
<span id="cb321-7"><a href="#cb321-7" tabindex="-1"></a>    <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> log), <span class="at">cluster =</span> cl)</span>
<span id="cb321-8"><a href="#cb321-8" tabindex="-1"></a><span class="fu">stopCluster</span>(cl)</span>
<span id="cb321-9"><a href="#cb321-9" tabindex="-1"></a><span class="fu">AIC</span>(m3_bam); <span class="fu">BIC</span>(m3_bam)</span></code></pre></div>
<pre><code>## [1] 99750.72</code></pre>
<pre><code>## [1] 100329.6</code></pre>
<div class="sourceCode" id="cb324"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb324-1"><a href="#cb324-1" tabindex="-1"></a><span class="fu">logLik.gam</span>(m3_bam)</span></code></pre></div>
<pre><code>## &#39;log Lik.&#39; -49816.17 (df=59.18993)</code></pre>
<div class="sourceCode" id="cb326"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb326-1"><a href="#cb326-1" tabindex="-1"></a><span class="fu">summary</span>(m3_bam)</span></code></pre></div>
<pre><code>## 
## Family: poisson 
## Link function: log 
## 
## Formula:
## NCLAIMS ~ offset(log(EXP)) + COVERAGE + FUEL + FLEET + s(POWER) + 
##     s(AGEC) + s(AGEPH, by = SEX) + s(BM) + s(LONG, LAT, bs = &quot;tp&quot;)
## 
## Parametric coefficients:
##              Estimate Std. Error  z value Pr(&gt;|z|)    
## (Intercept)  -1.84231    0.01605 -114.784  &lt; 2e-16 ***
## COVERAGEPO   -0.10212    0.02003   -5.098 3.43e-07 ***
## COVERAGEFO   -0.10188    0.02803   -3.634 0.000279 ***
## FUELgasoline -0.19497    0.01714  -11.374  &lt; 2e-16 ***
## FLEETY       -0.15092    0.04884   -3.090 0.002003 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Approximate significance of smooth terms:
##                       edf Ref.df Chi.sq  p-value    
## s(POWER)            1.469  1.823  55.66  &lt; 2e-16 ***
## s(AGEC)             5.339  6.145  39.37 2.92e-06 ***
## s(AGEPH):SEXmale    6.195  7.209 286.06  &lt; 2e-16 ***
## s(AGEPH):SEXfemale  4.659  5.661  37.40 3.61e-06 ***
## s(BM)               5.417  6.433 777.12  &lt; 2e-16 ***
## s(LONG,LAT)        23.220 26.918 310.94  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## R-sq.(adj) =  0.0202   Deviance explained = 3.78%
## fREML = 1.9602e+05  Scale est. = 1         n = 130585</code></pre>
<div class="sourceCode" id="cb328"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb328-1"><a href="#cb328-1" tabindex="-1"></a><span class="fu">anova</span>(m0_bam, m3_bam, <span class="at">test =</span> <span class="st">&quot;Chisq&quot;</span>)</span></code></pre></div>
<pre><code>## Analysis of Deviance Table
## 
## Model 1: NCLAIMS ~ offset(log(EXP)) + COVERAGE + FUEL + FLEET + USE + 
##     SEX + s(POWER) + s(AGEC) + s(AGEPH) + s(BM) + s(LONG, LAT, 
##     bs = &quot;tp&quot;)
## Model 2: NCLAIMS ~ offset(log(EXP)) + COVERAGE + FUEL + FLEET + s(POWER) + 
##     s(AGEC) + s(AGEPH, by = SEX) + s(BM) + s(LONG, LAT, bs = &quot;tp&quot;)
##   Resid. Df Resid. Dev    Df Deviance  Pr(&gt;Chi)    
## 1    130524      69360                             
## 2    130518      69320 5.647     39.5 3.908e-07 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb330"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb330-1"><a href="#cb330-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">82</span>)</span>
<span id="cb330-2"><a href="#cb330-2" tabindex="-1"></a>folds <span class="ot">=</span> <span class="fu">createFolds</span>(training_set<span class="sc">$</span>NCLAIMS, <span class="at">k =</span> <span class="dv">5</span>)</span>
<span id="cb330-3"><a href="#cb330-3" tabindex="-1"></a>res3 <span class="ot">=</span> <span class="fu">lapply</span>(folds, <span class="cf">function</span>(X) {</span>
<span id="cb330-4"><a href="#cb330-4" tabindex="-1"></a>    cl <span class="ot">=</span> <span class="fu">makeCluster</span>(<span class="fu">detectCores</span>() <span class="sc">-</span> <span class="dv">1</span>)  <span class="co"># Number of cores to use</span></span>
<span id="cb330-5"><a href="#cb330-5" tabindex="-1"></a>    m3_bam <span class="ot">=</span> <span class="fu">bam</span>(NCLAIMS <span class="sc">~</span> <span class="fu">offset</span>(<span class="fu">log</span>(EXP)) <span class="sc">+</span>  COVERAGE <span class="sc">+</span> FUEL <span class="sc">+</span> FLEET <span class="sc">+</span> <span class="fu">s</span>(POWER) <span class="sc">+</span></span>
<span id="cb330-6"><a href="#cb330-6" tabindex="-1"></a>                   <span class="fu">s</span>(AGEC) <span class="sc">+</span> <span class="fu">s</span>(AGEPH, <span class="at">by=</span>SEX) <span class="sc">+</span> <span class="fu">s</span>(BM) <span class="sc">+</span> <span class="fu">s</span>(LONG,LAT, <span class="at">bs=</span><span class="st">&quot;tp&quot;</span>),</span>
<span id="cb330-7"><a href="#cb330-7" tabindex="-1"></a>        <span class="at">data =</span> <span class="fu">bake</span>(rec3, training_set[<span class="sc">-</span>X, ]), <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> log), <span class="at">cluster =</span> cl)</span>
<span id="cb330-8"><a href="#cb330-8" tabindex="-1"></a>    <span class="fu">stopCluster</span>(cl)</span>
<span id="cb330-9"><a href="#cb330-9" tabindex="-1"></a>    pred <span class="ot">=</span> <span class="fu">predict</span>(m3_bam, <span class="fu">bake</span>(rec, training_set[X, ]), <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb330-10"><a href="#cb330-10" tabindex="-1"></a>    <span class="fu">sum</span>(<span class="fu">dpois</span>(<span class="at">x =</span> <span class="fu">bake</span>(rec3, training_set[X, ])<span class="sc">$</span>NCLAIMS, <span class="at">lambda =</span> pred, <span class="at">log =</span> <span class="cn">TRUE</span>))</span>
<span id="cb330-11"><a href="#cb330-11" tabindex="-1"></a>})</span>
<span id="cb330-12"><a href="#cb330-12" tabindex="-1"></a></span>
<span id="cb330-13"><a href="#cb330-13" tabindex="-1"></a>res3</span></code></pre></div>
<pre><code>## $Fold1
## [1] -9911.179
## 
## $Fold2
## [1] -10011.39
## 
## $Fold3
## [1] -10035.68
## 
## $Fold4
## [1] -9866.599
## 
## $Fold5
## [1] -10050.05</code></pre>
<div class="sourceCode" id="cb332"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb332-1"><a href="#cb332-1" tabindex="-1"></a><span class="fu">apply</span>(<span class="fu">cbind</span>(<span class="fu">unlist</span>(res0), <span class="fu">unlist</span>(res3)), <span class="dv">2</span>, mean)</span></code></pre></div>
<pre><code>## [1] -9979.203 -9974.980</code></pre>
<p>Now we compare with the interaction between SEX and POWER</p>
<div class="sourceCode" id="cb334"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb334-1"><a href="#cb334-1" tabindex="-1"></a>cl <span class="ot">=</span> <span class="fu">makeCluster</span>(<span class="fu">detectCores</span>() <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb334-2"><a href="#cb334-2" tabindex="-1"></a>rec4 <span class="ot">&lt;-</span> <span class="fu">recipe</span>(NCLAIMS <span class="sc">~</span> POWER <span class="sc">+</span>  COVERAGE <span class="sc">+</span> FUEL<span class="sc">+</span> SEX<span class="sc">+</span> FLEET <span class="sc">+</span> AGEPH <span class="sc">+</span> AGEC<span class="sc">+</span> BM <span class="sc">+</span></span>
<span id="cb334-3"><a href="#cb334-3" tabindex="-1"></a>                 LONG <span class="sc">+</span> LAT <span class="sc">+</span> EXP, <span class="at">data =</span> training_set)<span class="sc">%&gt;%</span></span>
<span id="cb334-4"><a href="#cb334-4" tabindex="-1"></a>  <span class="fu">prep</span>()</span>
<span id="cb334-5"><a href="#cb334-5" tabindex="-1"></a> </span>
<span id="cb334-6"><a href="#cb334-6" tabindex="-1"></a>m4_bam <span class="ot">=</span> <span class="fu">bam</span>(NCLAIMS <span class="sc">~</span> <span class="fu">offset</span>(<span class="fu">log</span>(EXP)) <span class="sc">+</span>  COVERAGE <span class="sc">+</span> FUEL <span class="sc">+</span> FLEET <span class="sc">+</span> <span class="fu">s</span>(POWER, <span class="at">by=</span>SEX) <span class="sc">+</span> <span class="fu">s</span>(AGEC) <span class="sc">+</span> <span class="fu">s</span>(AGEPH) <span class="sc">+</span> <span class="fu">s</span>(BM) <span class="sc">+</span> <span class="fu">s</span>(LONG,LAT, <span class="at">bs=</span><span class="st">&quot;tp&quot;</span>), </span>
<span id="cb334-7"><a href="#cb334-7" tabindex="-1"></a>             <span class="at">data =</span> <span class="fu">bake</span>(rec4, training_set),</span>
<span id="cb334-8"><a href="#cb334-8" tabindex="-1"></a>    <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> log), <span class="at">cluster =</span> cl)</span>
<span id="cb334-9"><a href="#cb334-9" tabindex="-1"></a><span class="fu">stopCluster</span>(cl)</span>
<span id="cb334-10"><a href="#cb334-10" tabindex="-1"></a><span class="fu">AIC</span>(m4_bam); <span class="fu">BIC</span>(m4_bam)</span></code></pre></div>
<pre><code>## [1] 99767.38</code></pre>
<pre><code>## [1] 100267.5</code></pre>
<div class="sourceCode" id="cb337"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb337-1"><a href="#cb337-1" tabindex="-1"></a><span class="fu">logLik.gam</span>(m4_bam)</span></code></pre></div>
<pre><code>## &#39;log Lik.&#39; -49832.55 (df=51.13644)</code></pre>
<div class="sourceCode" id="cb339"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb339-1"><a href="#cb339-1" tabindex="-1"></a><span class="fu">summary</span>(m4_bam)</span></code></pre></div>
<pre><code>## 
## Family: poisson 
## Link function: log 
## 
## Formula:
## NCLAIMS ~ offset(log(EXP)) + COVERAGE + FUEL + FLEET + s(POWER, 
##     by = SEX) + s(AGEC) + s(AGEPH) + s(BM) + s(LONG, LAT, bs = &quot;tp&quot;)
## 
## Parametric coefficients:
##              Estimate Std. Error  z value Pr(&gt;|z|)    
## (Intercept)  -1.84291    0.01603 -114.949  &lt; 2e-16 ***
## COVERAGEPO   -0.10197    0.02003   -5.090 3.57e-07 ***
## COVERAGEFO   -0.10158    0.02804   -3.622 0.000292 ***
## FUELgasoline -0.19030    0.01720  -11.067  &lt; 2e-16 ***
## FLEETY       -0.15191    0.04884   -3.111 0.001867 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Approximate significance of smooth terms:
##                       edf Ref.df Chi.sq  p-value    
## s(POWER):SEXmale    1.003  1.005  24.16 9.85e-07 ***
## s(POWER):SEXfemale  2.503  3.181  52.75  &lt; 2e-16 ***
## s(AGEC)             5.339  6.145  39.03  &lt; 2e-16 ***
## s(AGEPH)            6.156  7.168 262.10  &lt; 2e-16 ***
## s(BM)               5.444  6.460 791.97  &lt; 2e-16 ***
## s(LONG,LAT)        23.240 26.931 310.78  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## R-sq.(adj) =   0.02   Deviance explained = 3.74%
## fREML = 1.9598e+05  Scale est. = 1         n = 130585</code></pre>
<div class="sourceCode" id="cb341"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb341-1"><a href="#cb341-1" tabindex="-1"></a><span class="fu">anova</span>(m0_bam, m4_bam, <span class="at">test =</span> <span class="st">&quot;Chisq&quot;</span>)</span></code></pre></div>
<pre><code>## Analysis of Deviance Table
## 
## Model 1: NCLAIMS ~ offset(log(EXP)) + COVERAGE + FUEL + FLEET + USE + 
##     SEX + s(POWER) + s(AGEC) + s(AGEPH) + s(BM) + s(LONG, LAT, 
##     bs = &quot;tp&quot;)
## Model 2: NCLAIMS ~ offset(log(EXP)) + COVERAGE + FUEL + FLEET + s(POWER, 
##     by = SEX) + s(AGEC) + s(AGEPH) + s(BM) + s(LONG, LAT, bs = &quot;tp&quot;)
##   Resid. Df Resid. Dev      Df Deviance Pr(&gt;Chi)
## 1    130524      69360                          
## 2    130527      69353 -3.0908   6.7354</code></pre>
<div class="sourceCode" id="cb343"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb343-1"><a href="#cb343-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">82</span>)</span>
<span id="cb343-2"><a href="#cb343-2" tabindex="-1"></a>folds <span class="ot">=</span> <span class="fu">createFolds</span>(training_set<span class="sc">$</span>NCLAIMS, <span class="at">k =</span> <span class="dv">5</span>)</span>
<span id="cb343-3"><a href="#cb343-3" tabindex="-1"></a>res4 <span class="ot">=</span> <span class="fu">lapply</span>(folds, <span class="cf">function</span>(X) {</span>
<span id="cb343-4"><a href="#cb343-4" tabindex="-1"></a>    cl <span class="ot">=</span> <span class="fu">makeCluster</span>(<span class="fu">detectCores</span>() <span class="sc">-</span> <span class="dv">1</span>)  <span class="co"># Number of cores to use</span></span>
<span id="cb343-5"><a href="#cb343-5" tabindex="-1"></a>    m4_bam <span class="ot">=</span> <span class="fu">bam</span>(NCLAIMS <span class="sc">~</span> <span class="fu">offset</span>(<span class="fu">log</span>(EXP)) <span class="sc">+</span>  COVERAGE <span class="sc">+</span> FUEL <span class="sc">+</span> FLEET <span class="sc">+</span> <span class="fu">s</span>(POWER, <span class="at">by=</span>SEX)</span>
<span id="cb343-6"><a href="#cb343-6" tabindex="-1"></a>                 <span class="sc">+</span> <span class="fu">s</span>(AGEC) <span class="sc">+</span> <span class="fu">s</span>(AGEPH) <span class="sc">+</span> <span class="fu">s</span>(BM) <span class="sc">+</span> <span class="fu">s</span>(LONG,LAT, <span class="at">bs=</span><span class="st">&quot;tp&quot;</span>),</span>
<span id="cb343-7"><a href="#cb343-7" tabindex="-1"></a>        <span class="at">data =</span> <span class="fu">bake</span>(rec4, training_set[<span class="sc">-</span>X, ]), <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> log), <span class="at">cluster =</span> cl)</span>
<span id="cb343-8"><a href="#cb343-8" tabindex="-1"></a>    <span class="fu">stopCluster</span>(cl)</span>
<span id="cb343-9"><a href="#cb343-9" tabindex="-1"></a>    pred <span class="ot">=</span> <span class="fu">predict</span>(m4_bam, <span class="fu">bake</span>(rec, training_set[X, ]), <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb343-10"><a href="#cb343-10" tabindex="-1"></a>    <span class="fu">sum</span>(<span class="fu">dpois</span>(<span class="at">x =</span> <span class="fu">bake</span>(rec4, training_set[X, ])<span class="sc">$</span>NCLAIMS, <span class="at">lambda =</span> pred, <span class="at">log =</span> <span class="cn">TRUE</span>))</span>
<span id="cb343-11"><a href="#cb343-11" tabindex="-1"></a>})</span>
<span id="cb343-12"><a href="#cb343-12" tabindex="-1"></a></span>
<span id="cb343-13"><a href="#cb343-13" tabindex="-1"></a>res4</span></code></pre></div>
<pre><code>## $Fold1
## [1] -9915.723
## 
## $Fold2
## [1] -10008.46
## 
## $Fold3
## [1] -10032.98
## 
## $Fold4
## [1] -9872.978
## 
## $Fold5
## [1] -10056.47</code></pre>
<div class="sourceCode" id="cb345"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb345-1"><a href="#cb345-1" tabindex="-1"></a><span class="fu">apply</span>(<span class="fu">cbind</span>(<span class="fu">unlist</span>(res0), <span class="fu">unlist</span>(res4)), <span class="dv">2</span>, mean)</span></code></pre></div>
<pre><code>## [1] -9979.203 -9977.323</code></pre>
<p>We find ourselves in an uneasy situation since the interaction
between SEX and Age performs better in all aspects, except for a much
poorer performance in terms of BIC. But we conclude that although the
BIC is higher, the AIC suggests that <em>m3_bam</em> has additional
parameters that genuinely improve fit beyond just adding complexity.</p>
<p>let’s now merge the coefficients from Coverage taking approximately
the same value to simplify our model.</p>
<div class="sourceCode" id="cb347"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb347-1"><a href="#cb347-1" tabindex="-1"></a>cl <span class="ot">=</span> <span class="fu">makeCluster</span>(<span class="fu">detectCores</span>() <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb347-2"><a href="#cb347-2" tabindex="-1"></a>rec5 <span class="ot">&lt;-</span> <span class="fu">recipe</span>(NCLAIMS <span class="sc">~</span> POWER <span class="sc">+</span>  COVERAGE <span class="sc">+</span> FUEL<span class="sc">+</span> SEX <span class="sc">+</span> FLEET <span class="sc">+</span> AGEPH <span class="sc">+</span> AGEC<span class="sc">+</span> BM <span class="sc">+</span> LONG</span>
<span id="cb347-3"><a href="#cb347-3" tabindex="-1"></a>               <span class="sc">+</span> LAT <span class="sc">+</span> EXP, <span class="at">data =</span> training_set)<span class="sc">%&gt;%</span></span>
<span id="cb347-4"><a href="#cb347-4" tabindex="-1"></a>  <span class="fu">step_mutate</span>(<span class="at">COVERAGE =</span> forcats<span class="sc">::</span><span class="fu">fct_collapse</span>(COVERAGE, <span class="st">&quot;(PO,FO)&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;PO&quot;</span>,<span class="st">&quot;FO&quot;</span>)))<span class="sc">%&gt;%</span></span>
<span id="cb347-5"><a href="#cb347-5" tabindex="-1"></a>  <span class="fu">prep</span>()</span>
<span id="cb347-6"><a href="#cb347-6" tabindex="-1"></a> </span>
<span id="cb347-7"><a href="#cb347-7" tabindex="-1"></a>m5_bam <span class="ot">=</span> <span class="fu">bam</span>(NCLAIMS <span class="sc">~</span> <span class="fu">offset</span>(<span class="fu">log</span>(EXP)) <span class="sc">+</span>  COVERAGE <span class="sc">+</span> FUEL <span class="sc">+</span> FLEET <span class="sc">+</span> <span class="fu">s</span>(POWER) <span class="sc">+</span></span>
<span id="cb347-8"><a href="#cb347-8" tabindex="-1"></a>               <span class="fu">s</span>(AGEC) <span class="sc">+</span> <span class="fu">s</span>(AGEPH, <span class="at">by=</span>SEX) <span class="sc">+</span> <span class="fu">s</span>(BM) <span class="sc">+</span> <span class="fu">s</span>(LONG,LAT, <span class="at">bs=</span><span class="st">&quot;tp&quot;</span>),</span>
<span id="cb347-9"><a href="#cb347-9" tabindex="-1"></a>             <span class="at">data =</span> <span class="fu">bake</span>(rec5, training_set), <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> log), <span class="at">cluster =</span> cl)</span>
<span id="cb347-10"><a href="#cb347-10" tabindex="-1"></a><span class="fu">stopCluster</span>(cl)</span>
<span id="cb347-11"><a href="#cb347-11" tabindex="-1"></a><span class="fu">AIC</span>(m5_bam); <span class="fu">BIC</span>(m5_bam)</span></code></pre></div>
<pre><code>## [1] 99748.73</code></pre>
<pre><code>## [1] 100318</code></pre>
<div class="sourceCode" id="cb350"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb350-1"><a href="#cb350-1" tabindex="-1"></a><span class="fu">logLik.gam</span>(m5_bam)</span></code></pre></div>
<pre><code>## &#39;log Lik.&#39; -49816.16 (df=58.20502)</code></pre>
<div class="sourceCode" id="cb352"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb352-1"><a href="#cb352-1" tabindex="-1"></a><span class="fu">summary</span>(m5_bam)</span></code></pre></div>
<pre><code>## 
## Family: poisson 
## Link function: log 
## 
## Formula:
## NCLAIMS ~ offset(log(EXP)) + COVERAGE + FUEL + FLEET + s(POWER) + 
##     s(AGEC) + s(AGEPH, by = SEX) + s(BM) + s(LONG, LAT, bs = &quot;tp&quot;)
## 
## Parametric coefficients:
##                 Estimate Std. Error  z value Pr(&gt;|z|)    
## (Intercept)     -1.84233    0.01601 -115.093  &lt; 2e-16 ***
## COVERAGE(PO,FO) -0.10206    0.01859   -5.489 4.04e-08 ***
## FUELgasoline    -0.19495    0.01713  -11.380  &lt; 2e-16 ***
## FLEETY          -0.15090    0.04880   -3.092  0.00199 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Approximate significance of smooth terms:
##                       edf Ref.df Chi.sq  p-value    
## s(POWER)            1.480  1.840  55.88  &lt; 2e-16 ***
## s(AGEC)             5.340  6.144  39.54 2.88e-06 ***
## s(AGEPH):SEXmale    6.195  7.209 286.07  &lt; 2e-16 ***
## s(AGEPH):SEXfemale  4.658  5.660  37.39 3.61e-06 ***
## s(BM)               5.417  6.433 777.24  &lt; 2e-16 ***
## s(LONG,LAT)        23.220 26.918 310.99  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## R-sq.(adj) =  0.0202   Deviance explained = 3.78%
## fREML = 1.9602e+05  Scale est. = 1         n = 130585</code></pre>
<div class="sourceCode" id="cb354"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb354-1"><a href="#cb354-1" tabindex="-1"></a><span class="fu">anova</span>(m0_bam, m5_bam, <span class="at">test =</span> <span class="st">&quot;Chisq&quot;</span>)</span></code></pre></div>
<pre><code>## Analysis of Deviance Table
## 
## Model 1: NCLAIMS ~ offset(log(EXP)) + COVERAGE + FUEL + FLEET + USE + 
##     SEX + s(POWER) + s(AGEC) + s(AGEPH) + s(BM) + s(LONG, LAT, 
##     bs = &quot;tp&quot;)
## Model 2: NCLAIMS ~ offset(log(EXP)) + COVERAGE + FUEL + FLEET + s(POWER) + 
##     s(AGEC) + s(AGEPH, by = SEX) + s(BM) + s(LONG, LAT, bs = &quot;tp&quot;)
##   Resid. Df Resid. Dev     Df Deviance  Pr(&gt;Chi)    
## 1    130524      69360                              
## 2    130519      69320 4.6661   39.515 1.259e-07 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb356"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb356-1"><a href="#cb356-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">82</span>)</span>
<span id="cb356-2"><a href="#cb356-2" tabindex="-1"></a>folds <span class="ot">=</span> <span class="fu">createFolds</span>(training_set<span class="sc">$</span>NCLAIMS, <span class="at">k =</span> <span class="dv">5</span>)</span>
<span id="cb356-3"><a href="#cb356-3" tabindex="-1"></a>res5 <span class="ot">=</span> <span class="fu">lapply</span>(folds, <span class="cf">function</span>(X) {</span>
<span id="cb356-4"><a href="#cb356-4" tabindex="-1"></a>    cl <span class="ot">=</span> <span class="fu">makeCluster</span>(<span class="fu">detectCores</span>() <span class="sc">-</span> <span class="dv">1</span>)  <span class="co"># Number of cores to use</span></span>
<span id="cb356-5"><a href="#cb356-5" tabindex="-1"></a>    m5_bam <span class="ot">=</span> <span class="fu">bam</span>(NCLAIMS <span class="sc">~</span> <span class="fu">offset</span>(<span class="fu">log</span>(EXP)) <span class="sc">+</span>  COVERAGE <span class="sc">+</span> FUEL <span class="sc">+</span> FLEET <span class="sc">+</span> <span class="fu">s</span>(POWER) <span class="sc">+</span> <span class="fu">s</span>(AGEC) <span class="sc">+</span> <span class="fu">s</span>(AGEPH, <span class="at">by=</span>SEX) <span class="sc">+</span> <span class="fu">s</span>(BM) <span class="sc">+</span> <span class="fu">s</span>(LONG,LAT, <span class="at">bs=</span><span class="st">&quot;tp&quot;</span>),</span>
<span id="cb356-6"><a href="#cb356-6" tabindex="-1"></a>        <span class="at">data =</span> <span class="fu">bake</span>(rec5, training_set[<span class="sc">-</span>X, ]), <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> log), <span class="at">cluster =</span> cl)</span>
<span id="cb356-7"><a href="#cb356-7" tabindex="-1"></a>    <span class="fu">stopCluster</span>(cl)</span>
<span id="cb356-8"><a href="#cb356-8" tabindex="-1"></a>    pred <span class="ot">=</span> <span class="fu">predict</span>(m5_bam, <span class="fu">bake</span>(rec5, training_set[X, ]), <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb356-9"><a href="#cb356-9" tabindex="-1"></a>    <span class="fu">sum</span>(<span class="fu">dpois</span>(<span class="at">x =</span> <span class="fu">bake</span>(rec5, training_set[X, ])<span class="sc">$</span>NCLAIMS, <span class="at">lambda =</span> pred, <span class="at">log =</span> <span class="cn">TRUE</span>))</span>
<span id="cb356-10"><a href="#cb356-10" tabindex="-1"></a>})</span>
<span id="cb356-11"><a href="#cb356-11" tabindex="-1"></a></span>
<span id="cb356-12"><a href="#cb356-12" tabindex="-1"></a>res5</span></code></pre></div>
<pre><code>## $Fold1
## [1] -9910.904
## 
## $Fold2
## [1] -10011.3
## 
## $Fold3
## [1] -10033.98
## 
## $Fold4
## [1] -9866.581
## 
## $Fold5
## [1] -10049.17</code></pre>
<div class="sourceCode" id="cb358"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb358-1"><a href="#cb358-1" tabindex="-1"></a><span class="fu">apply</span>(<span class="fu">cbind</span>(<span class="fu">unlist</span>(res0), <span class="fu">unlist</span>(res5)), <span class="dv">2</span>, mean)</span></code></pre></div>
<pre><code>## [1] -9979.203 -9974.389</code></pre>
<p>Based on our computation the optimal model so far with full
significance of the parameters would be the model without the
<em>USE</em> variable and with the variable <em>SEX</em> interacting
with <em>POWER</em>.</p>
<div id="optimizing-the-number-of-nodes" class="section level3">
<h3>Optimizing the number of nodes</h3>
<p>Up to this point, the smoothed components of the continuous variables
have been estimated using the default number of basis functions selected
by the model. Having identified the optimal model specification, we now
refine the model by assessing whether the chosen number of basis
functions is sufficient. This is done using the <strong>k.check</strong>
function, which provides diagnostic information on the adequacy of the
smoothing parameters in the fitted Generalized Additive Model (GAM).</p>
<p>The <em>k.check</em> output includes the k-index, which evaluates
whether the chosen basis dimension is large enough. Values of the
k-index substantially below 1 indicate that the basis dimension may be
too small, suggesting potential underfitting and loss of relevant
information. In addition, we examine the estimated degrees of freedom
(edf) for each smooth term, which reflect the complexity of the fitted
relationship. An edf close to 1 indicates an approximately linear
effect, whereas an edf approaching the maximum allowable value (k′)
suggests that the smooth term may be constrained by an insufficient
basis dimension.</p>
<p>Finally, the associated p-value tests the null hypothesis that the
selected basis dimension is adequate. Based on these diagnostics, our
strategy is to increase the basis dimension whenever the edf is too
close to k′, thereby allowing the model to allocate additional degrees
of freedom to the smooth term. This adjustment enhances the flexibility
of the smoothed functions and reduces the risk of underfitting.</p>
<div class="sourceCode" id="cb360"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb360-1"><a href="#cb360-1" tabindex="-1"></a><span class="fu">k.check</span>(m5_bam)</span>
<span id="cb360-2"><a href="#cb360-2" tabindex="-1"></a><span class="fu">gam.check</span>(m5_bam)</span></code></pre></div>
<p>With the results from <em>gam.check</em> and <em>k.check</em>, we
assume that most smoothed parameters have large enough nodes, except for
the spatial effect that might benefit from a higher k. We thus test with
a k value of 35:</p>
<div class="sourceCode" id="cb361"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb361-1"><a href="#cb361-1" tabindex="-1"></a>cl <span class="ot">=</span> <span class="fu">makeCluster</span>(<span class="fu">detectCores</span>() <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb361-2"><a href="#cb361-2" tabindex="-1"></a>rec6 <span class="ot">&lt;-</span> <span class="fu">recipe</span>(NCLAIMS <span class="sc">~</span> POWER <span class="sc">+</span>  COVERAGE <span class="sc">+</span> FUEL<span class="sc">+</span> SEX <span class="sc">+</span> FLEET <span class="sc">+</span> AGEPH <span class="sc">+</span> AGEC<span class="sc">+</span> BM</span>
<span id="cb361-3"><a href="#cb361-3" tabindex="-1"></a>               <span class="sc">+</span> LONG <span class="sc">+</span> LAT <span class="sc">+</span> EXP, <span class="at">data =</span> training_set)<span class="sc">%&gt;%</span></span>
<span id="cb361-4"><a href="#cb361-4" tabindex="-1"></a>  <span class="fu">step_mutate</span>(<span class="at">COVERAGE =</span> forcats<span class="sc">::</span><span class="fu">fct_collapse</span>(COVERAGE, <span class="st">&quot;(PO,FO)&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;PO&quot;</span>,<span class="st">&quot;FO&quot;</span>)))<span class="sc">%&gt;%</span></span>
<span id="cb361-5"><a href="#cb361-5" tabindex="-1"></a>  <span class="fu">prep</span>()</span>
<span id="cb361-6"><a href="#cb361-6" tabindex="-1"></a> </span>
<span id="cb361-7"><a href="#cb361-7" tabindex="-1"></a>m6_bam <span class="ot">=</span> <span class="fu">bam</span>(NCLAIMS <span class="sc">~</span> <span class="fu">offset</span>(<span class="fu">log</span>(EXP)) <span class="sc">+</span>  COVERAGE <span class="sc">+</span> FUEL <span class="sc">+</span> FLEET <span class="sc">+</span> <span class="fu">s</span>(POWER) <span class="sc">+</span> <span class="fu">s</span>(AGEC) <span class="sc">+</span> <span class="fu">s</span>(AGEPH,<span class="at">by=</span>SEX) <span class="sc">+</span> <span class="fu">s</span>(BM) <span class="sc">+</span> <span class="fu">s</span>(LONG,LAT, <span class="at">bs=</span><span class="st">&quot;tp&quot;</span>, <span class="at">k=</span> <span class="dv">35</span>),</span>
<span id="cb361-8"><a href="#cb361-8" tabindex="-1"></a>             <span class="at">data =</span> <span class="fu">bake</span>(rec6, training_set), <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> log), <span class="at">cluster =</span> cl)</span>
<span id="cb361-9"><a href="#cb361-9" tabindex="-1"></a><span class="fu">stopCluster</span>(cl)</span>
<span id="cb361-10"><a href="#cb361-10" tabindex="-1"></a><span class="fu">AIC</span>(m6_bam); <span class="fu">BIC</span>(m6_bam)</span></code></pre></div>
<pre><code>## [1] 99711.45</code></pre>
<pre><code>## [1] 100329.9</code></pre>
<div class="sourceCode" id="cb364"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb364-1"><a href="#cb364-1" tabindex="-1"></a><span class="fu">logLik.gam</span>(m6_bam)</span></code></pre></div>
<pre><code>## &#39;log Lik.&#39; -49792.49 (df=63.23446)</code></pre>
<div class="sourceCode" id="cb366"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb366-1"><a href="#cb366-1" tabindex="-1"></a><span class="fu">summary</span>(m6_bam)</span></code></pre></div>
<pre><code>## 
## Family: poisson 
## Link function: log 
## 
## Formula:
## NCLAIMS ~ offset(log(EXP)) + COVERAGE + FUEL + FLEET + s(POWER) + 
##     s(AGEC) + s(AGEPH, by = SEX) + s(BM) + s(LONG, LAT, bs = &quot;tp&quot;, 
##     k = 35)
## 
## Parametric coefficients:
##                 Estimate Std. Error  z value Pr(&gt;|z|)    
## (Intercept)     -1.84219    0.01602 -114.981  &lt; 2e-16 ***
## COVERAGE(PO,FO) -0.10409    0.01861   -5.593 2.23e-08 ***
## FUELgasoline    -0.19502    0.01715  -11.369  &lt; 2e-16 ***
## FLEETY          -0.15143    0.04880   -3.103  0.00192 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Approximate significance of smooth terms:
##                       edf Ref.df Chi.sq  p-value    
## s(POWER)            1.596  2.015  54.85  &lt; 2e-16 ***
## s(AGEC)             5.334  6.139  39.46  &lt; 2e-16 ***
## s(AGEPH):SEXmale    6.209  7.222 288.21  &lt; 2e-16 ***
## s(AGEPH):SEXfemale  4.685  5.689  38.32 4.27e-06 ***
## s(BM)               5.402  6.419 761.43  &lt; 2e-16 ***
## s(LONG,LAT)        27.536 31.751 354.23  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## R-sq.(adj) =  0.0206   Deviance explained = 3.85%
## fREML = 1.959e+05  Scale est. = 1         n = 130585</code></pre>
<div class="sourceCode" id="cb368"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb368-1"><a href="#cb368-1" tabindex="-1"></a><span class="fu">k.check</span>(m6_bam)</span></code></pre></div>
<pre><code>##                    k&#39;       edf   k-index p-value
## s(POWER)            9  1.596499 0.8910919  0.4475
## s(AGEC)             9  5.334411 0.8915098  0.4800
## s(AGEPH):SEXmale    9  6.209240 0.9141911  0.9700
## s(AGEPH):SEXfemale  9  4.684846 0.9141911  0.9825
## s(BM)               9  5.402251 0.9010118  0.7900
## s(LONG,LAT)        34 27.535553 0.9025692  0.7850</code></pre>
<p>We have extended our analysis by testing a k value of 40, but it gave
too much flexibility to the spatial smoothed function, which led to a
too high increase in BIC, whereas the maximization of the log-likelihood
was not sufficient. We also tried to up the k value of the interaction
between Policyholder’s age and SEX but their edf remained the same.
Therefore, we conclude that the only k-value we should adapt is for the
spatial effect.</p>
<div class="sourceCode" id="cb370"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb370-1"><a href="#cb370-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">82</span>)</span>
<span id="cb370-2"><a href="#cb370-2" tabindex="-1"></a>folds <span class="ot">=</span> <span class="fu">createFolds</span>(training_set<span class="sc">$</span>NCLAIMS, <span class="at">k =</span> <span class="dv">5</span>)</span>
<span id="cb370-3"><a href="#cb370-3" tabindex="-1"></a>res6 <span class="ot">=</span> <span class="fu">lapply</span>(folds, <span class="cf">function</span>(X) {</span>
<span id="cb370-4"><a href="#cb370-4" tabindex="-1"></a>    cl <span class="ot">=</span> <span class="fu">makeCluster</span>(<span class="fu">detectCores</span>() <span class="sc">-</span> <span class="dv">1</span>)  <span class="co"># Number of cores to use</span></span>
<span id="cb370-5"><a href="#cb370-5" tabindex="-1"></a>    m6_bam <span class="ot">=</span> <span class="fu">bam</span>(NCLAIMS <span class="sc">~</span> <span class="fu">offset</span>(<span class="fu">log</span>(EXP)) <span class="sc">+</span>  COVERAGE <span class="sc">+</span> FUEL <span class="sc">+</span> FLEET <span class="sc">+</span> <span class="fu">s</span>(POWER) <span class="sc">+</span> <span class="fu">s</span>(AGEC) <span class="sc">+</span> <span class="fu">s</span>(AGEPH, <span class="at">by=</span>SEX) <span class="sc">+</span> <span class="fu">s</span>(BM) <span class="sc">+</span> <span class="fu">s</span>(LONG,LAT, <span class="at">bs=</span><span class="st">&quot;tp&quot;</span>, <span class="at">k=</span><span class="dv">35</span>),</span>
<span id="cb370-6"><a href="#cb370-6" tabindex="-1"></a>        <span class="at">data =</span> <span class="fu">bake</span>(rec6, training_set[<span class="sc">-</span>X, ]), <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> log), <span class="at">cluster =</span> cl)</span>
<span id="cb370-7"><a href="#cb370-7" tabindex="-1"></a>    <span class="fu">stopCluster</span>(cl)</span>
<span id="cb370-8"><a href="#cb370-8" tabindex="-1"></a>    pred <span class="ot">=</span> <span class="fu">predict</span>(m6_bam, <span class="fu">bake</span>(rec6, training_set[X, ]), <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb370-9"><a href="#cb370-9" tabindex="-1"></a>    <span class="fu">sum</span>(<span class="fu">dpois</span>(<span class="at">x =</span> <span class="fu">bake</span>(rec6, training_set[X, ])<span class="sc">$</span>NCLAIMS, <span class="at">lambda =</span> pred, <span class="at">log =</span> <span class="cn">TRUE</span>))</span>
<span id="cb370-10"><a href="#cb370-10" tabindex="-1"></a>})</span>
<span id="cb370-11"><a href="#cb370-11" tabindex="-1"></a></span>
<span id="cb370-12"><a href="#cb370-12" tabindex="-1"></a>res6</span></code></pre></div>
<pre><code>## $Fold1
## [1] -9907.674
## 
## $Fold2
## [1] -10004.12
## 
## $Fold3
## [1] -10033.3
## 
## $Fold4
## [1] -9860.844
## 
## $Fold5
## [1] -10047.09</code></pre>
<div class="sourceCode" id="cb372"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb372-1"><a href="#cb372-1" tabindex="-1"></a><span class="fu">apply</span>(<span class="fu">cbind</span>(<span class="fu">unlist</span>(res0), <span class="fu">unlist</span>(res6)), <span class="dv">2</span>, mean)</span></code></pre></div>
<pre><code>## [1] -9979.203 -9970.606</code></pre>
<p>We have now to our disposition the most optimal model regarding our
data set with a GAM implementation. In the data frame <em>df_gam</em> we
may find all the key performance indicators from each gam model we
computed to allow for comparison. As a result, we see that before
reviewing the optimal number of nodes for the spatial term, we add the
model <em>m5_bam</em> scoring the best for all indicators, except for
the log-likelihood. But once we adapted the k value of the spatial
component, we were found with an optimal model. Although performs
slightly poorer in terms of BIC, model <em>m6_bam</em> made a noticeable
leap forward in terms of AIC, log-likelihood, cross-validation and
adjusted R-squared. This final model may be optimal regarding the data
available at hand and the scope of this project, but the low adjusted
R-squared score and the little percentage of deviance explained suggest
that a low share of the variance is actually explained. The model might
require additionnal variables for a better fit, even though current
coefficients are significant.</p>
<div class="sourceCode" id="cb374"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb374-1"><a href="#cb374-1" tabindex="-1"></a>b0<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;m0_bam&quot;</span>, <span class="fl">99780.17</span>, <span class="fl">100309.9</span>, <span class="st">&quot;/&quot;</span>, <span class="sc">-</span><span class="fl">49835.92</span>, <span class="sc">-</span><span class="fl">9979.203</span> , <span class="fl">0.0198</span>) <span class="co">#basic</span></span>
<span id="cb374-2"><a href="#cb374-2" tabindex="-1"></a>b1<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;m1_bam&quot;</span>, <span class="fl">99784.1</span> , <span class="dv">100300</span>, <span class="fl">0.01807</span> , <span class="sc">-</span><span class="fl">49839.3</span>, <span class="st">&quot;/&quot;</span>, <span class="fl">0.0198</span>) <span class="co">#remove USE and SEX</span></span>
<span id="cb374-3"><a href="#cb374-3" tabindex="-1"></a>b2<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;m2_bam&quot;</span>, <span class="fl">99780.55</span>, <span class="fl">100302.9</span>, <span class="fl">0.1135</span> , <span class="sc">-</span><span class="fl">49836.87</span>, <span class="sc">-</span><span class="fl">9978.296</span>, <span class="fl">0.0198</span>) <span class="co"># Add SEX</span></span>
<span id="cb374-4"><a href="#cb374-4" tabindex="-1"></a>b3<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;m3_bam&quot;</span>, <span class="fl">99750.72</span>, <span class="fl">100329.6</span>, <span class="st">&quot;/&quot;</span>, <span class="sc">-</span><span class="fl">49816.17</span>,<span class="sc">-</span><span class="fl">9974.980</span> , <span class="fl">0.0202</span>) <span class="co">#SEX*AGEPH </span></span>
<span id="cb374-5"><a href="#cb374-5" tabindex="-1"></a>b4<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;m4_bam&quot;</span>, <span class="fl">99767.38</span>, <span class="fl">100267.5</span>, <span class="st">&quot;/&quot;</span>, <span class="sc">-</span><span class="fl">49832.55</span>, <span class="sc">-</span><span class="fl">9977.323</span>, <span class="fl">0.02</span>)<span class="co"># SEX*POWER</span></span>
<span id="cb374-6"><a href="#cb374-6" tabindex="-1"></a>b5<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;m5_bam&quot;</span>, <span class="fl">99748.73</span>, <span class="dv">100318</span>, <span class="st">&quot;/&quot;</span>, <span class="sc">-</span><span class="fl">49816.16</span> , <span class="sc">-</span><span class="fl">9974.389</span>, <span class="fl">0.0202</span>) <span class="co">#b3 + coverage merge</span></span>
<span id="cb374-7"><a href="#cb374-7" tabindex="-1"></a>b6<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;m6_bam&quot;</span>, <span class="fl">99711.45</span>, <span class="fl">100329.9</span>, <span class="st">&quot;/&quot;</span>, <span class="sc">-</span><span class="fl">49792.49</span> , <span class="sc">-</span><span class="fl">9970.606</span>, <span class="fl">0.0206</span>) <span class="co"># k=35 spat</span></span>
<span id="cb374-8"><a href="#cb374-8" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data =</span> <span class="fu">rbind</span>(b0, b1, b2, b3, b4, b5, b6),<span class="at">nrow =</span> <span class="dv">7</span>, <span class="at">ncol =</span> <span class="dv">7</span>)</span>
<span id="cb374-9"><a href="#cb374-9" tabindex="-1"></a>df_gam <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(m)</span>
<span id="cb374-10"><a href="#cb374-10" tabindex="-1"></a><span class="fu">colnames</span>(df_gam) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Model&quot;</span>, <span class="st">&quot;AIC&quot;</span>, <span class="st">&quot;BIC&quot;</span>, <span class="st">&quot;Anova&quot;</span>, <span class="st">&quot;LogLik&quot;</span>, <span class="st">&quot;CV&quot;</span>, <span class="st">&quot;R_sq (adj)&quot;</span>)</span>
<span id="cb374-11"><a href="#cb374-11" tabindex="-1"></a>df_gam</span></code></pre></div>
<pre><code>##    Model      AIC      BIC   Anova    LogLik        CV R_sq (adj)
## 1 m0_bam 99780.17 100309.9       / -49835.92 -9979.203     0.0198
## 2 m1_bam  99784.1   100300 0.01807  -49839.3         /     0.0198
## 3 m2_bam 99780.55 100302.9  0.1135 -49836.87 -9978.296     0.0198
## 4 m3_bam 99750.72 100329.6       / -49816.17  -9974.98     0.0202
## 5 m4_bam 99767.38 100267.5       / -49832.55 -9977.323       0.02
## 6 m5_bam 99748.73   100318       / -49816.16 -9974.389     0.0202
## 7 m6_bam 99711.45 100329.9       / -49792.49 -9970.606     0.0206</code></pre>
<p>We may further examine our GAM model by using the function
<em>gam.check</em> to gain better insight of the fit of the model.</p>
<div class="sourceCode" id="cb376"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb376-1"><a href="#cb376-1" tabindex="-1"></a><span class="fu">gam.check</span>(m6_bam)</span></code></pre></div>
<p>Based on the QQ-plot we can determine that our model fits in a good
way medium risks in the portfolio but observation tend to deviate from
the prediction for higher risk/quantile. Therefore, the model might
underestimate the value of higher risks, phenomenon commonly observed as
a flaw in log-poisson distribution. A solution could be to follow up
with another assumed distribution of the number of claims which include
an overdispersion factor to deal with this effect of increasing
variance, such as a Negative Binomial distribution.</p>
<p>The plot of residuals against the linear predictor exhibits a clear
structured pattern, which is typical in Poisson-type models due to the
discrete nature of the response and the mean–variance relationship
implied by the distribution. The dispersion of the residuals increases
as the linear predictor increases, reflecting the fact that higher
predicted claim intensities are associated with larger variability in
observed outcomes. This fan-shaped pattern does not necessarily indicate
model misspecification, but rather the inherent heteroskedasticity of
count data modeled under a Poisson assumption. Importantly, no strong
systematic deviation from the expected trend is observed, suggesting
that the mean structure of the model is broadly adequate.</p>
<p>Let’s now compare the AIC and BIC with the ones obtain from the
optimal GLM model we performed in the first part of this project,
namely, model <em>rec_8</em>.</p>
<div class="sourceCode" id="cb377"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb377-1"><a href="#cb377-1" tabindex="-1"></a>df_freq[<span class="dv">9</span>,<span class="fu">c</span>(<span class="st">&quot;AIC&quot;</span>,<span class="st">&quot;BIC&quot;</span>)]; df_gam[<span class="dv">7</span>,<span class="fu">c</span>(<span class="st">&quot;AIC&quot;</span>,<span class="st">&quot;BIC&quot;</span>)]</span></code></pre></div>
<pre><code>##      AIC      BIC
## 9 100289 100445.6</code></pre>
<pre><code>##        AIC      BIC
## 7 99711.45 100329.9</code></pre>
<p>We may thus observe empirically that using a GAM model really helps
drastically minimize these two performance indicators. We may also test
the overall scoring of the two type of model along our prediction and we
see that even the worse performing GAM model outscores any of the GLM’s
regarding AIC and BIC.</p>
</div>
</div>
<div id="comparison-gam-and-glm" class="section level2">
<h2>Comparison GAM and GLM</h2>
<p>To go one step further in our comparison of the two models, let’s
also test their prediction behavior and accuracy.</p>
<div class="sourceCode" id="cb380"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb380-1"><a href="#cb380-1" tabindex="-1"></a>rec_glm <span class="ot">&lt;-</span> <span class="fu">recipe</span>(NCLAIMS <span class="sc">~</span> EXP <span class="sc">+</span> COVERAGE <span class="sc">+</span> FUEL <span class="sc">+</span> SEX <span class="sc">+</span></span>
<span id="cb380-2"><a href="#cb380-2" tabindex="-1"></a>                            FLEET<span class="sc">+</span> AGEPH_fac <span class="sc">+</span> AGEC_fac <span class="sc">+</span> POWER_fac <span class="sc">+</span></span>
<span id="cb380-3"><a href="#cb380-3" tabindex="-1"></a>                            BM_fac , <span class="at">data =</span> training_set) <span class="sc">%&gt;%</span></span>
<span id="cb380-4"><a href="#cb380-4" tabindex="-1"></a>  <span class="fu">step_mutate</span>(<span class="at">COVERAGE =</span> forcats<span class="sc">::</span><span class="fu">fct_collapse</span>(COVERAGE, <span class="st">&quot;All&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;PO&quot;</span>,<span class="st">&quot;FO&quot;</span>)))<span class="sc">%&gt;%</span></span>
<span id="cb380-5"><a href="#cb380-5" tabindex="-1"></a>  <span class="fu">step_mutate</span>(<span class="at">AGEC_fac =</span> forcats<span class="sc">::</span><span class="fu">fct_collapse</span>(AGEC_fac, <span class="st">&quot;All&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;(5,9]&quot;</span>,<span class="st">&quot;(9,48]&quot;</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb380-6"><a href="#cb380-6" tabindex="-1"></a>  <span class="fu">step_mutate</span>(<span class="at">AGEPH_fac=</span> forcats <span class="sc">::</span> <span class="fu">fct_collapse</span>(AGEPH_fac, <span class="st">&quot;rest&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;(43.7,56.5]&quot;</span>, <span class="st">&quot;(82.2,95.1]&quot;</span>,<span class="st">&quot;(30.8,43.7]&quot;</span>)))<span class="sc">%&gt;%</span></span>
<span id="cb380-7"><a href="#cb380-7" tabindex="-1"></a>  <span class="fu">step_relevel</span>(AGEPH_fac, <span class="at">ref_level =</span> <span class="st">&quot;rest&quot;</span>)<span class="sc">%&gt;%</span></span>
<span id="cb380-8"><a href="#cb380-8" tabindex="-1"></a>  <span class="fu">prep</span>()</span>
<span id="cb380-9"><a href="#cb380-9" tabindex="-1"></a></span>
<span id="cb380-10"><a href="#cb380-10" tabindex="-1"></a>m_glm <span class="ot">&lt;-</span> <span class="fu">gam</span>(NCLAIMS <span class="sc">~</span> <span class="fu">offset</span>(<span class="fu">log</span>(EXP)) <span class="sc">+</span>  COVERAGE <span class="sc">+</span> FUEL <span class="sc">+</span> SEX <span class="sc">+</span></span>
<span id="cb380-11"><a href="#cb380-11" tabindex="-1"></a>                            FLEET<span class="sc">+</span> AGEPH_fac <span class="sc">+</span> AGEC_fac <span class="sc">+</span> POWER_fac <span class="sc">+</span></span>
<span id="cb380-12"><a href="#cb380-12" tabindex="-1"></a>                            BM_fac, <span class="at">data =</span> <span class="fu">bake</span>(rec_glm, training_set), <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link=</span><span class="st">&quot;log&quot;</span>))</span></code></pre></div>
<div class="sourceCode" id="cb381"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb381-1"><a href="#cb381-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">82</span>)</span>
<span id="cb381-2"><a href="#cb381-2" tabindex="-1"></a><span class="fu">require</span>(parallel)</span>
<span id="cb381-3"><a href="#cb381-3" tabindex="-1"></a>resglm <span class="ot">=</span> <span class="fu">lapply</span>(folds, <span class="cf">function</span>(X) {</span>
<span id="cb381-4"><a href="#cb381-4" tabindex="-1"></a>    cl <span class="ot">=</span> <span class="fu">makeCluster</span>(<span class="fu">detectCores</span>() <span class="sc">-</span> <span class="dv">1</span>)  <span class="co"># Number of cores to use</span></span>
<span id="cb381-5"><a href="#cb381-5" tabindex="-1"></a>    m_glm <span class="ot">&lt;-</span> <span class="fu">gam</span>(NCLAIMS <span class="sc">~</span> <span class="fu">offset</span>(<span class="fu">log</span>(EXP)) <span class="sc">+</span>  COVERAGE <span class="sc">+</span> FUEL <span class="sc">+</span> SEX <span class="sc">+</span></span>
<span id="cb381-6"><a href="#cb381-6" tabindex="-1"></a>                            FLEET<span class="sc">+</span> AGEPH_fac <span class="sc">+</span> AGEC_fac <span class="sc">+</span> POWER_fac <span class="sc">+</span></span>
<span id="cb381-7"><a href="#cb381-7" tabindex="-1"></a>                            BM_fac, <span class="at">data =</span> <span class="fu">bake</span>(rec_glm, training_set), <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link=</span><span class="st">&quot;log&quot;</span>), <span class="at">cluster =</span> cl)</span>
<span id="cb381-8"><a href="#cb381-8" tabindex="-1"></a>    <span class="fu">stopCluster</span>(cl)</span>
<span id="cb381-9"><a href="#cb381-9" tabindex="-1"></a>    pred <span class="ot">=</span> <span class="fu">predict</span>(m_glm, <span class="fu">bake</span>(rec_glm, training_set[X, ]), <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb381-10"><a href="#cb381-10" tabindex="-1"></a>    <span class="fu">sum</span>(<span class="fu">dpois</span>(<span class="at">x =</span> <span class="fu">bake</span>(rec_glm, training_set[X, ])<span class="sc">$</span>NCLAIMS, <span class="at">lambda =</span> pred, <span class="at">log =</span> <span class="cn">TRUE</span>))</span>
<span id="cb381-11"><a href="#cb381-11" tabindex="-1"></a>})</span>
<span id="cb381-12"><a href="#cb381-12" tabindex="-1"></a></span>
<span id="cb381-13"><a href="#cb381-13" tabindex="-1"></a>resglm</span></code></pre></div>
<pre><code>## $Fold1
## [1] -9966.972
## 
## $Fold2
## [1] -10045.26
## 
## $Fold3
## [1] -10084.35
## 
## $Fold4
## [1] -9926.683
## 
## $Fold5
## [1] -10105.31</code></pre>
<div class="sourceCode" id="cb383"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb383-1"><a href="#cb383-1" tabindex="-1"></a><span class="fu">apply</span>(<span class="fu">cbind</span>(<span class="fu">unlist</span>(resglm), <span class="fu">unlist</span>(res6)), <span class="dv">2</span>, mean)</span></code></pre></div>
<pre><code>## [1] -10025.715  -9970.606</code></pre>
<p>While going one step further, GLM performs poorly in cross validation
test compared to GAM.</p>
<div class="sourceCode" id="cb385"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb385-1"><a href="#cb385-1" tabindex="-1"></a>testing_set<span class="sc">$</span>GLM_pred <span class="ot">=</span> <span class="fu">predict</span>(m_glm, <span class="fu">bake</span>(rec_glm, testing_set), <span class="at">type=</span><span class="st">&quot;response&quot;</span>)</span>
<span id="cb385-2"><a href="#cb385-2" tabindex="-1"></a>testing_set<span class="sc">$</span>GAM_pred <span class="ot">=</span> <span class="fu">predict</span>(m6_bam, <span class="fu">bake</span>(rec6, testing_set), <span class="at">type=</span><span class="st">&quot;response&quot;</span>)</span>
<span id="cb385-3"><a href="#cb385-3" tabindex="-1"></a><span class="fu">head</span>(testing_set[,<span class="fu">c</span>(<span class="st">&quot;GLM_pred&quot;</span>, <span class="st">&quot;GAM_pred&quot;</span>)], <span class="at">n=</span><span class="dv">5</span>)</span></code></pre></div>
<pre><code>##      GLM_pred   GAM_pred
## 8  0.06501614 0.09752403
## 9  0.08638284 0.12529470
## 14 0.20838199 0.19113064
## 15 0.05543372 0.07746291
## 23 0.09115167 0.11806840</code></pre>
<div class="sourceCode" id="cb387"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb387-1"><a href="#cb387-1" tabindex="-1"></a><span class="fu">ggplot</span>(testing_set) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>GLM_pred, <span class="at">y=</span>GAM_pred))<span class="sc">+</span><span class="fu">ylab</span>(<span class="st">&quot;GAM&quot;</span>)<span class="sc">+</span><span class="fu">xlab</span>(<span class="st">&quot;GLM&quot;</span>)<span class="sc">+</span><span class="fu">geom_abline</span>(<span class="at">slope=</span><span class="dv">1</span>, <span class="at">intercept=</span><span class="dv">0</span>, <span class="at">color=</span><span class="st">&quot;red&quot;</span>)<span class="sc">+</span></span>
<span id="cb387-2"><a href="#cb387-2" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">percent_format</span>(<span class="at">accuracy =</span> <span class="fl">0.01</span>))<span class="sc">+</span></span>
<span id="cb387-3"><a href="#cb387-3" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">percent_format</span>(<span class="at">accuracy =</span> <span class="fl">0.01</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="100%" /></p>
<p>With the resulting prediction-prediction plot, we evaluate the
observations in each frequency model and how it relates to the ones from
the other. We have the red line being the linear fit between the two
models. Essentially, we can deduct that observations are highly
correlated with a positive relationship. This can be defined by low risk
values in the GLM represented as low-risk value in the GAM and vice
versa. Basically, models are not contradicting one another and that is a
good sign. Although for low-risk values, they appear similar, we observe
a slightly different behavior for medium to high risk observations. The
higher density of observations above the red line tend to show that the
GAM model is more sensitive in the tail distribution of risks.</p>
<p>This phenomenon might be explained by the use of smoothed continuous
variables instead of factorized ones in the GLM. The smoothing function
enables us to deal with continuous variables in a more reliable way and
thus further refine risk differentiation instead of classifying and
generalizing effects over a potentially unrepresentative subgroup.
Furthermore, the GAM also enables us to use spatial differentiation
which might also be a crucial indicator for risk identification.
Altogether, dealing with continuous variables more efficiently with GAM
has a positive impact on our model accuracy but also on interpretation
as the differentiation between different risk profiles is more refined.
Using A GAM, despite its heavier computation time, may helps the insurer
provide a more accurate picture of the risk in his portfolio and
properly assess it to aim for more accurate pricing when dealing with an
actuarial matter.</p>
<p>When computing the total amount of claims resulting from our
prediction, we obtain a slightly lower amount for the GAM model than for
the GLM.</p>
<div class="sourceCode" id="cb388"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb388-1"><a href="#cb388-1" tabindex="-1"></a><span class="fu">sum</span>(testing_set<span class="sc">$</span>GLM_pred);<span class="fu">sum</span>(testing_set<span class="sc">$</span>GAM_pred)</span></code></pre></div>
<pre><code>## [1] 4070.769</code></pre>
<pre><code>## [1] 4060.702</code></pre>
<div id="analysis-of-the-smoothed-functions" class="section level3">
<h3>Analysis of the smoothed functions</h3>
<p>Let’s now explore in a more detailed way the different smoothed
functions we have computed and their interpretation.</p>
<p>First with respect to <em>POWER</em>, we observe a straightforward
interpretation of the effect of the horsepower of the vehicle on the
amount of claims. Indeed, claim frequency rises as the vehicle has more
power while we observe more uncertainty with a wider confidence interval
the higher the horsepower in kw.</p>
<div class="sourceCode" id="cb391"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb391-1"><a href="#cb391-1" tabindex="-1"></a><span class="fu">plot</span>(m6_bam , <span class="at">select=</span><span class="dv">1</span> , <span class="at">trans =</span> exp, <span class="at">scale =</span> <span class="dv">0</span>, <span class="at">shade =</span> <span class="cn">TRUE</span>, <span class="at">shade.col =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAwAAAAHgCAMAAAAlhPoXAAAAZlBMVEUAAAAAADoAAGYAOmYAOpAAZpAAZrY6AAA6ADo6AGY6Ojo6kNtmAABmADpmAGZmOgBmZmZmtv+QOgCQtpCQ2/+t2Oa2ZgC2///bkDrbkJDb/9vb////AAD/tmb/25D//7b//9v///+d6pshAAAACXBIWXMAAA7DAAAOwwHHb6hkAAASl0lEQVR4nO3dC3viuBXGcWaaJtsN2zY0YtxmCPD9v2TxBWKCBb4c6Ug6/9/zdJPdmdpCeV98wbFXR8CwlfYAAE0UAKZRAJhGAWAaBYBpFACmUQCYRgFgGgWAaRQAplEAmEYBYBoFgGkUAKZRAJhGAWAaBYBpFACmUQCYRgFgGgWAaRQAplEAmEYBYBoFgGkUAKZRAJhGAWAaBYBpFACmUQCYRgFgGgWAaRQAplEAmEYBYBoFgGkUAKZRAJhGAWAaBYBpFACmUQCYRgFgGgWAaRQAplEAmEYBYBoFgGkUAKZRAJhGAWAaBYBpFACmUQCYRgFgGgWAaRQAplEAmEYBYBoFgGkUAKZRAJhGAWAaBYBpFACmUQCYRgFgGgWAaRQAplEAmEYBYBoFgGkUAKZRAJhGAWAaBYBpwgVYAUnQKoDs4oB5KABMowAwjQLANAoA0ygATKMAMI0CwDQKANOCFGC/fj39c7darX7+ElgcEEy4AlRPH/V3b8sXBwQTrABd9JsaLFwcEEywAny+NAXYeXaCKABicr4/YAsAA1zsAtTXmT4fz4fDCxcHLOMiF+DYdODH+3G38uSfAiAep1CAyIsDvBwFgGFOtQAVZ4GgyukW4PtSJv8qJrCES6sAoRYHDHIUAIY5rQJUp52c9oMwjgGgxmkVoPrxftyv60/CKADUOK0CHDavzT+fPigA1Di1Apwvgt4+fVAAKHF6BWi3ACfbZwoAHU6xAJcdn/3a9zthFABBOdUCHKv2HNBpW0ABoOB7/vkcAJbc5J8CwJDb/FMA2DGQfwoAM4byTwFgxWD+KQCMGM4/BYANnvxTAJjgyz8FgAXe/FMAGODPPwVA+e7knwKgdPfiTwFQuvv5pwAo24P8UwAU7VH+KQBK9jD/FAAFe5x/CoByjcg/BUCxxuSfAqBUo/JPAVCocfmnACjTyPxTAJRobPwpAEo0Pv8UAOWZkH8KgOJMyT8FQGkm5Z8CoDDT8k8BUJaJ+acAKMrU/FMAlGRy/ikACjI9/xQA5ZiRfwqAUsyJPwVAKeblnwKgDDPzTwFQgrnxpwAowfz8UwBkb0H8KQCytyj/FACZW5Z/CoC8Lcw/BUDWluafAiBji+NPAZAxgfxTAGRLIv8UALkSyT8FQKZk8k8BkCWh+FMAZEks/xQAGZLLPwVAfgTzTwGQHcn8UwBkRjT+FACZEc4/BUBWpPNPAZAT8fxTAGREPv8UANkIEH8KgGwEyX/sAhw2q8bPXyKLgx1h8h+5ANXqtf1md/5m0eJgR6D8xy3AYXOJffX0sXhxsCNU/uMWYL9+O3+78+wEUQDcChZ/tgDIQMD8Rz8G6DYBHANgrJDxj34WaL9uzwJ53v8pAL4Lm38+B0DSAsefAiBpwfOvVoCKs0B4KHz+U9kCrC5EFociRMi/ZAF2XYTf7vztCYuDdTHyL1aA/Xr13H532Piv9Bm9OJgXJf5iBdj/s5/563/rq85bCI4BcFek/Mf+IOzH+2lbUW8qKADuiBV/lUshDpunDwqAO+LlX64A21OiP19Wq9N7vNf5Yrjt0wcFgE/E+MsVoMn/H+9XV3zeuFwMt32mAPCImn+xg+D1ax3r+lvfdZ7Nn3Wx3699Z4oogHVx8y9XgLfz+7vvSv/G+XLQw4YCYEjk/MvtAp3e/auHW4DRi4NRsfMv+EHYz1/NJmB37yh49OJgUvT4S54G7a6EeF42BRTAMIX8p3IxXKjFIR8a8acASIVO/gMUwHeGf+biYIJS/NkCIAlq+acA0KcXfwoAfZr5pwBQphp/CgBlyvmXuxbo69faOQuEsbTjL7cF8F7dNhEFsEQ7/U5wF+iwWXgRxMT1Inva2W/4BjfnWqBF90OZul7kTjv6Ld/oOAhGUNrBP/ONjwIgJO3cX/gGSAEQjnbqe3xDXHAx3OrunSGmLg7l0Q59n2+MbAEQiHbkr/lGSQEQhHbgv/ONc0EB/ssnwfDQjvst30gnF6DqroFY+JEwBSiZdtoH+IY6tQD1zSC2Tx/1r8Z7nv84aXEokHbWB/kGO7EAzYUQ+/VbteQM0KT1IjfaUR/mG+2cWyMeNn8uvSsKBSiVdtA9fv/2jHfGrRGPx+2y3Z9J60VWtIM+6Pfv35L3Bm1ue750oihAibSTPqROvxO9Oe759tCLUIACaWf9Vpd+RwEQnGrSh3yl31EABKaX82FX6Xf8TjCCUkq5z/f0O64FQkAaGfcbSL+jAAgnesTvGE6/Ez4GaNx9RNLIxSF/cQN+lzf9TrYA7UPCKACOCeX/XvodBUAQsdL9yIP0OwqAAKJk+7HH6XcUAOLCJ3uMUel3FADCAud6nLHpdxQAskLGeqQJ6XcUAJKChXq0ael3XAoBQWEyPd7k9Ds+CYaYAImeYk76neQWQOLe0BQgW9J5nuT3zPQ76V0gfiPMKNE4TzQ//DXfK5qzC3TYNC1YtCmgABkSy/J0y9LvQhwDbDkItkUmyXMsTr+TLsBu6QaAAuRGIMfzSKTfiRagWi28K9yk9SIFEhGcQyj9Tq4AW4n0T1kvEiAUwonk0u9k7wwngQLkQy6FE4im38ltAer9H4nnpFKAbIjmcBzp9DvRY4CdxAcBFCAT0kF8LED6nfRZoM+XhZcCUYA8BEjifWHS7/gcADOEiaJfsPS7EJ8EL3tAAAVIXrAsDguZfid9LRC3RixeyDDeCpx+J1iAhU+GmbxeaAicxmvh0+/4fQBMED6OX6Kk30kWoD0CuHsetP24bHfvt8YoQLKi5LEVK/1O9DGpr70vw5oCVHVHerdSnLlexBUrkFHT72Qfk9r4fPFfDloXoIt+5dlUUIAkRctj3PQ72cektu48KKwuQFcQ370jKECC4kTx94JfbJzP95qD3B2aLUCOYsRQJfsN36sOVIDzhwXeq0cpQGIiZFAt/DXf6w6yC3RsOnA6Wth5D5UpQFLCB1A1/S7yQfD4xSEFwdOnnX4X+TTohMVBXejoJZB+F/mDsJ6Ks0BJC527NNLvkrkU4uvOoiKLwxLBQ5dM+l0yBQi1OEwWOHB6JzyH+aZhxjHA0lsCTVsvggiZNZ1Puh7wTcTkX4r/8b70BNC09SKAcDlLMfsN31RM/hygPvnj+3h3AgqgJ1jIUg1/zTcZsz4JfvRwmBGP0aAAWkIlLOX0u8gFOG0oHv0NCqAjULwST7+LXYD+JRML1wtBYbKVfvpd9AIcdw9OFVGA+IIEK4v0u/gFGLc4xCOfqSRPd/r4poWnRJognqecst/wzQyfBJdPPEy5hb/mmxwKUDrpJOWYfie3C/TP/n7P9b9NQgHiEI5Rpul3cluA00FAd4LzsFlyFEABYpBMUFaHvLd8UzTz+QA8JjV9gunJO/sN3yxxDFAmwejkH/6ab6IoQInkclNG+p1oAepbnVRLn5JEAcIRC00x6XeiBdg+fXy+PB+3ix4SQAFCkclL5oe8t3zTNb0A9dUQ9ZU+y66HoABBiGSltOw3fDM2rwD188F893uYuDiIEQlKieGv+SZtzi7Q83799LFfswuUEoGMFLfb0+ebt1kHwasf7w8v+B+9OCy3PB8lZ7/hmzpOg+ZvcThKD3/NN3kUIHfLclH0bk+fb/ooQN4WRMJM9hu+CaQAGVuQB0vZb/jmkALkanYUbL3zn/mmkQJkaW4MTGa/4ZtJCpCfuRkwG/6abzIpQGbm/fht7vb0+eaTAuRk1o/efPYbvimlANmY9XMn/B3frFKALMz5kbPb0+ebWQqQvhk/brL/nW9yKUDiZvysCf8A3/xSgJRN/jGz2+Pjm2IKkKypP2Kyf49vlilAmqb+fAn/A76JpgAJmvajZbdnDN9cU4DUTPih/i4n+2rTTQGSMj4xmUZfe4JvUIB0jI9R8uHXnsrxKEAixkYrxb0e7blbggKkYFTMUtnj154sWRRA3YjMqUdfe47CoQC6RoRPK/vaUxMHBVD0MIPR3/m1ZyQ+CqDiYRJj7PBrT0ISKEB8Y8JP9COhAJGNSD+hj4gCxPQw+8Lp1369GaAA0TyKvlD2tV9mZihABEQ/XRQgtPvhJ/TKKEBQd9NP9BNAAcK5k/2Z6dd+RQWiAIH4oz8n+9qvplwUQNpwgmdEX/uF2EABRHnDT/QTRQHk+NJP6BNGASQMZ3rkXo/24G2jAIv5ov84+9ojBwVYajD5RD8fFGCuyW/62gPGEAowy234iX6eKMB0N+kn+vmiAFMM7fYQ/awFKsBhs2r8/CWyuCTcRH84+9rDxCRhClCtXttvdudvFi0uAfejrz06zBakAIfNJfbV08fixeki+kULUoD9+u387c6zE5RJAfrhJ/olYgvg10s/0S9VqGOAbhOQ6THA9W4P0S9YoLNA+3V7Fsjz/p90AQb3+LUHhUD4HOAa0TeGApwRfZNCF6DK4yzQt/M82sNBNJG3AKsLkcXJ6J/n0R4LIrO9C9Q/z6M9FqgwWoCr8zy6Q4EqcwVw/V/b0hoEkmGoAP1rGuKvHWkKdC3Q18FuCmeBvl3TEHPVSFyYLcBh4/1FgDmLm+/2moY460Uugv1CzLPk4ma4jj67PRgW6hhgt3q7++cBC3AbfdIPn0IOgt13fLCLUbIvwE30HR/sYryMCzAU/asL+JevAsXLrACDob/d4yf9GCmbAtyJ/u2v7MqOFQVLuQB3M3+V/qt/lx0oypZmAUZGf+DWbLKjRPFSK8Ck6HOnEiyVYwGIPsRkV4CBW3LKjgym5FSAwRvSyg4L1uRRAN/NmGXHBIMSL8C9Z27JDgg2JVyAuw8ekh0NzEq1ADx4CFEkWAAePIR4UisAuz2IKrUCkH5ElUcBZNcNXKRfANn1AlcSL4DsSoHvUi6A7BqBAckWQHZ1wLA0CyC7LsArtQIAUVEAmEYBYBoFgGkUAKZRAJhGAWAaBYBpFACmUQCYRgFgGgWAaWoFAJKgVABl6q+GAeQ2APXxilJ/NQwgtwGoj1eU+qthALkNQH28otRfDQPIbQDq4xWl/moYQG4DUB+vKPVXwwByG4D6eEWpvxoGkNsA1McrSv3VMIDcBqA+XlHqr4YB5DYA9fECmigATKMAMI0CwDQKANMoAEyjADCNAsA0CgDTKABMowAwjQLANAoA08oowH5d3wnj+fTdbrX68R579Z//+HXsrzv6INoBaM3CYXNa7evxqDYDlwHMmIEyCvD5R/did6dXvYvdgP3656/+uqMPohuA0iwcNqdVVXXslGbgawAzZqCMAuyaANRTUb8PbJ/jrny1qld/WXf0QXQD0JqFz5e30z+rn7+0ZuAygDkzUEYBqu6lfk1FPLvVazPvl3XHHsR5AKqzUL/fqs3AeQBzZqCMAmz/bHcC203gLu7Mdyu8rFthEO3KVGdh23vhWgOYMwNFFGC/fvo4zcBrt9sX/SCgmenLuhUG0QxAdRZOmyHVGWgGMGcGiihA65QC0wW4fKsxgPMxsNoMrC47/NNmoKACnHb8bO8CNVRmYdechFScgXYArWkzUFIB/nhXOfo6F0DxELBfAIVZqNr46c1A1cv/xBkoogDt6931TsTFtdM9DXrVQIVZqFZvzVe1GTgPYM4MFFGA9qWeDn50Pgjr3oD1Pgg7nwXSmYXPl/Pbr9IMfA1gxgyUUYDjdrVq3wWqlcKlEN0eyGXd0QfRDUBnFqr2kSz1CnVmoDeA6TNQSAGAeSgATKMAMI0CwDQKANMoAEyjADCNAsA0CgDTKABMowAwjQLANAoA0ygATKMAMI0CwDQKANMoAEyjADCNAsA0CgDTKABMowAwjQLANAoA0ygATKMAMI0CqNi2t7Nsb1/8+dLd0XJbP+Cku9f3YfN8/lurp4/mQaDnh5FCEAVQ0Ua9faRPc3Pvz5fn8w3tt/+u/+t+/dr9rVpdh2P9HIg3tSEXigKo6KJd38G7e7ZtHfjm/vb7v/5T/5f6P98UoPsCORRARRftOvHnxzhUTx91CY67p/9t3tqtwU0Bev8FMiiAiq8tQBP67vumDNVz86X5H1uA4CiAivMxwPPpf91ufb012NWHu5cvl4Pg13PyK44BpFEAFdvLSZ2rApx2/Pd/NYcFzZFBfwvQ/h/IvzQKoOIr2le7QKf3/dO7//nL912g5kwRZFEAFb2D2d5BcP2At6p5zttz++XbMcCOzwHEUQAVvQK0z/bstgS7v2+aJ33+7V9vx4GD4G38BwCWjgKo6J/O/Pog7PTlz+ZTgc+XJuk3BWg/OYMgCqDi6nz+5VKIOujNH3RfzmeBfryfz39W7AQJowAwjQLANAoA0ygATKMAMI0CwDQKANMoAEyjADCNAsA0CgDTKABMowAwjQLANAoA0ygATKMAMI0CwDQKANMoAEyjADCNAsA0CgDTKABM+z9RThS/f57daQAAAABJRU5ErkJggg==" width="100%" /></p>
<p>Now with respect to the car’s age, we tend to observe in our
portfolio that the older the car, the lower the frequency of claims we
obtain, but with again, a higher variance. The only period where there
is a higher frequency is for rather new vehicles (under 5 years), which
might be explained by the urge of policyholders to extract the most of
their vehicle. Another hypothesis could be for policyholders who change
vehicle more regularly due to accidents could fall fall in that
category.</p>
<div class="sourceCode" id="cb392"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb392-1"><a href="#cb392-1" tabindex="-1"></a><span class="fu">plot</span>(m6_bam , <span class="at">select=</span><span class="dv">2</span> , <span class="at">trans =</span> exp, <span class="at">scale =</span> <span class="dv">0</span>, <span class="at">shade =</span> <span class="cn">TRUE</span>, <span class="at">shade.col =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="100%" /></p>
<p>We have already seen while binning the age of policyholders in the
GLM section that amount of claims is highly influenced by the age of
policyholders. But since we evaluate the age and its interaction with
the sex, we see two different patterns regarding the gender of the
insured. On the one hand, Men follow the same pattern observed for the
overall portfolio, representing high risk and claim frequency at young
ages (18 to 25). We then have a downward trend for middle aged men as
the driver gets more driving experience and maturity. Finally, we
observe an upward slope for elderly people that are seen to be causing
more claims due to various factors impacted by their age. For example,
poorer eyesight as the policyholder ages might be a leading cause of
higher claims. As a result, the age group around 65 for men is the
safest risk profile based on our observations.</p>
<p>Women exhibit a distinctly different claim frequency trajectory
across their lifespan compared to men. Young female drivers (age 18) are
initially considered higher risk due to limited driving experience, with
claim frequencies approximately 20% above the reference level. However,
this elevated risk diminishes rapidly, albeit with some fluctuation.</p>
<p>Interestingly, middle-aged women and middle-aged men exhibit
comparable claim frequencies, suggesting that gender differences in
driving risk are most pronounced at the extremes of the age distribution
rather than during the middle years. This pattern may reflect
differences in driving behavior, risk exposure, or compensatory
strategies that evolve differentially by gender across the lifespan.</p>
<p>A notable transition occurs around age 50, where female drivers reach
parity with the reference level. Unlike their male counterparts, women
continue to demonstrate declining claim frequencies beyond this point,
with no evidence of the upward trend observed in older male drivers.
Although, these are the analysis and prediction of our model, but the
lack of data for older ages displays a higher variance for elderly,
which could also results in an upward trend as indicated by the
confidence interval.</p>
<div class="sourceCode" id="cb393"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb393-1"><a href="#cb393-1" tabindex="-1"></a><span class="fu">plot</span>(m6_bam , <span class="at">select=</span><span class="dv">3</span> , <span class="at">trans =</span> exp, <span class="at">scale =</span> <span class="dv">0</span>, <span class="at">shade =</span> <span class="cn">TRUE</span>, <span class="at">shade.col =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="100%" /></p>
<div class="sourceCode" id="cb394"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb394-1"><a href="#cb394-1" tabindex="-1"></a><span class="fu">plot</span>(m6_bam , <span class="at">select=</span><span class="dv">4</span> , <span class="at">trans =</span> exp, <span class="at">scale =</span> <span class="dv">0</span>, <span class="at">shade =</span> <span class="cn">TRUE</span>, <span class="at">shade.col =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="100%" /></p>
<p>Finally, we have the position on the bonus-malus scale which is
highly correlated with the amount of claims and thus highly impact the
frequency predictions. Let’s recall that the higher a policyholder is on
the ladder, the more claims that person declared in the recent years. As
a result, the claim history of a person has a major influence on the
claim frequency as it means that the policyholder has reported claims
lately, especially to land in the higher levels. For this reason, we
observe an upward effect of the frequency respective to the level on the
bonus-malus scale.</p>
<div class="sourceCode" id="cb395"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb395-1"><a href="#cb395-1" tabindex="-1"></a><span class="fu">plot</span>(m6_bam , <span class="at">select=</span><span class="dv">5</span> , <span class="at">trans =</span> exp, <span class="at">scale =</span> <span class="dv">0</span>, <span class="at">shade =</span> <span class="cn">TRUE</span>, <span class="at">shade.col =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAwAAAAHgCAMAAAAlhPoXAAAAaVBMVEUAAAAAADoAAGYAOpAAZmYAZrY6AAA6ADo6AGY6Ojo6OpA6kNtmAABmADpmAGZmZgBmkJBmtv+QOgCQOjqQZgCQ2/+t2Oa2ZgC2/9u2///bkDrb2//b////AAD/tmb/25D//7b//9v///8C9iN6AAAACXBIWXMAAA7DAAAOwwHHb6hkAAARTElEQVR4nO3dbZ+iyBXGYWY6zk7S7iZt0pox3bb6/T9kQMDxgeKhqKpzqPO/XiSd7P6wwPsWChGKM2BYIT0AQBIFgGkUAKZRAJhGAWAaBYBpFACmUQCYRgFgGgWAaRQAplEAmEYBYBoFgGkUAKZRAJhGAWAaBYBpFACmUQCYRgFgGgWAaRQAplEAmEYBYBoFgGkUAKZRAJhGAWAaBYBpFACmUQCYRgFgGgWAaRQAplEAmEYBYBoFgGkUAKZRAJhGAWAaBYBpFACmUQCYRgFgGgWAaRQAplEAmEYBYBoFgGkUAKZRAJhGAWAaBYBpFACmUQCYRgFgGgWAaRQAplEAmEYBYBoFgGkUAKZRAJhGAWAaBYBpFACmUQCYRgFgGgWAaRQAplEAmEYBYBoFgGkUAKZRAJhGAWBa4AIUgApSBQi7OMAPBYBpFACmUQCYRgFgGgWAaRQAplEAmEYBYBoFgGkUAKZRAJhGAWDB1vUPKAAsoACwbEsBYNiWAsAyCgDLthQAllEAWLalADBsSwFgGQWAZVsKAMO2FACWCRXgtKlvu/X9V5DFAX62MgXYF6/1H4f2j1mLA/xsZQpw2lxjv3/5mL04wJNQAY7rt/bPg+MgiAIgvi17ABi2lSpAOQdodgHMASBHrgDlQVB9Fsjx+U8BEN9WsACpFwc82lIAWKajAHvOAkHEVkcBHpcy+dFMgI+tzgLEWhxwjwLAssf8ixTgUBTf3sMtDhjrKf+pC7Aritevf3zcXhQxZ3HAJNIF2L18nHeXT38uhUB6z/kXuBju64+qAFwMh+Q68p+6ANUVQKf/ndkDIL2u/Ke+GK793K+rMHdxwAQKCnDe16d/DoVjDkwBEEtn/vkeAEZ0558CwAZH/ikAbKAAsMyVfwoAC5z5pwAwwJ1/CgADKAAs68k/BUD2+vJPAZC73vxTAOSOAsCy/vxTAORtIP8UAFkbyj8FQM4G808BkLHh/FMA5GtE/ikAsjUm/xQAuRqVfwqATI3LPwVAnkbmnwIgS2PzTwGQo9H5pwDI0Pj8UwDkZ0L+KQCyMyX/FAC5mZR/CoDMTMs/BUBeJuafAiArU/NPAZCTyfmnAMjI9PxTAOTDI/8UALnwiT8FQC788k8BkAfP/FMA5MA3/hQAOfDPv8SDsg9FUTieE08BMN2M+EsU4PKM+OPa8aBgCoCJZuU/fQGa6F9qMHNxwMz4CxTg68elAAfHQRAFwBRz888eAAs2O/7JC1DOf4vVuZ0Oz1wcjAuQ/+SnQcsOfHs/HwpH/ikAxgoRf74HwFKFyT8FwCIFir9cAfacBYK/YPnXsgcoroIsDlkLF381BYi1OGQoZP4pABYmaPyTF2BfHuTUX4QxB4CPwPlPXID9t/fzcV19E0YB4CF0/BMX4LR5vfznywcFgIfw+U99KUR9EfTu5YMCYKoI8RfZA5R2KwqAaaLEP/kcoIn9ce36TRgFQJdI8Rc4C1QfBJ02FACjRYs/3wNAv4jxpwDQLmr8KQB0ixx/CgDNosefAkCvBPGnANAqSfwpAHRKFH8KAI2SxZ8CQJ+E8acA0CZp/CkAdEkcfwoATZLHnwJAD4H4UwBoIRJ/CgAdhOIftACH5tZWjme/TF0c7BCLf7gCHNeX256fq9+6uJ8ANnpxMEQw/sEKcPzrNvP3/2sSCmCNaPyZA0CWcPwpACRJp38bvADNI/D8UQA7pLN/4Rrc1DnA+vcNzmdMgSmAHdLJb7iGN3UP0Dz1iz0ARpHO/ZVrgJMPgY7r6sGnFAAjSKf+hmuIHnOA3bd3CoBh0pm/4xqkzyR4X7xSAAyQTvwD1zC9zgJ9/Zh5IQQFyJx03J+5Rup3GvS0oQBwkg57F9dY+SIMgUlHvZtrtP4FcN3533NxyIN00F1c42UPgICkY+7wWXKMmAIgGOmcd6rCv2UPgOikk96lDn/FNerJ1wJVV0Ic5l4JRAGyI5rzLp+fv9O/DVuAfXUxRPskSE8UICtyOe/w+ZD9C9fIPQrQRP9SA28UICMiMe/SGf2aa+weBWgugzhwGhSVxCF3cUa/5ho9ewDMkizgvfrDX3GN3+sHMatzOx12OW0GfjRDAbKQJN393Ec9d1xrMP00aNmBb+/tD2Mc9u0/df5rFCAD8dPdq+eI/5lrHaJ8D3DaXGPvOlCiAIsXNdz9JkW/5lqLKAW4OUXqmipTgIWLFO0hHtGvudZjxsVwRXUo1Ik9QOaC57rP5y3vpbhWJc6lEPv25wLMAfITMNsDZmb+jmttIl0L1N4+xXmqlAIsVJg4DgkZ/ZprfbgYDhOEjOSjIEc6Tq41mliA9vw+N8ayKHwsa7FCf8u1TtNvj+6a+XZz/W6MAixNlFimiH7NtVrTD4HKnUDfd2ADS7nyXgQEhA9kuujXXGvmNQfYzf01AHuAJQkcxdTRr7lWznMSvJ97YyAKsBAhQygT/Zpr/bzPAn396NsL7NtniDEHWLKAAZSLfs21it43xuo9CtqXM+XjurpolAIsVsD0CYe/4lpLnwIM3hmxvhTitHn5oAALFSx4gkc9d1wrOr0Au6J9TqRTezHc7uWDAixQqNApyf6Fa12nFmA/5gTQ9WK43YoCLE2gwGkKf8W1unG+CW5jf1y7/i0KoFKQrGk56rnjWuNI1wK1l4OeNhRgGQLlTGP2L1zrzcVwCJn+QEsKz7Xqkwuwr459dgVfhGUjUMI0p38bcBJcHtLsqsv8Zz4kiQLoECheytO/DTgJfq2+B6hO8nBfoKULkyyVU95nro0w+b5Ab9c75PJ7gMUKlaplZP/CtSkogDmhIrWc8FdcW4MC2BImTQs57Lnl2iAUwJAgSVpe9i9c24QCWBEkRssMf8W1WbxujsuP4pcmQIIWeNhzy7Vl+CY4f3OzI/lDrmBcG4cCZG5WarKIfs21faYeAv11e9xz/78moQAp+Oclo+jXXJto+n2B2p/DnDZzZgEUID6/pGQX/ZprI3kcAh2aSTDXAqk2PSOZRr/m2kzMAfI0LR1ZR7/m2lAUIEfjc2Eg+jXXpvIoQPU92L7nzucTF4fQRgUi2m2YlXJtLI8C7F4+vn6szruhe0OMXBzCGoyCseQ3XJvL5ymRb+U8+I1LIVQaiIHF6NdcG8yvALsy/K4bnkxcHALqz4DZ8Fdcm8znEGh1XL981Hc+9EYBwut5+00e9dxxbTSvSXDx7f20mZV/ChCc8603n/0L12bjNGgeXO+7nvCPGW2il79FAXLgeNPl0j9/7KlGRAGWr/sdT57+COuQYHQUYOk63+5U6U+xLnFHSgGWreu9TpL+xOsUbbwUYMk63uiY6ZdetxhjpwDL9fwuB02/9OqF7YDrNSjAUj29xfPSL706DjPWaNz6UYCFenyDJ6VfevBTUQDc846/9MC9UQD85hN/6THPRwFw8Zj+ofhLjzcwCmDblPRLjzUWCmDWQ/zNRf+KAlg0Mv7Sw0xEbwGa20f33UCXAkw3Lv7So0xKcwEuzxC73E597uJQGY6/9AhlaC1AE33Xo/QowCT3b2ZX/KVHKEllAZrHqLruHUEBphiKv/T45OkrAHuAYAbiLz08LVQVoLp57urcTodnLs643vhLD04XLQU4N7eOOB8KR/4pwFjEfxotBUi8uFwR/+koQDaIvx9NBXDdQJECDLpL/+e4txM1PQV4XMpVkMVlrOfDX3poy6CzALEWlxviHwIFWKjbN474z0EBFugu/p/Efx4KsDB3gSf+AQgUoP4muMZZoCnu4/9J/MNIvgc4bYYeH0MBOrjjLz2yfEU6BBp8fgYFeEL8JcSaAxwGHiRPAR4QfxlMglUg/lIogALEXw4FEEf8JVEAWVviL4sCCHpMP/FPjwKI6Uk/8U+GAghxH/oQ/5QogAjirwUFSK9n4kv8U6MAiW2JvyoUIKUt8deGAiTzmH7irwEFSOQ5/cRfAwqQBOnXigIkwKGPXhQgqqfjfuKvDAWIpyP9xF8bChBJd/qJvzYUIAbSvxgUILSu8JN+tShAUKPST/wVoQDhjEs/8VeFAoTQGf0q+zzSTjsKMJsz/M//r/RQ8YQCzDM+/KRfJQrga/xRD+lXjAJM1xl95wc/6VeNAkzhiP6262QP6V8ECjCOO/ruwx7SvwAUYMhQ9DnsWTQK4OYZfdK/JBSgi3/0Cf/CUIBWT6aJfr4oANE3zXYBiL55RgswHHqib4O5Asz6vCf62TFUAKKPZyYK0Bd6DnVsi/ag7OLC+cD4RAXoSz6f94hVgH3xWv9xaP+YtThPrugTelxFKcBpc439/uVj9uK8EH2MEaUAx/Vb++fBcRAUsQCdn/tEH51y2wN0pZ/MwynWHKDZBaSdA3Qd9hB99Il0Fui4rs8COT7/YxRg8LAn+CsiA5l8D9B/2BP2tZCTLArQe9gT8oWQndgF2Mc/C8RhD/wl3gMUV0EWd/4dfz744WPZh0CkHzMtuACkH/MttgBd6Q8xMNiy0AKQfoQR6Vqg35PdGGeBSD9CibMHOG2cPwTwWdy9Jv6kHwFE+0HMKuTibjzG33c5QCXWHOBQvPX+c88CPMTfbyHA1aImwfeH/mEHBJsWVIDf6Q87FFi2mAJcD33CjgPGLaMA1yP/sIMA9Bdge534hh0BcNZfgGbe+0n6EYXuAlznvWFfHGhpLgBnfRCd2gKQfqSgswCc80QiCgvAOU+ko60AW+KPlPQVgNM+SEhbATj0R1LaCkD6kZS2AgBJUQCYRgFgGgWAaRQAplEAmEYBYBoFgGkUAKZRAJhGAWAaBYBpYgUAVBAqgPDLDNMyEC3jMD8QCiBDyzjMD4QCyNAyDvMDoQAytIzD/EAogAwt4zA/EAogQ8s4zA+EAsjQMg7zA6EAMrSMw/xAKIAMLeMwPxA16w9IoAAwjQLANAoA0ygATKMAMI0CwDQKANMoAEyjADCNAsA0CgDTKABMS1GAQ1F8e0/wOkOO6+p+GSvpYXz9/FX9l/xWqQcivVVOm/LlX6u/RLZIggIcyrU6aGjA1x8KBlEG7nuVO/mt0gxEeKucNuVG2FcFlNki8Qtw2lT13ol/8JZb+PKGSw+iKKphyG+VZiDSW+Xrx1v5n/vvv4S2SPwCXNcw+isN2WsoYfF6SZz4VmkHomKrVJ/8QlskQQEuu1gNn767v7dHm6LqAijYKvWrq9gqu++/hLZI/ALUh3UKJgHH9ctHuaml3+v6PdawVS4DUbFVyt2R1BYxVICa/K5IVwGe/pQYSDsHzrIAGnb2N+pDTUnKDoEuRLfK4XIElu0hkPh07578uVAdk+DzfQEEt8q+noFkOwmWP+HXqLew/K7ooOM06F0TBbfKvqh3PtmeBlXwlU/jsnGVTII1bJXmLJDsVvn60b50rl+EVR2X/tK/sSuKQnoGcP20ld8qzUBkt8q+fqBLtSlEtggXw8E0CgDTKABMowAwjQLANAoA0ygATKMAMI0CwDQKANMoAEyjADCNAsA0CgDTKABMowAwjQLANAoA0ygATKMAMI0CwDQKANMoAEyjADCNAsA0CgDTKABMowBK7K63yDxtmicWHYrq4S2IigIosbuEfV82oCxAHfwdBYiPAihRF+C4fi0L8Lc/q5skH//6JwWIjgIo0RbgrSzA6nK7/sPLfyhAdBRAieYQaFXNAVaH+smNOwoQHQVQop4EV0f9ZQG+fv46H/98pwDxUQAl6rBXDwwtC3DavJVHQB8UID4KoEQT9t33X2UBqkOhch5AAeKjAEo0Yd/XBfj6+d9/v1OABCiAEu0e4OWjKsBp869yGkAB4qMASrRzgMtp0GpOvDpTgAQogBK3l0Ks6iZQgAQoAEyjADCNAsA0CgDTKABMowAwjQLANAoA0ygATKMAMI0CwDQKANMoAEyjADCNAsA0CgDTKABMowAwjQLANAoA0ygATKMAMI0CwDQKANP+D1CpgsWgKivsAAAAAElFTkSuQmCC" width="100%" /></p>
<p>A general remark regarding the smoothed functions is that we almost
always observe higher prediction interval for extreme values (low and/or
high). This is explained by the lower amount of observed data in those
extreme cases, which makes it more difficult for the model to provide a
narrower prediction interval. Lower observations might thus lead to
higher variance for a same value, even if continuous.</p>
<p>To conclude this project let’s review the spatial effect with respect
to longitude and latitude on the claim frequencies. Here is the plot we
obtain based on the bam fitted model.</p>
<div class="sourceCode" id="cb396"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb396-1"><a href="#cb396-1" tabindex="-1"></a><span class="fu">plot</span>(m6_bam , <span class="at">select=</span><span class="dv">6</span> , <span class="at">trans =</span> exp, <span class="at">scale =</span> <span class="dv">0</span>, <span class="at">shade =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="100%" /></p>
<p>Based on the previous model we can see clusters where there is a
higher predicted frequency of claims. We thus tried a more visual
representation of the frequency on a belgian map. Unfortunately, due to
issues loading maps with an administrative level above states, We had to
stick with a colored map as such. But we still may observe a higher
claim frequency trend for most populated areas such as Brussels, Walloon
Brabant, Liege and East-Flanders.</p>
<div class="sourceCode" id="cb397"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb397-1"><a href="#cb397-1" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb397-2"><a href="#cb397-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb397-3"><a href="#cb397-3" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb397-4"><a href="#cb397-4" tabindex="-1"></a></span>
<span id="cb397-5"><a href="#cb397-5" tabindex="-1"></a><span class="fu">library</span>(rnaturalearth)</span>
<span id="cb397-6"><a href="#cb397-6" tabindex="-1"></a><span class="fu">library</span>(rnaturalearthdata)</span>
<span id="cb397-7"><a href="#cb397-7" tabindex="-1"></a>belgium_sf <span class="ot">&lt;-</span> <span class="fu">ne_states</span>(<span class="at">country =</span> <span class="st">&quot;belgium&quot;</span>, <span class="at">returnclass =</span> <span class="st">&quot;sf&quot;</span>)</span>
<span id="cb397-8"><a href="#cb397-8" tabindex="-1"></a></span>
<span id="cb397-9"><a href="#cb397-9" tabindex="-1"></a><span class="co"># Belgium states</span></span>
<span id="cb397-10"><a href="#cb397-10" tabindex="-1"></a>belgium_centroids <span class="ot">&lt;-</span> <span class="fu">st_centroid</span>(belgium_sf)</span>
<span id="cb397-11"><a href="#cb397-11" tabindex="-1"></a>coords <span class="ot">&lt;-</span> <span class="fu">st_coordinates</span>(belgium_centroids)</span>
<span id="cb397-12"><a href="#cb397-12" tabindex="-1"></a></span>
<span id="cb397-13"><a href="#cb397-13" tabindex="-1"></a>belgium_sf<span class="sc">$</span>LONG <span class="ot">&lt;-</span> coords[, <span class="st">&quot;X&quot;</span>]</span>
<span id="cb397-14"><a href="#cb397-14" tabindex="-1"></a>belgium_sf<span class="sc">$</span>LAT <span class="ot">&lt;-</span> coords[, <span class="st">&quot;Y&quot;</span>]</span>
<span id="cb397-15"><a href="#cb397-15" tabindex="-1"></a></span>
<span id="cb397-16"><a href="#cb397-16" tabindex="-1"></a><span class="co"># median of variables</span></span>
<span id="cb397-17"><a href="#cb397-17" tabindex="-1"></a>belgium_sf<span class="sc">$</span>AGEC <span class="ot">&lt;-</span> <span class="fu">median</span>(training_set<span class="sc">$</span>AGEC, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb397-18"><a href="#cb397-18" tabindex="-1"></a>belgium_sf<span class="sc">$</span>AGEPH <span class="ot">&lt;-</span> <span class="fu">median</span>(training_set<span class="sc">$</span>AGEPH, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb397-19"><a href="#cb397-19" tabindex="-1"></a>belgium_sf<span class="sc">$</span>EXP <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb397-20"><a href="#cb397-20" tabindex="-1"></a></span>
<span id="cb397-21"><a href="#cb397-21" tabindex="-1"></a>belgium_pred <span class="ot">&lt;-</span> belgium_sf <span class="sc">%&gt;%</span></span>
<span id="cb397-22"><a href="#cb397-22" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb397-23"><a href="#cb397-23" tabindex="-1"></a>    <span class="co"># median of continuous variables</span></span>
<span id="cb397-24"><a href="#cb397-24" tabindex="-1"></a>    <span class="at">AGEC =</span> <span class="fu">median</span>(training_set<span class="sc">$</span>AGEC, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb397-25"><a href="#cb397-25" tabindex="-1"></a>    <span class="at">AGEPH =</span> <span class="fu">median</span>(training_set<span class="sc">$</span>AGEPH, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb397-26"><a href="#cb397-26" tabindex="-1"></a>    <span class="at">POWER =</span> <span class="fu">median</span>(training_set<span class="sc">$</span>POWER, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb397-27"><a href="#cb397-27" tabindex="-1"></a>    <span class="at">BM =</span> <span class="fu">median</span>(training_set<span class="sc">$</span>BM, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb397-28"><a href="#cb397-28" tabindex="-1"></a>    <span class="at">EXP =</span> <span class="dv">1</span>,  </span>
<span id="cb397-29"><a href="#cb397-29" tabindex="-1"></a>    </span>
<span id="cb397-30"><a href="#cb397-30" tabindex="-1"></a>    <span class="co"># discret variables</span></span>
<span id="cb397-31"><a href="#cb397-31" tabindex="-1"></a>    <span class="at">COVERAGE =</span> <span class="fu">names</span>(<span class="fu">which.max</span>(<span class="fu">table</span>(training_set<span class="sc">$</span>COVERAGE))),</span>
<span id="cb397-32"><a href="#cb397-32" tabindex="-1"></a>    <span class="at">FUEL =</span> <span class="fu">names</span>(<span class="fu">which.max</span>(<span class="fu">table</span>(training_set<span class="sc">$</span>FUEL))),</span>
<span id="cb397-33"><a href="#cb397-33" tabindex="-1"></a>    <span class="at">SEX =</span> <span class="fu">names</span>(<span class="fu">which.max</span>(<span class="fu">table</span>(training_set<span class="sc">$</span>SEX))),</span>
<span id="cb397-34"><a href="#cb397-34" tabindex="-1"></a>    <span class="at">USE =</span> <span class="fu">names</span>(<span class="fu">which.max</span>(<span class="fu">table</span>(training_set<span class="sc">$</span>USE))),</span>
<span id="cb397-35"><a href="#cb397-35" tabindex="-1"></a>    <span class="at">FLEET =</span> <span class="fu">names</span>(<span class="fu">which.max</span>(<span class="fu">table</span>(training_set<span class="sc">$</span>FLEET)))</span>
<span id="cb397-36"><a href="#cb397-36" tabindex="-1"></a>  )</span>
<span id="cb397-37"><a href="#cb397-37" tabindex="-1"></a></span>
<span id="cb397-38"><a href="#cb397-38" tabindex="-1"></a><span class="co"># Spatial effect for each state</span></span>
<span id="cb397-39"><a href="#cb397-39" tabindex="-1"></a>belgium_pred<span class="sc">$</span>spatial_effect <span class="ot">&lt;-</span> <span class="fu">predict</span>(m6_bam, </span>
<span id="cb397-40"><a href="#cb397-40" tabindex="-1"></a>                                     <span class="at">newdata =</span> belgium_pred, </span>
<span id="cb397-41"><a href="#cb397-41" tabindex="-1"></a>                                     <span class="at">type =</span> <span class="st">&quot;terms&quot;</span>)[, <span class="st">&quot;s(LONG,LAT)&quot;</span>]</span>
<span id="cb397-42"><a href="#cb397-42" tabindex="-1"></a><span class="fu">str</span>(belgium_pred<span class="sc">$</span>spatial_effect)</span></code></pre></div>
<pre><code>##  num [1:11] -0.09376 0.00469 -0.19096 -0.32012 0.1076 ...</code></pre>
<div class="sourceCode" id="cb399"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb399-1"><a href="#cb399-1" tabindex="-1"></a><span class="co"># multiplicator factor</span></span>
<span id="cb399-2"><a href="#cb399-2" tabindex="-1"></a>belgium_pred<span class="sc">$</span>risk_factor <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">as.numeric</span>(belgium_pred<span class="sc">$</span>spatial_effect))</span>
<span id="cb399-3"><a href="#cb399-3" tabindex="-1"></a></span>
<span id="cb399-4"><a href="#cb399-4" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb399-5"><a href="#cb399-5" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb399-6"><a href="#cb399-6" tabindex="-1"></a></span>
<span id="cb399-7"><a href="#cb399-7" tabindex="-1"></a><span class="fu">ggplot</span>(belgium_pred) <span class="sc">+</span></span>
<span id="cb399-8"><a href="#cb399-8" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> risk_factor), <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb399-9"><a href="#cb399-9" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(</span>
<span id="cb399-10"><a href="#cb399-10" tabindex="-1"></a>    <span class="at">low =</span> <span class="st">&quot;#2E7D32&quot;</span>,      <span class="co"># low risk</span></span>
<span id="cb399-11"><a href="#cb399-11" tabindex="-1"></a>    <span class="at">mid =</span> <span class="st">&quot;#FDD835&quot;</span>,      <span class="co"># medium risk</span></span>
<span id="cb399-12"><a href="#cb399-12" tabindex="-1"></a>    <span class="at">high =</span> <span class="st">&quot;#C62828&quot;</span>,     <span class="co"># high risk</span></span>
<span id="cb399-13"><a href="#cb399-13" tabindex="-1"></a>    <span class="at">midpoint =</span> <span class="dv">1</span>,</span>
<span id="cb399-14"><a href="#cb399-14" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">&quot;Risk factor&quot;</span>,</span>
<span id="cb399-15"><a href="#cb399-15" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">1.5</span>),</span>
<span id="cb399-16"><a href="#cb399-16" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="fl">0.5</span>, <span class="fl">1.5</span>, <span class="fl">0.25</span>),</span>
<span id="cb399-17"><a href="#cb399-17" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;0.5 (-50%)&quot;</span>, <span class="st">&quot;0.75 (-25%)&quot;</span>, <span class="st">&quot;1.0 (r0)&quot;</span>, </span>
<span id="cb399-18"><a href="#cb399-18" tabindex="-1"></a>               <span class="st">&quot;1.25 (+25%)&quot;</span>, <span class="st">&quot;1.5 (+50%)&quot;</span>)</span>
<span id="cb399-19"><a href="#cb399-19" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb399-20"><a href="#cb399-20" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb399-21"><a href="#cb399-21" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Risk map of claims frequency in Belgium&quot;</span></span>
<span id="cb399-22"><a href="#cb399-22" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb399-23"><a href="#cb399-23" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb399-24"><a href="#cb399-24" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb399-25"><a href="#cb399-25" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb399-26"><a href="#cb399-26" tabindex="-1"></a>    <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb399-27"><a href="#cb399-27" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb399-28"><a href="#cb399-28" tabindex="-1"></a>    <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb399-29"><a href="#cb399-29" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;right&quot;</span></span>
<span id="cb399-30"><a href="#cb399-30" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="100%" /></p>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
